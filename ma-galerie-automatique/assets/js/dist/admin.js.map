{
  "version": 3,
  "sources": ["../src/shared/sprintf.js", "../src/shared/icons.js", "../src/shared/focus.js", "../src/shared/index.js", "../src/admin.js"],
  "sourcesContent": ["const TOKEN_REGEX = /%(\\d+\\$)?[sd]/g;\n\nconst createFallbackSprintf = () => (format, ...args) => {\n    let autoIndex = 0;\n\n    return String(format).replace(TOKEN_REGEX, (match, position) => {\n        let argIndex;\n        const type = match.charAt(match.length - 1);\n\n        if (position) {\n            const numericIndex = parseInt(position.slice(0, -1), 10);\n\n            if (Number.isNaN(numericIndex) || numericIndex <= 0) {\n                return '';\n            }\n\n            argIndex = numericIndex - 1;\n        } else {\n            argIndex = autoIndex;\n            autoIndex += 1;\n        }\n\n        const value = argIndex >= 0 && argIndex < args.length ? args[argIndex] : undefined;\n\n        if (type === 'd') {\n            const coerced = parseInt(value, 10);\n            return Number.isNaN(coerced) ? '' : String(coerced);\n        }\n\n        if (typeof value === 'undefined') {\n            return '';\n        }\n\n        return String(value);\n    });\n};\n\nexport const createSprintf = (i18n) => {\n    if (i18n && typeof i18n.sprintf === 'function') {\n        return i18n.sprintf;\n    }\n\n    return createFallbackSprintf();\n};\n\nexport const createTranslate = (i18n) => {\n    if (i18n && typeof i18n.__ === 'function') {\n        return i18n.__;\n    }\n\n    return (text) => text;\n};\n\nexport const resolveI18n = (globalObject) => {\n    if (!globalObject || typeof globalObject !== 'object') {\n        return null;\n    }\n\n    if (globalObject.wp && globalObject.wp.i18n) {\n        return globalObject.wp.i18n;\n    }\n\n    return null;\n};\n\nexport const getSharedI18n = () => resolveI18n(typeof window !== 'undefined' ? window : globalThis);\n\nexport const getSharedSprintf = () => createSprintf(getSharedI18n());\n\nexport const getSharedTranslate = () => createTranslate(getSharedI18n());\n\nexport default {\n    createSprintf,\n    createTranslate,\n    getSharedI18n,\n    getSharedSprintf,\n    getSharedTranslate,\n};\n", "const SHARE_ICON_LIBRARY = {\n    facebook: {\n        viewBox: '0 0 24 24',\n        paths: [\n            { d: 'M22 12c0-5.52-4.48-10-10-10S2 6.48 2 12c0 4.99 3.66 9.12 8.44 9.88v-6.99H8.08V12h2.36V9.88c0-2.33 1.38-3.62 3.5-3.62 0.72 0 1.48 0.13 1.48 0.13v1.63h-0.83c-0.82 0-1.08 0.51-1.08 1.04V12h1.84l-0.29 1.89h-1.55v6.99C18.34 21.12 22 16.99 22 12z' },\n        ],\n    },\n    twitter: {\n        viewBox: '0 0 24 24',\n        paths: [\n            { d: 'M22.46 6c-0.77 0.35-1.6 0.59-2.46 0.69a4.29 4.29 0 0 0 1.88-2.37 8.59 8.59 0 0 1-2.72 1.04 4.28 4.28 0 0 0-7.3 3.9 12.13 12.13 0 0 1-8.82-4.47 4.28 4.28 0 0 0 1.33 5.72 4.25 4.25 0 0 1-1.94-0.54v0.05a4.28 4.28 0 0 0 3.43 4.2 4.3 4.3 0 0 1-1.93 0.07 4.28 4.28 0 0 0 4 2.97 8.58 8.58 0 0 1-5.3 1.83 12.1 12.1 0 0 0 6.56 1.92c7.88 0 12.2-6.53 12.2-12.2 0-0.19-0.01-0.39-0.01-0.58A8.7 8.7 0 0 0 22.46 6z' },\n        ],\n    },\n    linkedin: {\n        viewBox: '0 0 24 24',\n        paths: [\n            { d: 'M20.45 3H3.55A1.55 1.55 0 0 0 2 4.55v14.9C2 20.3 2.7 21 3.55 21h16.9c0.85 0 1.55-0.7 1.55-1.55V4.55C22 3.7 21.3 3 20.45 3zM8.34 18H5.67V9.67h2.67V18zM7 8.5a1.55 1.55 0 1 1 0-3.1 1.55 1.55 0 0 1 0 3.1zM18.33 18h-2.67v-4.1c0-0.98-0.02-2.24-1.36-2.24-1.36 0-1.56 1.06-1.56 2.16V18h-2.67V9.67h2.56v1.14h0.04c0.36-0.68 1.24-1.4 2.56-1.4 2.74 0 3.25 1.8 3.25 4.13V18z' },\n        ],\n    },\n    pinterest: {\n        viewBox: '0 0 24 24',\n        paths: [\n            { d: 'M12 2C6.48 2 2 6.31 2 11.42c0 3.89 2.68 7.23 6.44 8.41-0.09-0.71-0.17-1.8 0.03-2.58 0.18-0.77 1.15-4.9 1.15-4.9s-0.29-0.58-0.29-1.45c0-1.36 0.79-2.37 1.78-2.37 0.84 0 1.24 0.63 1.24 1.38 0 0.84-0.53 2.09-0.8 3.25-0.23 1 0.5 1.81 1.48 1.81 1.78 0 3.14-1.87 3.14-4.57 0-2.39-1.72-4.07-4.18-4.07-2.85 0-4.52 2.14-4.52 4.35 0 0.86 0.33 1.79 0.74 2.29 0.08 0.1 0.09 0.19 0.07 0.29-0.07 0.31-0.23 1-0.26 1.13-0.04 0.18-0.14 0.22-0.32 0.13-1.2-0.56-1.95-2.29-1.95-3.68 0-3 2.18-5.76 6.29-5.76 3.3 0 5.87 2.35 5.87 5.5 0 3.28-2.06 5.93-4.92 5.93-0.96 0-1.86-0.5-2.17-1.08l-0.59 2.24c-0.21 0.83-0.78 1.87-1.16 2.5 0.87 0.27 1.78 0.42 2.72 0.42 5.52 0 10-4.31 10-9.42C22 6.31 17.52 2 12 2z' },\n        ],\n    },\n    whatsapp: {\n        viewBox: '0 0 24 24',\n        paths: [\n            { d: 'M20.52 3.48A10.5 10.5 0 0 0 2.47 13.3l-1.45 5.28 5.4-1.41A10.5 10.5 0 1 0 20.52 3.48zm-8.5 17.54a8.75 8.75 0 0 1-4.46-1.22l-0.32-0.19-3.21 0.84 0.86-3.13-0.2-0.32a8.75 8.75 0 1 1 7.33 3.99zm4.78-6.53c-0.26-0.13-1.53-0.76-1.77-0.84-0.24-0.09-0.41-0.13-0.58 0.13-0.17 0.26-0.66 0.84-0.8 1.02-0.15 0.17-0.29 0.2-0.55 0.07-0.26-0.13-1.09-0.4-2.07-1.3-0.76-0.68-1.27-1.52-1.42-1.78-0.15-0.26-0.02-0.4 0.11-0.53 0.11-0.11 0.26-0.29 0.39-0.43 0.13-0.15 0.17-0.26 0.26-0.43 0.09-0.17 0.04-0.32-0.02-0.45-0.07-0.13-0.58-1.39-0.8-1.91-0.21-0.5-0.43-0.43-0.58-0.43-0.15 0-0.32-0.02-0.49-0.02-0.17 0-0.43 0.06-0.66 0.32-0.24 0.26-0.89 0.87-0.89 2.13s0.91 2.47 1.03 2.64c0.13 0.17 1.79 2.73 4.34 3.83 0.61 0.26 1.08 0.41 1.45 0.53 0.61 0.19 1.16 0.16 1.6 0.1 0.49-0.07 1.53-0.62 1.75-1.22 0.21-0.6 0.21-1.11 0.15-1.22-0.06-0.1-0.24-0.16-0.5-0.29z' },\n        ],\n    },\n    telegram: {\n        viewBox: '0 0 24 24',\n        paths: [\n            { d: 'M21.5 2.5l-19 7.5c-1.3 0.52-1.29 2.35 0.02 2.85l4.8 1.9 1.9 4.8c0.5 1.31 2.34 1.32 2.85 0.02l7.5-19c0.42-1.06-0.64-2.12-1.67-1.67zM10 14l-1 4-1.5-3.8 8.3-6.2-5.8 6z' },\n        ],\n    },\n    email: {\n        viewBox: '0 0 24 24',\n        paths: [\n            { d: 'M20 4H4a2 2 0 0 0-2 2v12a2 2 0 0 0 2 2h16a2 2 0 0 0 2-2V6a2 2 0 0 0-2-2zm0 2-8 5-8-5h16zm0 12H4V8l8 5 8-5v10z' },\n        ],\n    },\n    link: {\n        viewBox: '0 0 24 24',\n        paths: [\n            { d: 'M10.59 13.41a1 1 0 0 1 0-1.41l2-2a1 1 0 1 1 1.41 1.41l-2 2a1 1 0 0 1-1.41 0zm-2.83 2.83a3 3 0 0 1 0-4.24l2-2a3 3 0 0 1 4.24 0 1 1 0 0 1-1.41 1.41 1 1 0 0 0-1.41 0l-2 2a1 1 0 0 0 0 1.41 1 1 0 0 0 1.41 0l1-1a1 1 0 1 1 1.41 1.41l-1 1a3 3 0 0 1-4.24 0zm8.48-8.48a3 3 0 0 0-4.24 0l-1 1a1 1 0 0 1-1.41-1.41l1-1a5 5 0 1 1 7.07 7.07l-2 2a5 5 0 0 1-7.07 0 1 1 0 0 1 1.41-1.41 3 3 0 0 0 4.24 0l2-2a3 3 0 0 0 0-4.24z' },\n        ],\n    },\n    generic: {\n        viewBox: '0 0 24 24',\n        paths: [\n            { d: 'M12 2a10 10 0 1 0 10 10A10 10 0 0 0 12 2z' },\n            { d: 'M13 17h-2v-2h2zm0-4h-2V7h2z' },\n        ],\n    },\n    copy: {\n        viewBox: '0 0 24 24',\n        paths: [\n            { d: 'M16 1H4a2 2 0 0 0-2 2v12h2V3h12V1zm3 4H8a2 2 0 0 0-2 2v14a2 2 0 0 0 2 2h11a2 2 0 0 0 2-2V7a2 2 0 0 0-2-2zm0 16H8V7h11v14z' },\n        ],\n    },\n    download: {\n        viewBox: '0 0 24 24',\n        paths: [\n            { d: 'M5 20h14v-2H5v2zm7-16v9l3.5-3.5 1.42 1.42L12 17l-4.92-4.92L8.5 10.66 12 14.17V4z' },\n        ],\n    },\n    native: {\n        viewBox: '0 0 24 24',\n        paths: [\n            { d: 'M18 16.08c-0.76 0-1.44 0.3-1.96 0.77L8.91 12.7c0.05-0.23 0.09-0.46 0.09-0.7s-0.04-0.47-0.09-0.7l7.02-4.11A2.99 2.99 0 0 0 18 7.91c1.66 0 3-1.34 3-3s-1.34-3-3-3-3 1.34-3 3c0 0.24 0.03 0.47 0.09 0.7L8.07 9.7A2.99 2.99 0 0 0 6 9c-1.66 0-3 1.34-3 3s1.34 3 3 3c0.79 0 1.5-0.31 2.03-0.82l7.05 4.12c-0.06 0.23-0.08 0.46-0.08 0.7 0 1.65 1.34 2.99 3 2.99s3-1.34 3-2.99-1.34-3-3-3z' },\n        ],\n    },\n};\n\nexport const sanitizeIconKey = (value) => {\n    if (typeof value !== 'string') {\n        return '';\n    }\n\n    return value.trim().toLowerCase().replace(/[^a-z0-9_-]/g, '');\n};\n\nconst getDefinition = (iconKey) => {\n    const sanitizedKey = sanitizeIconKey(iconKey);\n\n    if (sanitizedKey && SHARE_ICON_LIBRARY[sanitizedKey]) {\n        return SHARE_ICON_LIBRARY[sanitizedKey];\n    }\n\n    return SHARE_ICON_LIBRARY.generic;\n};\n\nexport const createSvgElement = (doc, tag, attributes = {}) => {\n    if (!doc || typeof doc.createElementNS !== 'function') {\n        return null;\n    }\n\n    const element = doc.createElementNS('http://www.w3.org/2000/svg', tag);\n\n    Object.keys(attributes).forEach((attribute) => {\n        element.setAttribute(attribute, attributes[attribute]);\n    });\n\n    return element;\n};\n\nexport const createIconSvg = (doc, iconKey) => {\n    const definition = getDefinition(iconKey);\n    const svg = createSvgElement(doc, 'svg', {\n        viewBox: definition.viewBox,\n        fill: 'currentColor',\n        'aria-hidden': 'true',\n        focusable: 'false',\n    });\n\n    if (!svg) {\n        return null;\n    }\n\n    if (Array.isArray(definition.paths)) {\n        definition.paths.forEach((pathDefinition) => {\n            const path = createSvgElement(doc, 'path', pathDefinition);\n\n            if (path) {\n                svg.appendChild(path);\n            }\n        });\n    }\n\n    return svg;\n};\n\nexport const createIconPreview = (doc, iconKey, { wrapperTag = 'span', wrapperClass = '' } = {}) => {\n    if (!doc || typeof doc.createElement !== 'function') {\n        return null;\n    }\n\n    const wrapper = doc.createElement(wrapperTag);\n\n    if (wrapperClass) {\n        wrapper.className = wrapperClass;\n    }\n\n    const svg = createIconSvg(doc, iconKey);\n\n    if (!svg) {\n        return null;\n    }\n\n    wrapper.appendChild(svg);\n\n    return wrapper;\n};\n\nexport const getIconLibrary = () => ({ ...SHARE_ICON_LIBRARY });\n\nexport default {\n    createIconPreview,\n    createIconSvg,\n    getIconLibrary,\n    sanitizeIconKey,\n};\n", "let focusSupportsOptionsCache = null;\n\nexport const detectFocusOptionsSupport = () => {\n    if (focusSupportsOptionsCache !== null) {\n        return focusSupportsOptionsCache;\n    }\n\n    focusSupportsOptionsCache = false;\n\n    const doc = typeof window !== 'undefined' ? window.document : null;\n\n    if (\n        !doc ||\n        typeof doc.createElement !== 'function' ||\n        typeof window.HTMLElement === 'undefined' ||\n        !window.HTMLElement.prototype ||\n        typeof window.HTMLElement.prototype.focus !== 'function'\n    ) {\n        return focusSupportsOptionsCache;\n    }\n\n    const testElement = doc.createElement('button');\n    const root = doc.body || doc.documentElement;\n\n    try {\n        testElement.type = 'button';\n\n        if (root && typeof root.appendChild === 'function') {\n            root.appendChild(testElement);\n        }\n\n        window.HTMLElement.prototype.focus.call(testElement, {\n            get preventScroll() {\n                focusSupportsOptionsCache = true;\n                return true;\n            },\n        });\n    } catch (error) {\n        focusSupportsOptionsCache = false;\n    } finally {\n        if (testElement.parentNode && typeof testElement.parentNode.removeChild === 'function') {\n            testElement.parentNode.removeChild(testElement);\n        }\n    }\n\n    return focusSupportsOptionsCache;\n};\n\nexport const safeFocus = (element, options = { preventScroll: true }) => {\n    if (!element || typeof element.focus !== 'function') {\n        return;\n    }\n\n    const canUseOptions = options && detectFocusOptionsSupport();\n\n    if (canUseOptions) {\n        try {\n            element.focus(options);\n            return;\n        } catch (error) {\n            // Ignore and fall back to focusing without options.\n        }\n    }\n\n    element.focus();\n};\n\nexport const exposeOnWindow = () => {\n    if (typeof window === 'undefined') {\n        return;\n    }\n\n    if (!window.mgaFocusUtils || typeof window.mgaFocusUtils !== 'object') {\n        window.mgaFocusUtils = {};\n    }\n\n    window.mgaFocusUtils.detectFocusOptionsSupport = detectFocusOptionsSupport;\n    window.mgaFocusUtils.safeFocus = safeFocus;\n};\n\nexport default {\n    detectFocusOptionsSupport,\n    safeFocus,\n    exposeOnWindow,\n};\n", "export * from './sprintf';\nexport * from './icons';\nexport * from './focus';\n", "/* eslint-disable no-underscore-dangle */\nimport {\n    createIconPreview,\n    createSprintf,\n    createTranslate,\n    detectFocusOptionsSupport,\n    exposeOnWindow,\n    resolveI18n,\n    safeFocus,\n    sanitizeIconKey,\n} from './shared';\n\n(function(global) {\n    exposeOnWindow();\n\n    const mgaAdminI18n = resolveI18n(global);\n    const mgaAdmin__ = createTranslate(mgaAdminI18n);\n    const mgaAdminSprintf = createSprintf(mgaAdminI18n);\n\n    if (typeof module !== 'undefined' && module.exports) {\n        module.exports = {\n            detectFocusOptionsSupport,\n            safeFocus,\n        };\n    }\n\n    const doc = global.document;\n\n    const createShareIconPreview = (iconKey) => {\n        const preview = createIconPreview(doc, sanitizeIconKey(iconKey));\n\n        if (!preview) {\n            return null;\n        }\n\n        const svg = preview.querySelector('svg');\n\n        return svg || preview;\n    };\n\n    const SHARE_TEMPLATE_SAMPLE = {\n        url: 'https://exemple.com/galerie/photo-01',\n        text: 'Une photo remarquable',\n        title: 'Collection studio',\n    };\n\n    const SHARE_TEMPLATE_PLACEHOLDERS = {\n        '%url%': SHARE_TEMPLATE_SAMPLE.url,\n        '%text%': SHARE_TEMPLATE_SAMPLE.text,\n        '%title%': SHARE_TEMPLATE_SAMPLE.title,\n    };\n\n    const SHARE_TEMPLATE_SCHEMES = ['http', 'https', 'mailto', 'tel', 'sms'];\n\n    const isValidHexColor = (value) => {\n        if (typeof value !== 'string') {\n            return false;\n        }\n\n        return /^#([0-9a-fA-F]{3}|[0-9a-fA-F]{6})$/.test(value.trim());\n    };\n\n    if (!doc || typeof doc.addEventListener !== 'function') {\n        return;\n    }\n\n    doc.addEventListener('DOMContentLoaded', function() {\n        const form = doc.querySelector('[data-mga-settings-form]') || doc.querySelector('.mga-admin-wrap form');\n        const adminRoot = doc.querySelector('.mga-admin-wrap');\n        let scheduleSummaryRefresh = () => {};\n\n        const THEME_STORAGE_KEY = 'mgaAdminThemePreference';\n        const THEME_OPTIONS = ['light', 'dark', 'system'];\n        const themeSelect = adminRoot ? adminRoot.querySelector('[data-mga-theme-select]') : null;\n        const systemThemeQuery = typeof global.matchMedia === 'function'\n            ? global.matchMedia('(prefers-color-scheme: dark)')\n            : null;\n\n        const readStoredTheme = () => {\n            try {\n                return global.localStorage ? global.localStorage.getItem(THEME_STORAGE_KEY) : null;\n            } catch (error) {\n                return null;\n            }\n        };\n\n        const writeStoredTheme = (value) => {\n            try {\n                if (!global.localStorage) {\n                    return;\n                }\n                if (!value) {\n                    global.localStorage.removeItem(THEME_STORAGE_KEY);\n                    return;\n                }\n                global.localStorage.setItem(THEME_STORAGE_KEY, value);\n            } catch (error) {\n                // Silently ignore storage errors (quota, private mode, etc.).\n            }\n        };\n\n        const normalizeThemePreference = (value) => {\n            if (typeof value !== 'string') {\n                return 'system';\n            }\n\n            const trimmed = value.trim().toLowerCase();\n            return THEME_OPTIONS.includes(trimmed) ? trimmed : 'system';\n        };\n\n        let currentThemePreference = normalizeThemePreference(readStoredTheme());\n\n        const resolveAppliedTheme = (preference) => {\n            if (preference === 'dark') {\n                return 'dark';\n            }\n            if (preference === 'light') {\n                return 'light';\n            }\n\n            const prefersDark = systemThemeQuery && typeof systemThemeQuery.matches === 'boolean'\n                ? systemThemeQuery.matches\n                : false;\n\n            return prefersDark ? 'dark' : 'light';\n        };\n\n        const applyThemePreference = (preference, options = {}) => {\n            if (!adminRoot) {\n                return;\n            }\n\n            const normalizedPreference = normalizeThemePreference(preference);\n            const resolvedTheme = resolveAppliedTheme(normalizedPreference);\n\n            adminRoot.setAttribute('data-mga-theme-preference', normalizedPreference);\n            adminRoot.setAttribute('data-mga-theme', resolvedTheme);\n            adminRoot.classList.toggle('is-theme-dark', resolvedTheme === 'dark');\n            adminRoot.classList.toggle('is-theme-light', resolvedTheme !== 'dark');\n\n            if (themeSelect && themeSelect.value !== normalizedPreference) {\n                themeSelect.value = normalizedPreference;\n            }\n\n            if (!options.skipStorage) {\n                writeStoredTheme(normalizedPreference === 'system' ? '' : normalizedPreference);\n            }\n\n            currentThemePreference = normalizedPreference;\n        };\n\n        if (adminRoot) {\n            applyThemePreference(currentThemePreference, { skipStorage: true });\n        }\n\n        if (themeSelect) {\n            themeSelect.value = currentThemePreference;\n            themeSelect.addEventListener('change', (event) => {\n                const nextPreference = normalizeThemePreference(event.target ? event.target.value : null);\n                applyThemePreference(nextPreference);\n            });\n        }\n\n        const handleSystemThemeChange = () => {\n            if (currentThemePreference === 'system') {\n                applyThemePreference('system', { skipStorage: true });\n            }\n        };\n\n        if (systemThemeQuery) {\n            if (typeof systemThemeQuery.addEventListener === 'function') {\n                systemThemeQuery.addEventListener('change', handleSystemThemeChange);\n            } else if (typeof systemThemeQuery.addListener === 'function') {\n                systemThemeQuery.addListener(handleSystemThemeChange);\n            }\n        }\n\n        const initializeWizard = (targetForm) => {\n            const wizard = doc.querySelector('[data-mga-wizard]');\n\n            if (!wizard) {\n                return null;\n            }\n\n            const stepPanels = Array.from(wizard.querySelectorAll('[data-mga-step-panel]'));\n            const indicators = Array.from(wizard.querySelectorAll('[data-mga-step-indicator]'));\n            const prevButton = wizard.querySelector('[data-mga-step-prev]');\n            const nextButton = wizard.querySelector('[data-mga-step-next]');\n            const submitButton = wizard.querySelector('[data-mga-step-submit]');\n            const statusElement = wizard.querySelector('[data-mga-save-status]');\n            const summaryIndex = stepPanels.length - 1;\n            let currentIndex = stepPanels.findIndex((panel) => panel.classList.contains('is-active'));\n\n            if (currentIndex < 0) {\n                currentIndex = 0;\n            }\n\n            const getMessages = () => (global.mgaAdminConfig && global.mgaAdminConfig.messages) || {};\n\n            const setStatusMessage = (state, message) => {\n                if (!statusElement) {\n                    return;\n                }\n\n                const statusMessage = message || getMessages()[state] || '';\n\n                statusElement.textContent = statusMessage;\n                statusElement.setAttribute('data-mga-status-state', state);\n            };\n\n            const updateControls = () => {\n                if (prevButton) {\n                    prevButton.disabled = currentIndex === 0;\n                }\n\n                if (nextButton) {\n                    nextButton.hidden = currentIndex >= summaryIndex;\n                }\n\n                if (submitButton) {\n                    submitButton.hidden = currentIndex < summaryIndex;\n                }\n            };\n\n            const focusPanel = (panel) => {\n                if (!panel) {\n                    return;\n                }\n\n                const focusTarget = panel.querySelector('[data-mga-step-title]') || panel;\n                const focusOptions = detectFocusOptionsSupport() ? { preventScroll: true } : undefined;\n\n                global.requestAnimationFrame(() => {\n                    safeFocus(focusTarget, focusOptions);\n                });\n            };\n\n            const deactivatePanel = (panel) => {\n                panel.classList.remove('is-active');\n                panel.setAttribute('hidden', 'hidden');\n                panel.setAttribute('aria-hidden', 'true');\n            };\n\n            const activatePanel = (panel) => {\n                panel.classList.add('is-active');\n                panel.removeAttribute('hidden');\n                panel.setAttribute('aria-hidden', 'false');\n            };\n\n            const updateIndicators = () => {\n                indicators.forEach((indicator, index) => {\n                    indicator.classList.toggle('is-active', index === currentIndex);\n                    indicator.classList.toggle('is-completed', index < currentIndex);\n                    indicator.setAttribute('aria-current', index === currentIndex ? 'step' : 'false');\n                });\n            };\n\n            const updateSummaryContainers = (() => {\n                let timeoutId = null;\n\n                const presetTarget = wizard.querySelector('[data-mga-summary-preset]');\n                const timingTarget = wizard.querySelector('[data-mga-summary-timing]');\n                const toolbarTarget = wizard.querySelector('[data-mga-summary-toolbar]');\n                const shareTarget = wizard.querySelector('[data-mga-summary-share]');\n\n                const renderToolbarSummary = () => {\n                    if (!toolbarTarget) {\n                        return;\n                    }\n\n                    const toolbarToggles = [\n                        { id: 'mga_show_zoom', label: mgaAdmin__('Zoom', 'lightbox-jlg') },\n                        { id: 'mga_show_download', label: mgaAdmin__('T\u00E9l\u00E9chargement', 'lightbox-jlg') },\n                        { id: 'mga_show_share', label: mgaAdmin__('Partage', 'lightbox-jlg') },\n                        { id: 'mga_show_cta', label: mgaAdmin__('Appel \u00E0 l\u2019action', 'lightbox-jlg') },\n                        { id: 'mga_show_fullscreen', label: mgaAdmin__('Plein \u00E9cran', 'lightbox-jlg') },\n                    ];\n\n                    const active = toolbarToggles.filter((toggle) => {\n                        const input = doc.getElementById(toggle.id);\n                        return input ? input.checked : false;\n                    });\n\n                    toolbarTarget.textContent = active.length > 0\n                        ? active.map((toggle) => toggle.label).join(', ')\n                        : mgaAdmin__('Aucun bouton affich\u00E9', 'lightbox-jlg');\n                };\n\n                const renderPresetSummary = () => {\n                    if (!presetTarget) {\n                        return;\n                    }\n\n                    const presetSelect = doc.getElementById('mga_style_preset');\n                    const value = presetSelect ? presetSelect.value : '';\n\n                    if (!presetSelect) {\n                        presetTarget.textContent = mgaAdmin__('R\u00E9glages personnalis\u00E9s', 'lightbox-jlg');\n                        return;\n                    }\n\n                    const fallback = Array.from(presetSelect.options).find((option) => option.value === value);\n                    let label = fallback ? fallback.textContent : mgaAdmin__('R\u00E9glages personnalis\u00E9s', 'lightbox-jlg');\n\n                    if (global.mgaStylePresets && global.mgaStylePresets.presets) {\n                        const preset = global.mgaStylePresets.presets[value];\n\n                        if (preset && preset.label) {\n                            label = preset.label;\n                        }\n                    }\n\n                    if (!value) {\n                        label = global.mgaStylePresets && global.mgaStylePresets.customDescription\n                            ? global.mgaStylePresets.customDescription\n                            : label;\n                    }\n\n                    presetTarget.textContent = label;\n                };\n\n                const renderTimingSummary = () => {\n                    if (!timingTarget) {\n                        return;\n                    }\n\n                    const delayInput = doc.getElementById('mga_delay');\n                    const effectSelect = doc.getElementById('mga_effect');\n                    const delayValue = delayInput && delayInput.value ? delayInput.value : '\u2014';\n                    let effectLabel = mgaAdmin__('Transition personnalis\u00E9e', 'lightbox-jlg');\n\n                    if (effectSelect) {\n                        const selectedOption = Array.from(effectSelect.options).find((option) => option.selected);\n                        effectLabel = selectedOption ? selectedOption.textContent : effectLabel;\n                    }\n\n                    timingTarget.textContent = mgaAdminSprintf(\n                        mgaAdmin__('Diaporama : %1$s\u00A0s \u00B7 Effet : %2$s', 'lightbox-jlg'),\n                        delayValue,\n                        effectLabel\n                    );\n                };\n\n                const renderShareSummary = () => {\n                    if (!shareTarget) {\n                        return;\n                    }\n\n                    const items = Array.from(doc.querySelectorAll('[data-share-repeater-item]'));\n                    const activeLabels = items\n                        .filter((item) => {\n                            const enabledField = item.querySelector('[data-share-field=\"enabled\"]');\n                            return enabledField ? enabledField.checked : false;\n                        })\n                        .map((item) => {\n                            const labelField = item.querySelector('[data-share-field=\"label\"]');\n                            const keyField = item.querySelector('[data-share-field=\"key\"]');\n                            const labelValue = labelField && labelField.value ? labelField.value.trim() : '';\n                            const keyValue = keyField && keyField.value ? keyField.value.trim() : '';\n\n                            return labelValue || (keyValue ? keyValue.toUpperCase() : mgaAdmin__('Canal sans titre', 'lightbox-jlg'));\n                        });\n\n                    if (activeLabels.length > 0) {\n                        shareTarget.textContent = mgaAdminSprintf(\n                            mgaAdmin__('%1$d canaux actifs : %2$s', 'lightbox-jlg'),\n                            activeLabels.length,\n                            activeLabels.join(', ')\n                        );\n                    } else {\n                        shareTarget.textContent = mgaAdmin__('Aucun canal actif', 'lightbox-jlg');\n                    }\n                };\n\n                const update = () => {\n                    renderPresetSummary();\n                    renderTimingSummary();\n                    renderToolbarSummary();\n                    renderShareSummary();\n                };\n\n                return () => {\n                    if (timeoutId) {\n                        global.clearTimeout(timeoutId);\n                    }\n\n                    timeoutId = global.setTimeout(() => {\n                        timeoutId = null;\n                        update();\n                    }, 120);\n                };\n            })();\n\n            const goToStep = (targetIndex) => {\n                const normalizedIndex = Math.max(0, Math.min(stepPanels.length - 1, targetIndex));\n\n                if (normalizedIndex === currentIndex) {\n                    return;\n                }\n\n                const currentPanel = stepPanels[currentIndex];\n                const nextPanel = stepPanels[normalizedIndex];\n\n                if (currentPanel) {\n                    deactivatePanel(currentPanel);\n                }\n\n                if (nextPanel) {\n                    activatePanel(nextPanel);\n                    focusPanel(nextPanel);\n                }\n\n                currentIndex = normalizedIndex;\n                updateIndicators();\n                updateControls();\n\n                if (currentIndex === summaryIndex) {\n                    updateSummaryContainers();\n                }\n            };\n\n            const handleNext = () => {\n                if (targetForm && typeof targetForm.reportValidity === 'function' && !targetForm.reportValidity()) {\n                    return;\n                }\n\n                goToStep(currentIndex + 1);\n            };\n\n            const handlePrev = () => {\n                goToStep(currentIndex - 1);\n            };\n\n            const attachIndicatorNavigation = () => {\n                indicators.forEach((indicator, index) => {\n                    indicator.addEventListener('click', (event) => {\n                        event.preventDefault();\n\n                        if (index < currentIndex && index >= 0) {\n                            goToStep(index);\n                        } else if (index > currentIndex && index <= summaryIndex) {\n                            if (targetForm && typeof targetForm.reportValidity === 'function' && !targetForm.reportValidity()) {\n                                return;\n                            }\n\n                            goToStep(index);\n                        }\n                    });\n                });\n            };\n\n            if (prevButton) {\n                prevButton.addEventListener('click', (event) => {\n                    event.preventDefault();\n                    handlePrev();\n                });\n            }\n\n            if (nextButton) {\n                nextButton.addEventListener('click', (event) => {\n                    event.preventDefault();\n                    handleNext();\n                });\n            }\n\n            attachIndicatorNavigation();\n            updateIndicators();\n            updateControls();\n\n            if (currentIndex === summaryIndex) {\n                updateSummaryContainers();\n            }\n\n            const handleFormInput = () => {\n                updateSummaryContainers();\n            };\n\n            if (targetForm) {\n                targetForm.addEventListener('change', handleFormInput);\n                targetForm.addEventListener('input', handleFormInput);\n            }\n\n            return {\n                scheduleSummaryUpdate: updateSummaryContainers,\n                setStatusMessage,\n                goToSummary: () => goToStep(summaryIndex),\n            };\n        };\n\n        const wizardApi = initializeWizard(form);\n\n        if (wizardApi && typeof wizardApi.scheduleSummaryUpdate === 'function') {\n            scheduleSummaryRefresh = wizardApi.scheduleSummaryUpdate;\n        }\n\n        const initializeAsyncSave = (targetForm, wizard) => {\n            if (!targetForm) {\n                return;\n            }\n\n            const config = global.mgaAdminConfig || {};\n            const ajaxUrl = typeof config.ajaxUrl === 'string' && config.ajaxUrl ? config.ajaxUrl : global.ajaxurl;\n            const nonce = typeof config.nonce === 'string' ? config.nonce : '';\n            const submitButton = targetForm.querySelector('[data-mga-step-submit]');\n\n            if (!ajaxUrl || !nonce) {\n                return;\n            }\n\n            const setStatus = (state, explicitMessage) => {\n                if (wizard && typeof wizard.setStatusMessage === 'function') {\n                    wizard.setStatusMessage(state, explicitMessage);\n                }\n            };\n\n            const setSavingState = (isSaving) => {\n                if (submitButton) {\n                    submitButton.disabled = isSaving;\n                    submitButton.setAttribute('aria-busy', isSaving ? 'true' : 'false');\n                }\n\n                if (isSaving) {\n                    setStatus('saving');\n                }\n            };\n\n            targetForm.addEventListener('submit', (event) => {\n                event.preventDefault();\n\n                if (typeof targetForm.reportValidity === 'function' && !targetForm.reportValidity()) {\n                    return;\n                }\n\n                const formData = new FormData(targetForm);\n                formData.append('action', 'mga_save_settings');\n                formData.append('_ajax_nonce', nonce);\n\n                setSavingState(true);\n\n                fetch(ajaxUrl, {\n                    method: 'POST',\n                    credentials: 'same-origin',\n                    body: formData,\n                })\n                    .then((response) => {\n                        if (!response.ok) {\n                            throw new Error(response.statusText || 'HTTP error');\n                        }\n\n                        return response.json();\n                    })\n                    .then((payload) => {\n                        if (!payload || payload.success !== true) {\n                            const message = payload && payload.data && payload.data.message\n                                ? payload.data.message\n                                : null;\n\n                            throw new Error(message || (config.messages && config.messages.error) || mgaAdmin__('Impossible d\u2019enregistrer les r\u00E9glages.', 'lightbox-jlg'));\n                        }\n\n                        const successMessage = payload.data && payload.data.message\n                            ? payload.data.message\n                            : (config.messages && config.messages.success) || mgaAdmin__('R\u00E9glages enregistr\u00E9s.', 'lightbox-jlg');\n\n                        setStatus('success', successMessage);\n                        scheduleSummaryRefresh();\n                    })\n                    .catch((error) => {\n                        const fallbackMessage = (config.messages && config.messages.error)\n                            ? config.messages.error\n                            : mgaAdmin__('Impossible d\u2019enregistrer les r\u00E9glages.', 'lightbox-jlg');\n\n                        setStatus('error', error && error.message ? error.message : fallbackMessage);\n                    })\n                    .finally(() => {\n                        setSavingState(false);\n                    });\n            });\n        };\n\n        initializeAsyncSave(form, wizardApi);\n\n        const initSettingsNavigation = () => {\n            const layout = doc.querySelector('[data-mga-settings-layout]');\n\n            if (!layout) {\n                return;\n            }\n\n            const sections = Array.from(layout.querySelectorAll('[data-mga-settings-section]'));\n\n            if (sections.length === 0) {\n                return;\n            }\n\n            const navList = layout.querySelector('[data-mga-settings-nav]');\n            const navLinks = navList ? Array.from(navList.querySelectorAll('[data-mga-section-link]')) : [];\n            const linkBySection = new Map();\n            const navItemBySection = new Map();\n            const viewToggle = layout.querySelector('[data-mga-view-toggle]');\n            const viewSelect = viewToggle ? viewToggle.querySelector('[data-mga-view-select]') : null;\n            const VIEW_STORAGE_KEY = 'mga-settings-view-mode';\n\n            const readStoredViewMode = () => {\n                if (typeof global.localStorage === 'undefined') {\n                    return 'essential';\n                }\n\n                try {\n                    const stored = global.localStorage.getItem(VIEW_STORAGE_KEY);\n                    return stored === 'advanced' ? 'advanced' : 'essential';\n                } catch (error) {\n                    return 'essential';\n                }\n            };\n\n            let currentViewMode = readStoredViewMode();\n\n            const syncViewSelect = () => {\n                if (viewSelect) {\n                    viewSelect.value = currentViewMode;\n                }\n            };\n\n            const persistViewMode = () => {\n                if (typeof global.localStorage === 'undefined') {\n                    return;\n                }\n\n                try {\n                    global.localStorage.setItem(VIEW_STORAGE_KEY, currentViewMode);\n                } catch (error) {\n                    // Ignore storage access restrictions.\n                }\n            };\n\n            const updateLayoutViewMode = () => {\n                layout.setAttribute('data-mga-view-mode', currentViewMode);\n            };\n\n            const getSectionVisibility = (section) => {\n                if (!section) {\n                    return 'advanced';\n                }\n\n                const visibility = section.getAttribute('data-mga-visibility');\n                return visibility === 'essential' ? 'essential' : 'advanced';\n            };\n\n            const searchInput = layout.querySelector('[data-mga-settings-search]');\n            const emptyState = layout.querySelector('[data-mga-search-empty]');\n            const highlightTimeouts = new WeakMap();\n\n            const isSearchActive = () => layout.getAttribute('data-mga-search-active') === 'true';\n\n            const updateEmptyState = (visibleCount, searchActive) => {\n                if (!emptyState) {\n                    return;\n                }\n\n                if (searchActive && visibleCount === 0) {\n                    emptyState.removeAttribute('hidden');\n                } else {\n                    emptyState.setAttribute('hidden', 'hidden');\n                }\n            };\n\n            const setActiveLink = (section) => {\n                if (!section) {\n                    return;\n                }\n\n                linkBySection.forEach((link, candidate) => {\n                    if (candidate === section) {\n                        link.setAttribute('aria-current', 'true');\n                    } else {\n                        link.removeAttribute('aria-current');\n                    }\n                });\n            };\n\n            const clearHighlights = () => {\n                sections.forEach((section) => {\n                    section.removeAttribute('data-mga-section-highlight');\n\n                    if (highlightTimeouts.has(section)) {\n                        global.clearTimeout(highlightTimeouts.get(section));\n                        highlightTimeouts.delete(section);\n                    }\n                });\n            };\n\n            const highlightSection = (section) => {\n                if (!section) {\n                    return;\n                }\n\n                section.setAttribute('data-mga-section-highlight', 'true');\n\n                if (highlightTimeouts.has(section)) {\n                    global.clearTimeout(highlightTimeouts.get(section));\n                }\n\n                const timeoutId = global.setTimeout(() => {\n                    section.removeAttribute('data-mga-section-highlight');\n                    highlightTimeouts.delete(section);\n                }, 1600);\n\n                highlightTimeouts.set(section, timeoutId);\n            };\n\n            const filterSections = (rawQuery) => {\n                const query = typeof rawQuery === 'string' ? rawQuery.trim().toLowerCase() : '';\n                const searchActive = query.length > 0;\n                let visibleCount = 0;\n\n                if (searchActive) {\n                    layout.setAttribute('data-mga-search-active', 'true');\n                } else {\n                    layout.removeAttribute('data-mga-search-active');\n                    clearHighlights();\n                }\n\n                sections.forEach((section) => {\n                    const link = linkBySection.get(section);\n                    const navItem = navItemBySection.get(section);\n\n                    if (!searchActive) {\n                        const hide = currentViewMode === 'essential' && getSectionVisibility(section) === 'advanced';\n\n                        if (hide) {\n                            section.setAttribute('hidden', 'hidden');\n\n                            if (link) {\n                                link.setAttribute('hidden', 'hidden');\n                                link.removeAttribute('aria-current');\n                            }\n\n                            if (navItem) {\n                                navItem.setAttribute('hidden', 'hidden');\n                            }\n\n                            return;\n                        }\n\n                        section.removeAttribute('hidden');\n\n                        if (link) {\n                            link.removeAttribute('hidden');\n                        }\n\n                        if (navItem) {\n                            navItem.removeAttribute('hidden');\n                        }\n\n                        return;\n                    }\n\n                    const text = (section.textContent || '').toLowerCase();\n                    const isMatch = text.includes(query);\n\n                    if (isMatch) {\n                        section.removeAttribute('hidden');\n                        section.setAttribute('data-mga-section-highlight', 'true');\n                        visibleCount += 1;\n\n                        if (link) {\n                            link.removeAttribute('hidden');\n                        }\n\n                        if (navItem) {\n                            navItem.removeAttribute('hidden');\n                        }\n                    } else {\n                        section.setAttribute('hidden', 'hidden');\n                        section.removeAttribute('data-mga-section-highlight');\n\n                        if (link) {\n                            link.setAttribute('hidden', 'hidden');\n                            link.removeAttribute('aria-current');\n                        }\n\n                        if (navItem) {\n                            navItem.setAttribute('hidden', 'hidden');\n                        }\n                    }\n                });\n\n                if (searchActive) {\n                    const firstMatch = sections.find((section) => !section.hasAttribute('hidden'));\n\n                    if (firstMatch) {\n                        setActiveLink(firstMatch);\n                    }\n                }\n\n                updateEmptyState(visibleCount, searchActive);\n            };\n\n            const applyViewMode = (nextMode, options = {}) => {\n                const normalized = nextMode === 'advanced' ? 'advanced' : 'essential';\n\n                if (normalized === currentViewMode && !options.force) {\n                    return;\n                }\n\n                currentViewMode = normalized;\n                syncViewSelect();\n                updateLayoutViewMode();\n\n                if (options.persist !== false) {\n                    persistViewMode();\n                }\n\n                const currentQuery = searchInput ? searchInput.value || '' : '';\n                filterSections(currentQuery);\n            };\n\n            navLinks.forEach((link) => {\n                const href = link.getAttribute('href');\n\n                if (!href || href.charAt(0) !== '#') {\n                    return;\n                }\n\n                const target = layout.querySelector(href);\n\n                if (!target) {\n                    return;\n                }\n\n                linkBySection.set(target, link);\n                const navItem = link.closest('[data-mga-visibility]');\n\n                if (navItem) {\n                    navItemBySection.set(target, navItem);\n                }\n\n                link.addEventListener('click', (event) => {\n                    event.preventDefault();\n\n                    if (target.hasAttribute('hidden')) {\n                        target.removeAttribute('hidden');\n                    }\n\n                    try {\n                        target.scrollIntoView({ behavior: 'smooth', block: 'start' });\n                    } catch (error) {\n                        if (typeof target.scrollIntoView === 'function') {\n                            target.scrollIntoView();\n                        }\n                    }\n\n                    setActiveLink(target);\n                    highlightSection(target);\n\n                    const focusOptions = detectFocusOptionsSupport() ? { preventScroll: true } : undefined;\n\n                    if (typeof global.requestAnimationFrame === 'function') {\n                        global.requestAnimationFrame(() => {\n                            safeFocus(target, focusOptions);\n                        });\n                    } else {\n                        safeFocus(target, focusOptions);\n                    }\n                });\n            });\n\n            syncViewSelect();\n            updateLayoutViewMode();\n\n            if (viewSelect) {\n                viewSelect.addEventListener('change', (event) => {\n                    applyViewMode(event.target.value || 'essential');\n                });\n            }\n\n            if ('IntersectionObserver' in global) {\n                let lastVisibleSection = null;\n\n                const observer = new IntersectionObserver((entries) => {\n                    if (isSearchActive()) {\n                        return;\n                    }\n\n                    entries.forEach((entry) => {\n                        if (entry.isIntersecting) {\n                            lastVisibleSection = entry.target;\n                        }\n                    });\n\n                    if (lastVisibleSection) {\n                        setActiveLink(lastVisibleSection);\n                    }\n                }, {\n                    rootMargin: '-40% 0px -40% 0px',\n                    threshold: 0.1,\n                });\n\n                sections.forEach((section) => observer.observe(section));\n            } else {\n                const handleScroll = () => {\n                    if (isSearchActive()) {\n                        return;\n                    }\n\n                    let bestSection = null;\n                    let bestOffset = Infinity;\n                    const scrollY = global.pageYOffset || doc.documentElement.scrollTop || 0;\n\n                    sections.forEach((section) => {\n                        const rect = section.getBoundingClientRect();\n                        const absoluteTop = rect.top + scrollY;\n                        const delta = Math.abs(absoluteTop - scrollY - 140);\n\n                        if (delta < bestOffset) {\n                            bestSection = section;\n                            bestOffset = delta;\n                        }\n                    });\n\n                    if (bestSection) {\n                        setActiveLink(bestSection);\n                    }\n                };\n\n                global.addEventListener('scroll', handleScroll, { passive: true });\n                handleScroll();\n            }\n\n            if (searchInput) {\n                searchInput.addEventListener('input', (event) => {\n                    filterSections(event.target.value || '');\n                });\n\n                filterSections(searchInput.value || '');\n            } else {\n                updateEmptyState(sections.length, false);\n            }\n\n            applyViewMode(currentViewMode, { force: true, persist: false });\n\n            if (!isSearchActive()) {\n                setActiveLink(sections[0]);\n            }\n        };\n\n        initSettingsNavigation();\n\n        // Live update for range sliders\n        const bindRangeToOutput = (sliderId, outputId, displayFormatter, ariaFormatter) => {\n            const slider = doc.getElementById(sliderId);\n            const output = doc.getElementById(outputId);\n\n            if (!slider || !output) {\n                return;\n            }\n\n            const updateOutput = () => {\n                const value = slider.value;\n                const displayValue = typeof displayFormatter === 'function'\n                    ? displayFormatter(value)\n                    : value;\n                const ariaValue = typeof ariaFormatter === 'function'\n                    ? ariaFormatter(value)\n                    : displayValue;\n\n                if (typeof output.value !== 'undefined') {\n                    output.value = displayValue;\n                }\n\n                output.textContent = displayValue;\n                slider.setAttribute('aria-valuenow', value);\n                slider.setAttribute('aria-valuetext', ariaValue);\n            };\n\n            slider.addEventListener('input', updateOutput);\n            updateOutput();\n        };\n\n        bindRangeToOutput(\n            'mga_thumb_size',\n            'mga_thumb_size_value',\n            (value) => mgaAdminSprintf(mgaAdmin__('%spx', 'lightbox-jlg'), value),\n            (value) => mgaAdminSprintf(mgaAdmin__('%s pixels', 'lightbox-jlg'), value)\n        );\n\n        bindRangeToOutput(\n            'mga_thumb_size_mobile',\n            'mga_thumb_size_mobile_value',\n            (value) => mgaAdminSprintf(mgaAdmin__('%spx', 'lightbox-jlg'), value),\n            (value) => mgaAdminSprintf(mgaAdmin__('%s pixels', 'lightbox-jlg'), value)\n        );\n\n        bindRangeToOutput(\n            'mga_bg_opacity',\n            'mga_bg_opacity_value',\n            (value) => value,\n            (value) => mgaAdminSprintf(mgaAdmin__('%s opacity', 'lightbox-jlg'), value)\n        );\n\n        const accentColorInput = doc.getElementById('mga_accent_color');\n        const accentColorPreview = doc.getElementById('mga_accent_color_preview');\n\n        if (accentColorInput) {\n            const defaultColorAttr = accentColorInput.getAttribute('data-default-color');\n            const fallbackColor = isValidHexColor(defaultColorAttr) ? defaultColorAttr : '#ffffff';\n\n            const applyPreviewColor = (rawColor) => {\n                const color = isValidHexColor(rawColor) ? rawColor : fallbackColor;\n\n                if (accentColorPreview) {\n                    accentColorPreview.style.backgroundColor = color;\n                }\n\n                return color;\n            };\n\n            applyPreviewColor(accentColorInput.value);\n\n            const maybeJQuery = global.jQuery;\n\n            if (maybeJQuery && typeof maybeJQuery.fn === 'object' && typeof maybeJQuery.fn.wpColorPicker === 'function') {\n                maybeJQuery(accentColorInput).wpColorPicker({\n                    change(event, ui) {\n                        const colorValue = ui && ui.color ? ui.color.toString() : event.target.value;\n                        applyPreviewColor(colorValue);\n                    },\n                    clear() {\n                        const defaultColor = accentColorInput.getAttribute('data-default-color') || fallbackColor;\n                        maybeJQuery(accentColorInput).val(defaultColor);\n                        applyPreviewColor(defaultColor);\n                    },\n                });\n\n                maybeJQuery(accentColorInput).on('input', (event) => {\n                    applyPreviewColor(event.target.value);\n                });\n            } else {\n                accentColorInput.addEventListener('input', () => {\n                    applyPreviewColor(accentColorInput.value);\n                });\n            }\n        }\n\n        const initLivePreview = () => {\n            const previewContainer = doc.querySelector('[data-mga-live-preview]');\n\n            if (!previewContainer) {\n                return;\n            }\n\n            const previewMock = previewContainer.querySelector('[data-mga-live-preview-mock]');\n            const effectLabel = previewContainer.querySelector('[data-mga-preview-effect]');\n            const thumbsContainer = previewContainer.querySelector('[data-mga-preview-thumbs]');\n            const toolbarActions = {\n                zoom: previewContainer.querySelector('[data-preview-action=\"zoom\"]'),\n                download: previewContainer.querySelector('[data-preview-action=\"download\"]'),\n                share: previewContainer.querySelector('[data-preview-action=\"share\"]'),\n                cta: previewContainer.querySelector('[data-preview-action=\"cta\"]'),\n                fullscreen: previewContainer.querySelector('[data-preview-action=\"fullscreen\"]'),\n            };\n\n            const effectNameMap = {\n                slide: mgaAdmin__('glissement', 'lightbox-jlg'),\n                fade: mgaAdmin__('fondu', 'lightbox-jlg'),\n                cube: mgaAdmin__('cube 3D', 'lightbox-jlg'),\n                coverflow: mgaAdmin__('coverflow', 'lightbox-jlg'),\n                flip: mgaAdmin__('flip 3D', 'lightbox-jlg'),\n            };\n\n            const setAccent = (value) => {\n                if (!previewMock) {\n                    return;\n                }\n\n                const color = isValidHexColor(value) ? value : '#6366f1';\n                previewMock.style.setProperty('--mga-preview-accent', color);\n            };\n\n            const setOverlay = (value) => {\n                if (!previewMock) {\n                    return;\n                }\n\n                const numeric = parseFloat(value);\n\n                if (Number.isNaN(numeric)) {\n                    return;\n                }\n\n                const clamped = Math.min(Math.max(numeric, 0), 1);\n                previewMock.style.setProperty('--mga-preview-overlay', `rgba(15, 23, 42, ${clamped})`);\n            };\n\n            const setBackgroundStyle = (style) => {\n                if (!previewMock) {\n                    return;\n                }\n\n                const normalized = typeof style === 'string' && style ? style : 'echo';\n                previewMock.setAttribute('data-preview-style', normalized);\n            };\n\n            const toggleAction = (name, enabled) => {\n                const action = toolbarActions[name];\n\n                if (!action) {\n                    return;\n                }\n\n                action.setAttribute('data-preview-hidden', enabled ? 'false' : 'true');\n                action.setAttribute('aria-hidden', enabled ? 'false' : 'true');\n            };\n\n            const setThumbScale = (value) => {\n                if (!thumbsContainer) {\n                    return;\n                }\n\n                const numeric = parseFloat(value);\n\n                if (Number.isNaN(numeric)) {\n                    thumbsContainer.style.setProperty('--mga-preview-thumb-scale', '1');\n                    return;\n                }\n\n                const normalized = Math.min(Math.max(numeric / 90, 0.6), 1.4);\n                thumbsContainer.style.setProperty('--mga-preview-thumb-scale', normalized.toString());\n            };\n\n            const updateEffectLabel = () => {\n                if (!effectLabel) {\n                    return;\n                }\n\n                const effectSelect = doc.getElementById('mga_effect');\n                const delayInput = doc.getElementById('mga_delay');\n                const speedInput = doc.getElementById('mga_speed');\n                const effectValue = effectSelect ? effectSelect.value : '';\n                const delayValue = delayInput ? delayInput.value || '4' : '4';\n                const speedValue = speedInput ? speedInput.value || '600' : '600';\n                const effectLabelText = effectNameMap[effectValue] || mgaAdmin__('personnalis\u00E9e', 'lightbox-jlg');\n\n                effectLabel.textContent = mgaAdminSprintf(\n                    mgaAdmin__('Transition : %1$s \u2022 %2$ss / %3$sms', 'lightbox-jlg'),\n                    effectLabelText,\n                    delayValue,\n                    speedValue\n                );\n            };\n\n            const bindPreviewControl = (id, handler, events = ['change']) => {\n                const element = doc.getElementById(id);\n\n                if (!element || typeof handler !== 'function') {\n                    return;\n                }\n\n                const invoke = () => {\n                    if (element.type === 'checkbox') {\n                        handler(element.checked, element);\n                    } else {\n                        handler(element.value, element);\n                    }\n                };\n\n                events.forEach((eventName) => {\n                    element.addEventListener(eventName, invoke);\n                });\n\n                invoke();\n            };\n\n            bindPreviewControl('mga_accent_color', setAccent, ['input', 'change']);\n            bindPreviewControl('mga_bg_opacity', setOverlay, ['input', 'change']);\n            bindPreviewControl('mga_background_style', setBackgroundStyle);\n            bindPreviewControl('mga_thumb_size', setThumbScale, ['input', 'change']);\n            bindPreviewControl('mga_show_zoom', (checked) => toggleAction('zoom', checked));\n            bindPreviewControl('mga_show_download', (checked) => toggleAction('download', checked));\n            bindPreviewControl('mga_show_share', (checked) => toggleAction('share', checked));\n            bindPreviewControl('mga_show_cta', (checked) => toggleAction('cta', checked));\n            bindPreviewControl('mga_show_fullscreen', (checked) => toggleAction('fullscreen', checked));\n            bindPreviewControl('mga_effect', updateEffectLabel);\n            bindPreviewControl('mga_delay', updateEffectLabel, ['input', 'change']);\n            bindPreviewControl('mga_speed', updateEffectLabel, ['input', 'change']);\n        };\n\n        initLivePreview();\n\n        const stylePresetExport = global.mgaStylePresets && typeof global.mgaStylePresets === 'object'\n            ? global.mgaStylePresets\n            : {};\n        const stylePresets = stylePresetExport.presets && typeof stylePresetExport.presets === 'object'\n            ? stylePresetExport.presets\n            : {};\n        const presetSelect = doc.getElementById('mga_style_preset');\n        const applyPresetButton = doc.querySelector('[data-mga-apply-style-preset]');\n        const resetPresetButton = doc.querySelector('[data-mga-reset-style-preset]');\n        const presetDescription = doc.querySelector('[data-mga-style-preset-description]');\n        let isApplyingPreset = false;\n\n        const maybeDispatchEvent = (element, eventType) => {\n            if (!element || typeof element.dispatchEvent !== 'function') {\n                return;\n            }\n\n            try {\n                element.dispatchEvent(new Event(eventType, { bubbles: true }));\n            } catch (error) {\n                if (typeof doc.createEvent === 'function') {\n                    try {\n                        const fallbackEvent = doc.createEvent('Event');\n                        fallbackEvent.initEvent(eventType, true, true);\n                        element.dispatchEvent(fallbackEvent);\n                    } catch (fallbackError) {\n                        // Ignore unsupported event creation paths.\n                    }\n                }\n            }\n        };\n\n        const setNumericInputValue = (id, value) => {\n            const input = doc.getElementById(id);\n\n            if (!input) {\n                return;\n            }\n\n            input.value = value;\n            maybeDispatchEvent(input, 'input');\n            maybeDispatchEvent(input, 'change');\n        };\n\n        const setRangeInputValue = setNumericInputValue;\n\n        const setSelectValue = (id, value) => {\n            const select = doc.getElementById(id);\n\n            if (!select) {\n                return;\n            }\n\n            select.value = value;\n            maybeDispatchEvent(select, 'change');\n        };\n\n        const setCheckboxValue = (id, value) => {\n            const checkbox = doc.getElementById(id);\n\n            if (!checkbox) {\n                return;\n            }\n\n            checkbox.checked = Boolean(value);\n            maybeDispatchEvent(checkbox, 'change');\n        };\n\n        const setAccentColorValue = (value) => {\n            if (!accentColorInput) {\n                return;\n            }\n\n            const targetColor = typeof value === 'string' ? value : '';\n            const maybeJQuery = global.jQuery;\n\n            if (maybeJQuery && typeof maybeJQuery.fn === 'object' && typeof maybeJQuery.fn.wpColorPicker === 'function') {\n                const picker = maybeJQuery(accentColorInput);\n\n                if (picker && typeof picker.wpColorPicker === 'function') {\n                    picker.wpColorPicker('color', targetColor);\n                    return;\n                }\n            }\n\n            accentColorInput.value = targetColor;\n            maybeDispatchEvent(accentColorInput, 'change');\n        };\n\n        const applyPresetSettings = (settings) => {\n            if (!settings || typeof settings !== 'object') {\n                return;\n            }\n\n            if (Object.prototype.hasOwnProperty.call(settings, 'delay')) {\n                setNumericInputValue('mga_delay', settings.delay);\n            }\n\n            if (Object.prototype.hasOwnProperty.call(settings, 'speed')) {\n                setNumericInputValue('mga_speed', settings.speed);\n            }\n\n            if (Object.prototype.hasOwnProperty.call(settings, 'effect')) {\n                setSelectValue('mga_effect', settings.effect);\n            }\n\n            if (Object.prototype.hasOwnProperty.call(settings, 'easing')) {\n                setSelectValue('mga_easing', settings.easing);\n            }\n\n            if (Object.prototype.hasOwnProperty.call(settings, 'thumbs_layout')) {\n                setSelectValue('mga_thumbs_layout', settings.thumbs_layout);\n            }\n\n            if (Object.prototype.hasOwnProperty.call(settings, 'thumb_size')) {\n                setRangeInputValue('mga_thumb_size', settings.thumb_size);\n            }\n\n            if (Object.prototype.hasOwnProperty.call(settings, 'thumb_size_mobile')) {\n                setRangeInputValue('mga_thumb_size_mobile', settings.thumb_size_mobile);\n            }\n\n            if (Object.prototype.hasOwnProperty.call(settings, 'show_thumbs_mobile')) {\n                setCheckboxValue('mga_show_thumbs_mobile', settings.show_thumbs_mobile);\n            }\n\n            if (Object.prototype.hasOwnProperty.call(settings, 'accent_color')) {\n                setAccentColorValue(settings.accent_color);\n            }\n\n            if (Object.prototype.hasOwnProperty.call(settings, 'bg_opacity')) {\n                setRangeInputValue('mga_bg_opacity', settings.bg_opacity);\n            }\n\n            if (Object.prototype.hasOwnProperty.call(settings, 'background_style')) {\n                setSelectValue('mga_background_style', settings.background_style);\n            }\n\n            if (Object.prototype.hasOwnProperty.call(settings, 'autoplay_start')) {\n                setCheckboxValue('mga_autoplay_start', settings.autoplay_start);\n            }\n\n            if (Object.prototype.hasOwnProperty.call(settings, 'loop')) {\n                setCheckboxValue('mga_loop', settings.loop);\n            }\n\n            if (Object.prototype.hasOwnProperty.call(settings, 'show_zoom')) {\n                setCheckboxValue('mga_show_zoom', settings.show_zoom);\n            }\n\n            if (Object.prototype.hasOwnProperty.call(settings, 'show_download')) {\n                setCheckboxValue('mga_show_download', settings.show_download);\n            }\n\n            if (Object.prototype.hasOwnProperty.call(settings, 'show_share')) {\n                setCheckboxValue('mga_show_share', settings.show_share);\n            }\n\n            if (Object.prototype.hasOwnProperty.call(settings, 'show_cta')) {\n                setCheckboxValue('mga_show_cta', settings.show_cta);\n            }\n\n            if (Object.prototype.hasOwnProperty.call(settings, 'show_fullscreen')) {\n                setCheckboxValue('mga_show_fullscreen', settings.show_fullscreen);\n            }\n        };\n\n        const updatePresetDescription = () => {\n            if (!presetDescription) {\n                return;\n            }\n\n            const key = presetSelect ? presetSelect.value : '';\n\n            if (key && stylePresets[key] && stylePresets[key].description) {\n                presetDescription.textContent = stylePresets[key].description;\n                return;\n            }\n\n            const customDescription = typeof stylePresetExport.customDescription === 'string'\n                ? stylePresetExport.customDescription\n                : '';\n\n            presetDescription.textContent = customDescription;\n        };\n\n        const markPresetAsCustom = () => {\n            if (isApplyingPreset || !presetSelect) {\n                return;\n            }\n\n            if (presetSelect.value === '') {\n                return;\n            }\n\n            presetSelect.value = '';\n            updatePresetDescription();\n        };\n\n        const registerPresetWatcher = (id) => {\n            const element = doc.getElementById(id);\n\n            if (!element) {\n                return;\n            }\n\n            const eventNames = ['change'];\n\n            if (element.tagName === 'INPUT' && ['text', 'number', 'range'].includes(element.type)) {\n                eventNames.push('input');\n            }\n\n            eventNames.forEach((eventName) => {\n                element.addEventListener(eventName, markPresetAsCustom);\n            });\n        };\n\n        if (presetSelect) {\n            updatePresetDescription();\n            presetSelect.addEventListener('change', updatePresetDescription);\n        }\n\n        if (applyPresetButton) {\n            applyPresetButton.addEventListener('click', (event) => {\n                event.preventDefault();\n\n                if (!presetSelect) {\n                    return;\n                }\n\n                const key = presetSelect.value;\n\n                if (!key || !stylePresets[key]) {\n                    return;\n                }\n\n                isApplyingPreset = true;\n                applyPresetSettings(stylePresets[key].settings || {});\n                isApplyingPreset = false;\n                updatePresetDescription();\n            });\n        }\n\n        if (resetPresetButton) {\n            resetPresetButton.addEventListener('click', (event) => {\n                event.preventDefault();\n\n                const defaults = stylePresetExport.defaults || {};\n\n                if (defaults && typeof defaults === 'object' && Object.keys(defaults).length > 0) {\n                    isApplyingPreset = true;\n                    applyPresetSettings(defaults);\n                    isApplyingPreset = false;\n                }\n\n                if (presetSelect) {\n                    presetSelect.value = '';\n                }\n\n                updatePresetDescription();\n            });\n        }\n\n        [\n            'mga_delay',\n            'mga_speed',\n            'mga_effect',\n            'mga_easing',\n            'mga_thumb_size',\n            'mga_thumb_size_mobile',\n            'mga_thumbs_layout',\n            'mga_accent_color',\n            'mga_bg_opacity',\n            'mga_background_style',\n            'mga_show_thumbs_mobile',\n            'mga_autoplay_start',\n            'mga_loop',\n            'mga_show_zoom',\n            'mga_show_download',\n            'mga_show_share',\n            'mga_show_cta',\n            'mga_show_fullscreen',\n        ].forEach(registerPresetWatcher);\n\n        const shareRepeater = doc.querySelector('[data-share-repeater]');\n\n        if (shareRepeater) {\n            initShareRepeater(shareRepeater);\n        }\n\n        const selectorsWrapper = doc.querySelector('[data-mga-content-selectors]');\n\n        if (selectorsWrapper) {\n            const selectorsList = selectorsWrapper.querySelector('[data-mga-content-selectors-list]');\n            const selectorsTextarea = selectorsWrapper.querySelector('[data-mga-content-selectors-textarea]');\n            const template = doc.getElementById('mga-content-selector-template');\n            const placeholder = selectorsWrapper.getAttribute('data-mga-selector-placeholder') || '';\n            let isSyncingSelectors = false;\n            let addRow = () => {};\n\n            if (selectorsList) {\n                const queryRows = () => selectorsList.querySelectorAll('[data-mga-content-selector-row]');\n                const queryInputs = () => selectorsList.querySelectorAll('[data-mga-content-selector-input]');\n                const hasEmptyRow = () => Array.from(queryInputs()).some((input) => input.value.trim() === '');\n\n                const updateRemoveState = () => {\n                    const rows = queryRows();\n                    const disable = rows.length <= 1;\n\n                    rows.forEach((row) => {\n                        const removeButton = row.querySelector('[data-mga-remove-selector]');\n\n                        if (removeButton) {\n                            removeButton.disabled = disable;\n                            removeButton.setAttribute('aria-disabled', disable ? 'true' : 'false');\n                        }\n                    });\n                };\n\n                const getRowValues = () => Array.from(queryInputs()).map((input) => input.value.trim()).filter((value) => value !== '');\n\n                const syncTextareaFromRows = () => {\n                    if (!selectorsTextarea || isSyncingSelectors) {\n                        return;\n                    }\n\n                    const values = getRowValues();\n                    isSyncingSelectors = true;\n                    selectorsTextarea.value = values.join('\\n');\n                    isSyncingSelectors = false;\n                };\n\n                const bindRow = (row) => {\n                    if (!row || row.getAttribute('data-mga-selector-bound') === 'true') {\n                        return;\n                    }\n\n                    const removeButton = row.querySelector('[data-mga-remove-selector]');\n\n                    if (removeButton) {\n                        removeButton.addEventListener('click', (event) => {\n                            event.preventDefault();\n                            const rows = queryRows();\n\n                            if (rows.length <= 1) {\n                                const input = row.querySelector('[data-mga-content-selector-input]');\n\n                                if (input) {\n                                    input.value = '';\n                                    syncTextareaFromRows();\n                                }\n\n                                return;\n                            }\n\n                            row.remove();\n                            updateRemoveState();\n                            syncTextareaFromRows();\n                        });\n                    }\n\n                    const input = row.querySelector('[data-mga-content-selector-input]');\n\n                    if (input) {\n                        input.addEventListener('input', () => {\n                            if (!isSyncingSelectors) {\n                                syncTextareaFromRows();\n                            }\n                        });\n\n                        input.addEventListener('keydown', (event) => {\n                            if (event.key !== 'Enter' || event.shiftKey || event.altKey || event.metaKey || event.ctrlKey) {\n                                return;\n                            }\n\n                            event.preventDefault();\n\n                            if (!hasEmptyRow() && typeof addRow === 'function') {\n                                addRow('');\n                                return;\n                            }\n\n                            const rows = queryRows();\n\n                            if (rows.length === 0) {\n                                return;\n                            }\n\n                            const lastRow = rows[rows.length - 1];\n\n                            if (!lastRow) {\n                                return;\n                            }\n\n                            const lastInput = lastRow.querySelector('[data-mga-content-selector-input]');\n\n                            if (lastInput && lastInput !== event.target) {\n                                safeFocus(lastInput);\n                            }\n                        });\n\n                        if (placeholder && !input.getAttribute('placeholder')) {\n                            input.setAttribute('placeholder', placeholder);\n                        }\n                    }\n\n                    row.setAttribute('data-mga-selector-bound', 'true');\n                };\n\n                const createRow = (value = '') => {\n                    let row = null;\n\n                    if (template && template.content) {\n                        const fragment = doc.importNode(template.content, true);\n\n                        row = fragment.firstElementChild;\n                        if (row) {\n                            const input = row.querySelector('[data-mga-content-selector-input]');\n\n                            if (input) {\n                                input.value = value;\n\n                                if (placeholder) {\n                                    input.setAttribute('placeholder', placeholder);\n                                }\n                            }\n\n                            bindRow(row);\n\n                            return row;\n                        }\n                    }\n\n                    row = doc.createElement('div');\n                    row.className = 'mga-content-selectors__row';\n                    row.setAttribute('data-mga-content-selector-row', '');\n\n                    const input = doc.createElement('input');\n                    input.type = 'text';\n                    input.className = 'regular-text';\n                    input.setAttribute('data-mga-content-selector-input', '');\n                    input.value = value;\n\n                    if (placeholder) {\n                        input.setAttribute('placeholder', placeholder);\n                    }\n\n                    row.appendChild(input);\n\n                    const removeButton = doc.createElement('button');\n                    removeButton.type = 'button';\n                    removeButton.className = 'button-link mga-content-selectors__remove';\n                    removeButton.setAttribute('data-mga-remove-selector', '');\n                    removeButton.textContent = mgaAdmin__('Retirer', 'lightbox-jlg');\n                    row.appendChild(removeButton);\n\n                    bindRow(row);\n\n                    return row;\n                };\n\n                const renderRows = (values) => {\n                    selectorsList.innerHTML = '';\n\n                    if (values.length === 0) {\n                        const emptyRow = createRow('');\n                        if (emptyRow) {\n                            selectorsList.appendChild(emptyRow);\n                        }\n                    } else {\n                        values.forEach((value) => {\n                            const row = createRow(value);\n\n                            if (row) {\n                                selectorsList.appendChild(row);\n                            }\n                        });\n                    }\n\n                    updateRemoveState();\n                };\n\n                const syncRowsFromTextarea = () => {\n                    if (!selectorsTextarea || isSyncingSelectors) {\n                        return;\n                    }\n\n                    const values = selectorsTextarea.value\n                        .split(/\\r\\n|\\r|\\n/)\n                        .map((selector) => selector.trim())\n                        .filter((selector) => selector.length > 0);\n\n                    isSyncingSelectors = true;\n                    renderRows(values);\n                    isSyncingSelectors = false;\n                };\n\n                addRow = (value = '') => {\n                    const row = createRow(value);\n\n                    if (row) {\n                        selectorsList.appendChild(row);\n                        updateRemoveState();\n\n                        const input = row.querySelector('[data-mga-content-selector-input]');\n\n                        if (input) {\n                            safeFocus(input);\n                        }\n                    }\n\n                    syncTextareaFromRows();\n                };\n\n                if (selectorsTextarea) {\n                    syncRowsFromTextarea();\n\n                    selectorsTextarea.addEventListener('input', () => {\n                        if (!isSyncingSelectors) {\n                            syncRowsFromTextarea();\n                        }\n                    });\n                } else {\n                    renderRows([]);\n                }\n\n                const addButton = selectorsWrapper.querySelector('[data-mga-add-selector]');\n\n                if (addButton) {\n                    addButton.addEventListener('click', (event) => {\n                        event.preventDefault();\n                        addRow();\n                    });\n                }\n            }\n        }\n        function initShareRepeater(container) {\n            const list = container.querySelector('[data-share-repeater-list]');\n            const addButton = container.querySelector('[data-share-repeater-add]');\n            const template = doc.getElementById('mga-share-channel-template');\n\n            if (!list || !template) {\n                return;\n            }\n\n            let uidSeed = Date.now();\n\n            const generateUid = () => {\n                uidSeed += 1;\n                return `mga-share-channel-${uidSeed}`;\n            };\n\n            const ensureItemUid = (item) => {\n                if (!item) {\n                    return null;\n                }\n\n                if (!item.dataset.shareUid || item.dataset.shareUid.trim() === '') {\n                    item.dataset.shareUid = generateUid();\n                }\n\n                return item.dataset.shareUid;\n            };\n\n            const applyUid = (item) => {\n                const uid = ensureItemUid(item);\n\n                if (!uid) {\n                    return;\n                }\n\n                const idElements = item.querySelectorAll('[data-share-id-suffix]');\n\n                idElements.forEach((element) => {\n                    const suffix = element.getAttribute('data-share-id-suffix');\n\n                    if (!suffix) {\n                        return;\n                    }\n\n                    const id = `${uid}-${suffix}`;\n\n                    if (element.tagName === 'LABEL') {\n                        element.setAttribute('for', id);\n                    } else {\n                        element.id = id;\n                    }\n                });\n            };\n\n            const refreshItemTitle = (item) => {\n                if (!item) {\n                    return;\n                }\n\n                const title = item.querySelector('[data-share-repeater-title]');\n\n                if (!title) {\n                    return;\n                }\n\n                const labelInput = item.querySelector('[data-share-field=\"label\"]');\n                const keyInput = item.querySelector('[data-share-field=\"key\"]');\n                const labelValue = labelInput && typeof labelInput.value === 'string' ? labelInput.value.trim() : '';\n                const keyValue = keyInput && typeof keyInput.value === 'string' ? keyInput.value.trim() : '';\n                const fallback = keyValue ? keyValue.toUpperCase() : mgaAdmin__('Nouveau canal', 'lightbox-jlg');\n\n                title.textContent = labelValue || fallback;\n            };\n\n            const updateIconPreview = (item) => {\n                if (!item) {\n                    return;\n                }\n\n                const preview = item.querySelector('[data-share-icon-preview]');\n                const select = item.querySelector('[data-share-field=\"icon\"]');\n\n                if (!preview) {\n                    return;\n                }\n\n                const iconKey = select ? select.value : '';\n                const iconSvg = createShareIconPreview(iconKey);\n\n                preview.innerHTML = '';\n\n                if (iconSvg) {\n                    preview.appendChild(iconSvg);\n                }\n\n                const summaryIcon = item.querySelector('[data-share-preview-icon]');\n\n                if (summaryIcon) {\n                    summaryIcon.innerHTML = '';\n\n                    const summarySvg = createShareIconPreview(iconKey);\n\n                    if (summarySvg) {\n                        summaryIcon.appendChild(summarySvg);\n                    }\n                }\n            };\n\n            const getShareField = (item, key) => {\n                if (!item || !key) {\n                    return null;\n                }\n\n                return item.querySelector(`[data-share-field=\"${key}\"]`);\n            };\n\n            const getShareFieldValue = (item, key) => {\n                const field = getShareField(item, key);\n                const value = field && typeof field.value === 'string' ? field.value.trim() : '';\n                return value;\n            };\n\n            const buildSharePreviewUrl = (template) => {\n                if (typeof template !== 'string') {\n                    return '';\n                }\n\n                let previewValue = template;\n\n                Object.keys(SHARE_TEMPLATE_PLACEHOLDERS).forEach((token) => {\n                    const replacement = encodeURIComponent(SHARE_TEMPLATE_PLACEHOLDERS[token]);\n                    previewValue = previewValue.replace(new RegExp(token, 'gi'), replacement);\n                });\n\n                return previewValue;\n            };\n\n            const hasRequiredPlaceholder = (template) => /%url%/i.test(typeof template === 'string' ? template : '');\n\n            const isTemplateSchemeValid = (template) => {\n                if (typeof template !== 'string') {\n                    return false;\n                }\n\n                const trimmed = template.trim();\n\n                if (trimmed === '') {\n                    return false;\n                }\n\n                const scheme = trimmed.split(':')[0].toLowerCase();\n\n                if (!SHARE_TEMPLATE_SCHEMES.includes(scheme)) {\n                    return false;\n                }\n\n                if (scheme === 'http' || scheme === 'https') {\n                    return /^https?:\\/\\//i.test(trimmed);\n                }\n\n                return true;\n            };\n\n            const applyFieldError = (field, messageElement, message) => {\n                const hasMessage = typeof message === 'string' && message !== '';\n\n                if (field) {\n                    if (hasMessage) {\n                        field.classList.add('mga-field-error');\n                        field.setAttribute('aria-invalid', 'true');\n                    } else {\n                        field.classList.remove('mga-field-error');\n                        field.removeAttribute('aria-invalid');\n                    }\n                }\n\n                if (messageElement) {\n                    if (hasMessage) {\n                        messageElement.textContent = message;\n                        messageElement.removeAttribute('hidden');\n                    } else {\n                        messageElement.textContent = '';\n                        messageElement.setAttribute('hidden', 'hidden');\n                    }\n                }\n            };\n\n            const updateSharePreview = (item) => {\n                if (!item) {\n                    return;\n                }\n\n                const preview = item.querySelector('[data-share-preview]');\n\n                if (!preview) {\n                    return;\n                }\n\n                const labelElement = preview.querySelector('[data-share-preview-label]');\n                const urlElement = preview.querySelector('[data-share-preview-url]');\n                const labelValue = getShareFieldValue(item, 'label');\n                const keyValue = getShareFieldValue(item, 'key');\n                const fallbackLabel = keyValue ? keyValue.toUpperCase() : mgaAdmin__('Nouveau canal', 'lightbox-jlg');\n\n                if (labelElement) {\n                    labelElement.textContent = labelValue || fallbackLabel;\n                }\n\n                if (urlElement) {\n                    const templateValue = getShareFieldValue(item, 'template');\n\n                    if (templateValue) {\n                        const previewUrl = buildSharePreviewUrl(templateValue);\n                        urlElement.textContent = previewUrl;\n                        urlElement.setAttribute('data-preview-empty', 'false');\n                        urlElement.title = previewUrl;\n                    } else {\n                        urlElement.textContent = mgaAdmin__('Compl\u00E9tez le mod\u00E8le pour g\u00E9n\u00E9rer un lien.', 'lightbox-jlg');\n                        urlElement.setAttribute('data-preview-empty', 'true');\n                        urlElement.removeAttribute('title');\n                    }\n                }\n\n                scheduleSummaryRefresh();\n            };\n\n            const validateShareItems = () => {\n                const items = Array.from(list.querySelectorAll('[data-share-repeater-item]'));\n                const keyOccurrences = items.reduce((accumulator, item) => {\n                    const keyValue = getShareFieldValue(item, 'key').toLowerCase();\n\n                    if (keyValue) {\n                        accumulator[keyValue] = (accumulator[keyValue] || 0) + 1;\n                    }\n\n                    return accumulator;\n                }, {});\n\n                items.forEach((item) => {\n                    const keyInput = getShareField(item, 'key');\n                    const templateInput = getShareField(item, 'template');\n                    const keyMessageEl = item.querySelector('[data-share-error=\"key\"]');\n                    const templateMessageEl = item.querySelector('[data-share-error=\"template\"]');\n                    const rawKeyValue = getShareFieldValue(item, 'key');\n                    const normalizedKey = rawKeyValue.toLowerCase();\n                    let keyMessage = '';\n\n                    if (!rawKeyValue) {\n                        keyMessage = mgaAdmin__('Renseignez une cl\u00E9 pour ce canal.', 'lightbox-jlg');\n                    } else if (!/^[a-z0-9_-]+$/i.test(rawKeyValue)) {\n                        keyMessage = mgaAdmin__('Utilisez uniquement des lettres, chiffres ou tirets.', 'lightbox-jlg');\n                    } else if (keyOccurrences[normalizedKey] > 1) {\n                        keyMessage = mgaAdmin__('Chaque cl\u00E9 doit \u00EAtre unique.', 'lightbox-jlg');\n                    }\n\n                    applyFieldError(keyInput, keyMessageEl, keyMessage);\n\n                    const templateValue = getShareFieldValue(item, 'template');\n                    let templateMessage = '';\n\n                    if (!templateValue) {\n                        templateMessage = mgaAdmin__('Renseignez un mod\u00E8le d\u2019URL.', 'lightbox-jlg');\n                    } else if (!hasRequiredPlaceholder(templateValue)) {\n                        templateMessage = mgaAdmin__('Ajoutez au moins le jeton %url% pour construire le lien.', 'lightbox-jlg');\n                    } else if (!isTemplateSchemeValid(templateValue)) {\n                        templateMessage = mgaAdmin__('Indiquez une URL valide (http, https, mailto, tel ou sms).', 'lightbox-jlg');\n                    }\n\n                    applyFieldError(templateInput, templateMessageEl, templateMessage);\n                });\n            };\n\n            const updateItemNames = () => {\n                const items = Array.from(list.querySelectorAll('[data-share-repeater-item]'));\n\n                items.forEach((item, index) => {\n                    const baseName = `mga_settings[share_channels][${index}]`;\n                    const fields = item.querySelectorAll('[data-share-field]');\n\n                    fields.forEach((field) => {\n                        const fieldKey = field.getAttribute('data-share-field');\n\n                        if (!fieldKey) {\n                            return;\n                        }\n\n                        let effectiveKey = fieldKey;\n\n                        if (fieldKey === 'enabled-hidden') {\n                            effectiveKey = 'enabled';\n                        }\n\n                        field.name = `${baseName}[${effectiveKey}]`;\n                    });\n\n                    applyUid(item);\n                    refreshItemTitle(item);\n                    updateIconPreview(item);\n                    updateSharePreview(item);\n                });\n\n                validateShareItems();\n\n                scheduleSummaryRefresh();\n            };\n\n            const focusItemField = (item) => {\n                if (!item) {\n                    return;\n                }\n\n                const target = item.querySelector('[data-share-field=\"label\"]') || item;\n                safeFocus(target);\n            };\n\n            list.addEventListener('input', (event) => {\n                const target = event.target;\n\n                if (!target) {\n                    return;\n                }\n\n                const item = target.closest('[data-share-repeater-item]');\n\n                if (!item) {\n                    return;\n                }\n\n                if (target.matches('[data-share-field=\"label\"], [data-share-field=\"key\"]')) {\n                    refreshItemTitle(item);\n                }\n\n                if (target.matches('[data-share-field=\"icon\"]')) {\n                    updateIconPreview(item);\n                }\n\n                updateSharePreview(item);\n                validateShareItems();\n            });\n\n            list.addEventListener('change', (event) => {\n                const target = event.target;\n\n                if (!target || !target.matches('[data-share-field=\"icon\"]')) {\n                    return;\n                }\n\n                const item = target.closest('[data-share-repeater-item]');\n\n                if (item) {\n                    updateIconPreview(item);\n                    updateSharePreview(item);\n                    validateShareItems();\n                }\n            });\n\n            list.addEventListener('click', (event) => {\n                const button = event.target.closest('[data-share-action]');\n\n                if (!button) {\n                    return;\n                }\n\n                event.preventDefault();\n\n                const action = button.getAttribute('data-share-action');\n                const item = button.closest('[data-share-repeater-item]');\n\n                if (!item) {\n                    return;\n                }\n\n                if (action === 'remove') {\n                    const nextFocusItem = item.nextElementSibling || item.previousElementSibling;\n\n                    if (item.parentNode === list) {\n                        list.removeChild(item);\n                    }\n\n                    updateItemNames();\n                    scheduleSummaryRefresh();\n\n                    if (nextFocusItem) {\n                        focusItemField(nextFocusItem);\n                    }\n\n                    return;\n                }\n\n                if (action === 'move-up') {\n                    const previous = item.previousElementSibling;\n\n                    if (previous) {\n                        list.insertBefore(item, previous);\n                        updateItemNames();\n                        focusItemField(item);\n                        scheduleSummaryRefresh();\n                    }\n\n                    return;\n                }\n\n                if (action === 'move-down') {\n                    const next = item.nextElementSibling;\n\n                    if (next) {\n                        list.insertBefore(next, item);\n                        updateItemNames();\n                        focusItemField(item);\n                        scheduleSummaryRefresh();\n                    }\n                }\n            });\n\n            if (addButton) {\n                addButton.addEventListener('click', (event) => {\n                    event.preventDefault();\n\n                    const fragment = doc.importNode(template.content, true);\n                    const newItem = fragment.querySelector('[data-share-repeater-item]');\n\n                    if (!newItem) {\n                        return;\n                    }\n\n                    list.appendChild(newItem);\n                    updateItemNames();\n                    focusItemField(newItem);\n                    scheduleSummaryRefresh();\n                });\n            }\n\n            updateItemNames();\n            scheduleSummaryRefresh();\n        }\n    });\n})(typeof window !== 'undefined' ? window : globalThis);\n"],
  "mappings": "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",
  "names": ["TOKEN_REGEX", "createFallbackSprintf", "createSprintf", "createTranslate", "resolveI18n", "init_sprintf", "__esmMin", "format", "args", "autoIndex", "match", "position", "argIndex", "type", "numericIndex", "value", "coerced", "i18n", "text", "globalObject", "SHARE_ICON_LIBRARY", "sanitizeIconKey", "getDefinition", "createSvgElement", "createIconSvg", "createIconPreview", "init_icons", "__esmMin", "value", "iconKey", "sanitizedKey", "doc", "tag", "attributes", "element", "attribute", "definition", "svg", "pathDefinition", "path", "wrapperTag", "wrapperClass", "wrapper", "focusSupportsOptionsCache", "detectFocusOptionsSupport", "safeFocus", "exposeOnWindow", "init_focus", "__esmMin", "doc", "testElement", "root", "error", "element", "options", "init_shared", "__esmMin", "init_sprintf", "init_icons", "init_focus", "require_admin", "__commonJSMin", "exports", "module", "init_shared", "global", "exposeOnWindow", "mgaAdminI18n", "resolveI18n", "mgaAdmin__", "createTranslate", "mgaAdminSprintf", "createSprintf", "detectFocusOptionsSupport", "safeFocus", "doc", "createShareIconPreview", "iconKey", "preview", "createIconPreview", "sanitizeIconKey", "SHARE_TEMPLATE_SAMPLE", "SHARE_TEMPLATE_PLACEHOLDERS", "SHARE_TEMPLATE_SCHEMES", "isValidHexColor", "value", "form", "adminRoot", "scheduleSummaryRefresh", "THEME_STORAGE_KEY", "THEME_OPTIONS", "themeSelect", "systemThemeQuery", "readStoredTheme", "error", "writeStoredTheme", "normalizeThemePreference", "trimmed", "currentThemePreference", "resolveAppliedTheme", "preference", "applyThemePreference", "options", "normalizedPreference", "resolvedTheme", "event", "nextPreference", "handleSystemThemeChange", "wizardApi", "targetForm", "wizard", "stepPanels", "indicators", "prevButton", "nextButton", "submitButton", "statusElement", "summaryIndex", "currentIndex", "panel", "getMessages", "setStatusMessage", "state", "message", "statusMessage", "updateControls", "focusPanel", "focusTarget", "focusOptions", "deactivatePanel", "activatePanel", "updateIndicators", "indicator", "index", "updateSummaryContainers", "timeoutId", "presetTarget", "timingTarget", "toolbarTarget", "shareTarget", "renderToolbarSummary", "active", "toggle", "input", "renderPresetSummary", "presetSelect", "fallback", "option", "label", "preset", "renderTimingSummary", "delayInput", "effectSelect", "delayValue", "effectLabel", "selectedOption", "renderShareSummary", "activeLabels", "item", "enabledField", "labelField", "keyField", "labelValue", "keyValue", "update", "goToStep", "targetIndex", "normalizedIndex", "currentPanel", "nextPanel", "handleNext", "handlePrev", "attachIndicatorNavigation", "handleFormInput", "config", "ajaxUrl", "nonce", "setStatus", "explicitMessage", "setSavingState", "isSaving", "formData", "response", "payload", "successMessage", "fallbackMessage", "layout", "sections", "navList", "navLinks", "linkBySection", "navItemBySection", "viewToggle", "viewSelect", "VIEW_STORAGE_KEY", "currentViewMode", "syncViewSelect", "persistViewMode", "updateLayoutViewMode", "getSectionVisibility", "section", "searchInput", "emptyState", "highlightTimeouts", "isSearchActive", "updateEmptyState", "visibleCount", "searchActive", "setActiveLink", "link", "candidate", "clearHighlights", "highlightSection", "filterSections", "rawQuery", "query", "navItem", "firstMatch", "applyViewMode", "nextMode", "normalized", "currentQuery", "href", "target", "lastVisibleSection", "observer", "entries", "entry", "handleScroll", "bestSection", "bestOffset", "scrollY", "absoluteTop", "delta", "bindRangeToOutput", "sliderId", "outputId", "displayFormatter", "ariaFormatter", "slider", "output", "updateOutput", "displayValue", "ariaValue", "accentColorInput", "accentColorPreview", "defaultColorAttr", "fallbackColor", "applyPreviewColor", "rawColor", "color", "maybeJQuery", "ui", "colorValue", "defaultColor", "previewContainer", "previewMock", "thumbsContainer", "toolbarActions", "effectNameMap", "setAccent", "setOverlay", "numeric", "clamped", "setBackgroundStyle", "style", "toggleAction", "name", "enabled", "action", "setThumbScale", "updateEffectLabel", "speedInput", "effectValue", "speedValue", "effectLabelText", "bindPreviewControl", "id", "handler", "events", "element", "invoke", "eventName", "checked", "stylePresetExport", "stylePresets", "applyPresetButton", "resetPresetButton", "presetDescription", "isApplyingPreset", "maybeDispatchEvent", "eventType", "fallbackEvent", "fallbackError", "setNumericInputValue", "setRangeInputValue", "setSelectValue", "select", "setCheckboxValue", "checkbox", "setAccentColorValue", "targetColor", "picker", "applyPresetSettings", "settings", "updatePresetDescription", "key", "customDescription", "markPresetAsCustom", "registerPresetWatcher", "eventNames", "defaults", "shareRepeater", "initShareRepeater", "selectorsWrapper", "selectorsList", "selectorsTextarea", "template", "placeholder", "isSyncingSelectors", "addRow", "queryRows", "queryInputs", "hasEmptyRow", "updateRemoveState", "rows", "disable", "row", "removeButton", "getRowValues", "syncTextareaFromRows", "values", "bindRow", "lastRow", "lastInput", "createRow", "renderRows", "emptyRow", "syncRowsFromTextarea", "selector", "addButton", "container", "list", "uidSeed", "generateUid", "ensureItemUid", "applyUid", "uid", "suffix", "refreshItemTitle", "title", "labelInput", "keyInput", "updateIconPreview", "iconSvg", "summaryIcon", "summarySvg", "getShareField", "getShareFieldValue", "field", "buildSharePreviewUrl", "previewValue", "token", "replacement", "hasRequiredPlaceholder", "isTemplateSchemeValid", "scheme", "applyFieldError", "messageElement", "hasMessage", "updateSharePreview", "labelElement", "urlElement", "fallbackLabel", "templateValue", "previewUrl", "validateShareItems", "items", "keyOccurrences", "accumulator", "templateInput", "keyMessageEl", "templateMessageEl", "rawKeyValue", "normalizedKey", "keyMessage", "templateMessage", "updateItemNames", "baseName", "fieldKey", "effectiveKey", "focusItemField", "button", "nextFocusItem", "previous", "next", "newItem"]
}
