{
  "version": 3,
  "sources": ["../src/shared/sprintf.js", "../src/shared/icons.js", "../src/shared/focus.js", "../src/shared/swiper.js", "../src/shared/index.js", "../src/admin.js"],
  "sourcesContent": ["const TOKEN_REGEX = /%(\\d+\\$)?[sd]/g;\n\nconst createFallbackSprintf = () => (format, ...args) => {\n    let autoIndex = 0;\n\n    return String(format).replace(TOKEN_REGEX, (match, position) => {\n        let argIndex;\n        const type = match.charAt(match.length - 1);\n\n        if (position) {\n            const numericIndex = parseInt(position.slice(0, -1), 10);\n\n            if (Number.isNaN(numericIndex) || numericIndex <= 0) {\n                return '';\n            }\n\n            argIndex = numericIndex - 1;\n        } else {\n            argIndex = autoIndex;\n            autoIndex += 1;\n        }\n\n        const value = argIndex >= 0 && argIndex < args.length ? args[argIndex] : undefined;\n\n        if (type === 'd') {\n            const coerced = parseInt(value, 10);\n            return Number.isNaN(coerced) ? '' : String(coerced);\n        }\n\n        if (typeof value === 'undefined') {\n            return '';\n        }\n\n        return String(value);\n    });\n};\n\nexport const createSprintf = (i18n) => {\n    if (i18n && typeof i18n.sprintf === 'function') {\n        return i18n.sprintf;\n    }\n\n    return createFallbackSprintf();\n};\n\nexport const createTranslate = (i18n) => {\n    if (i18n && typeof i18n.__ === 'function') {\n        return i18n.__;\n    }\n\n    return (text) => text;\n};\n\nexport const resolveI18n = (globalObject) => {\n    if (!globalObject || typeof globalObject !== 'object') {\n        return null;\n    }\n\n    if (globalObject.wp && globalObject.wp.i18n) {\n        return globalObject.wp.i18n;\n    }\n\n    return null;\n};\n\nexport const getSharedI18n = () => resolveI18n(typeof window !== 'undefined' ? window : globalThis);\n\nexport const getSharedSprintf = () => createSprintf(getSharedI18n());\n\nexport const getSharedTranslate = () => createTranslate(getSharedI18n());\n\nexport default {\n    createSprintf,\n    createTranslate,\n    getSharedI18n,\n    getSharedSprintf,\n    getSharedTranslate,\n};\n", "const SHARE_ICON_LIBRARY = {\n    facebook: {\n        viewBox: '0 0 24 24',\n        paths: [\n            { d: 'M22 12c0-5.52-4.48-10-10-10S2 6.48 2 12c0 4.99 3.66 9.12 8.44 9.88v-6.99H8.08V12h2.36V9.88c0-2.33 1.38-3.62 3.5-3.62 0.72 0 1.48 0.13 1.48 0.13v1.63h-0.83c-0.82 0-1.08 0.51-1.08 1.04V12h1.84l-0.29 1.89h-1.55v6.99C18.34 21.12 22 16.99 22 12z' },\n        ],\n    },\n    twitter: {\n        viewBox: '0 0 24 24',\n        paths: [\n            { d: 'M22.46 6c-0.77 0.35-1.6 0.59-2.46 0.69a4.29 4.29 0 0 0 1.88-2.37 8.59 8.59 0 0 1-2.72 1.04 4.28 4.28 0 0 0-7.3 3.9 12.13 12.13 0 0 1-8.82-4.47 4.28 4.28 0 0 0 1.33 5.72 4.25 4.25 0 0 1-1.94-0.54v0.05a4.28 4.28 0 0 0 3.43 4.2 4.3 4.3 0 0 1-1.93 0.07 4.28 4.28 0 0 0 4 2.97 8.58 8.58 0 0 1-5.3 1.83 12.1 12.1 0 0 0 6.56 1.92c7.88 0 12.2-6.53 12.2-12.2 0-0.19-0.01-0.39-0.01-0.58A8.7 8.7 0 0 0 22.46 6z' },\n        ],\n    },\n    linkedin: {\n        viewBox: '0 0 24 24',\n        paths: [\n            { d: 'M20.45 3H3.55A1.55 1.55 0 0 0 2 4.55v14.9C2 20.3 2.7 21 3.55 21h16.9c0.85 0 1.55-0.7 1.55-1.55V4.55C22 3.7 21.3 3 20.45 3zM8.34 18H5.67V9.67h2.67V18zM7 8.5a1.55 1.55 0 1 1 0-3.1 1.55 1.55 0 0 1 0 3.1zM18.33 18h-2.67v-4.1c0-0.98-0.02-2.24-1.36-2.24-1.36 0-1.56 1.06-1.56 2.16V18h-2.67V9.67h2.56v1.14h0.04c0.36-0.68 1.24-1.4 2.56-1.4 2.74 0 3.25 1.8 3.25 4.13V18z' },\n        ],\n    },\n    pinterest: {\n        viewBox: '0 0 24 24',\n        paths: [\n            { d: 'M12 2C6.48 2 2 6.31 2 11.42c0 3.89 2.68 7.23 6.44 8.41-0.09-0.71-0.17-1.8 0.03-2.58 0.18-0.77 1.15-4.9 1.15-4.9s-0.29-0.58-0.29-1.45c0-1.36 0.79-2.37 1.78-2.37 0.84 0 1.24 0.63 1.24 1.38 0 0.84-0.53 2.09-0.8 3.25-0.23 1 0.5 1.81 1.48 1.81 1.78 0 3.14-1.87 3.14-4.57 0-2.39-1.72-4.07-4.18-4.07-2.85 0-4.52 2.14-4.52 4.35 0 0.86 0.33 1.79 0.74 2.29 0.08 0.1 0.09 0.19 0.07 0.29-0.07 0.31-0.23 1-0.26 1.13-0.04 0.18-0.14 0.22-0.32 0.13-1.2-0.56-1.95-2.29-1.95-3.68 0-3 2.18-5.76 6.29-5.76 3.3 0 5.87 2.35 5.87 5.5 0 3.28-2.06 5.93-4.92 5.93-0.96 0-1.86-0.5-2.17-1.08l-0.59 2.24c-0.21 0.83-0.78 1.87-1.16 2.5 0.87 0.27 1.78 0.42 2.72 0.42 5.52 0 10-4.31 10-9.42C22 6.31 17.52 2 12 2z' },\n        ],\n    },\n    whatsapp: {\n        viewBox: '0 0 24 24',\n        paths: [\n            { d: 'M20.52 3.48A10.5 10.5 0 0 0 2.47 13.3l-1.45 5.28 5.4-1.41A10.5 10.5 0 1 0 20.52 3.48zm-8.5 17.54a8.75 8.75 0 0 1-4.46-1.22l-0.32-0.19-3.21 0.84 0.86-3.13-0.2-0.32a8.75 8.75 0 1 1 7.33 3.99zm4.78-6.53c-0.26-0.13-1.53-0.76-1.77-0.84-0.24-0.09-0.41-0.13-0.58 0.13-0.17 0.26-0.66 0.84-0.8 1.02-0.15 0.17-0.29 0.2-0.55 0.07-0.26-0.13-1.09-0.4-2.07-1.3-0.76-0.68-1.27-1.52-1.42-1.78-0.15-0.26-0.02-0.4 0.11-0.53 0.11-0.11 0.26-0.29 0.39-0.43 0.13-0.15 0.17-0.26 0.26-0.43 0.09-0.17 0.04-0.32-0.02-0.45-0.07-0.13-0.58-1.39-0.8-1.91-0.21-0.5-0.43-0.43-0.58-0.43-0.15 0-0.32-0.02-0.49-0.02-0.17 0-0.43 0.06-0.66 0.32-0.24 0.26-0.89 0.87-0.89 2.13s0.91 2.47 1.03 2.64c0.13 0.17 1.79 2.73 4.34 3.83 0.61 0.26 1.08 0.41 1.45 0.53 0.61 0.19 1.16 0.16 1.6 0.1 0.49-0.07 1.53-0.62 1.75-1.22 0.21-0.6 0.21-1.11 0.15-1.22-0.06-0.1-0.24-0.16-0.5-0.29z' },\n        ],\n    },\n    telegram: {\n        viewBox: '0 0 24 24',\n        paths: [\n            { d: 'M21.5 2.5l-19 7.5c-1.3 0.52-1.29 2.35 0.02 2.85l4.8 1.9 1.9 4.8c0.5 1.31 2.34 1.32 2.85 0.02l7.5-19c0.42-1.06-0.64-2.12-1.67-1.67zM10 14l-1 4-1.5-3.8 8.3-6.2-5.8 6z' },\n        ],\n    },\n    email: {\n        viewBox: '0 0 24 24',\n        paths: [\n            { d: 'M20 4H4a2 2 0 0 0-2 2v12a2 2 0 0 0 2 2h16a2 2 0 0 0 2-2V6a2 2 0 0 0-2-2zm0 2-8 5-8-5h16zm0 12H4V8l8 5 8-5v10z' },\n        ],\n    },\n    link: {\n        viewBox: '0 0 24 24',\n        paths: [\n            { d: 'M10.59 13.41a1 1 0 0 1 0-1.41l2-2a1 1 0 1 1 1.41 1.41l-2 2a1 1 0 0 1-1.41 0zm-2.83 2.83a3 3 0 0 1 0-4.24l2-2a3 3 0 0 1 4.24 0 1 1 0 0 1-1.41 1.41 1 1 0 0 0-1.41 0l-2 2a1 1 0 0 0 0 1.41 1 1 0 0 0 1.41 0l1-1a1 1 0 1 1 1.41 1.41l-1 1a3 3 0 0 1-4.24 0zm8.48-8.48a3 3 0 0 0-4.24 0l-1 1a1 1 0 0 1-1.41-1.41l1-1a5 5 0 1 1 7.07 7.07l-2 2a5 5 0 0 1-7.07 0 1 1 0 0 1 1.41-1.41 3 3 0 0 0 4.24 0l2-2a3 3 0 0 0 0-4.24z' },\n        ],\n    },\n    generic: {\n        viewBox: '0 0 24 24',\n        paths: [\n            { d: 'M12 2a10 10 0 1 0 10 10A10 10 0 0 0 12 2z' },\n            { d: 'M13 17h-2v-2h2zm0-4h-2V7h2z' },\n        ],\n    },\n    copy: {\n        viewBox: '0 0 24 24',\n        paths: [\n            { d: 'M16 1H4a2 2 0 0 0-2 2v12h2V3h12V1zm3 4H8a2 2 0 0 0-2 2v14a2 2 0 0 0 2 2h11a2 2 0 0 0 2-2V7a2 2 0 0 0-2-2zm0 16H8V7h11v14z' },\n        ],\n    },\n    download: {\n        viewBox: '0 0 24 24',\n        paths: [\n            { d: 'M5 20h14v-2H5v2zm7-16v9l3.5-3.5 1.42 1.42L12 17l-4.92-4.92L8.5 10.66 12 14.17V4z' },\n        ],\n    },\n    native: {\n        viewBox: '0 0 24 24',\n        paths: [\n            { d: 'M18 16.08c-0.76 0-1.44 0.3-1.96 0.77L8.91 12.7c0.05-0.23 0.09-0.46 0.09-0.7s-0.04-0.47-0.09-0.7l7.02-4.11A2.99 2.99 0 0 0 18 7.91c1.66 0 3-1.34 3-3s-1.34-3-3-3-3 1.34-3 3c0 0.24 0.03 0.47 0.09 0.7L8.07 9.7A2.99 2.99 0 0 0 6 9c-1.66 0-3 1.34-3 3s1.34 3 3 3c0.79 0 1.5-0.31 2.03-0.82l7.05 4.12c-0.06 0.23-0.08 0.46-0.08 0.7 0 1.65 1.34 2.99 3 2.99s3-1.34 3-2.99-1.34-3-3-3z' },\n        ],\n    },\n};\n\nexport const sanitizeIconKey = (value) => {\n    if (typeof value !== 'string') {\n        return '';\n    }\n\n    return value.trim().toLowerCase().replace(/[^a-z0-9_-]/g, '');\n};\n\nconst getDefinition = (iconKey) => {\n    const sanitizedKey = sanitizeIconKey(iconKey);\n\n    if (sanitizedKey && SHARE_ICON_LIBRARY[sanitizedKey]) {\n        return SHARE_ICON_LIBRARY[sanitizedKey];\n    }\n\n    return SHARE_ICON_LIBRARY.generic;\n};\n\nexport const createSvgElement = (doc, tag, attributes = {}) => {\n    if (!doc || typeof doc.createElementNS !== 'function') {\n        return null;\n    }\n\n    const element = doc.createElementNS('http://www.w3.org/2000/svg', tag);\n\n    Object.keys(attributes).forEach((attribute) => {\n        element.setAttribute(attribute, attributes[attribute]);\n    });\n\n    return element;\n};\n\nexport const createIconSvg = (doc, iconKey) => {\n    const definition = getDefinition(iconKey);\n    const svg = createSvgElement(doc, 'svg', {\n        viewBox: definition.viewBox,\n        fill: 'currentColor',\n        'aria-hidden': 'true',\n        focusable: 'false',\n    });\n\n    if (!svg) {\n        return null;\n    }\n\n    if (Array.isArray(definition.paths)) {\n        definition.paths.forEach((pathDefinition) => {\n            const path = createSvgElement(doc, 'path', pathDefinition);\n\n            if (path) {\n                svg.appendChild(path);\n            }\n        });\n    }\n\n    return svg;\n};\n\nexport const createIconPreview = (doc, iconKey, { wrapperTag = 'span', wrapperClass = '' } = {}) => {\n    if (!doc || typeof doc.createElement !== 'function') {\n        return null;\n    }\n\n    const wrapper = doc.createElement(wrapperTag);\n\n    if (wrapperClass) {\n        wrapper.className = wrapperClass;\n    }\n\n    const svg = createIconSvg(doc, iconKey);\n\n    if (!svg) {\n        return null;\n    }\n\n    wrapper.appendChild(svg);\n\n    return wrapper;\n};\n\nexport const getIconLibrary = () => ({ ...SHARE_ICON_LIBRARY });\n\nexport default {\n    createIconPreview,\n    createIconSvg,\n    getIconLibrary,\n    sanitizeIconKey,\n};\n", "let focusSupportsOptionsCache = null;\n\nexport const detectFocusOptionsSupport = () => {\n    if (focusSupportsOptionsCache !== null) {\n        return focusSupportsOptionsCache;\n    }\n\n    focusSupportsOptionsCache = false;\n\n    const doc = typeof window !== 'undefined' ? window.document : null;\n\n    if (\n        !doc ||\n        typeof doc.createElement !== 'function' ||\n        typeof window.HTMLElement === 'undefined' ||\n        !window.HTMLElement.prototype ||\n        typeof window.HTMLElement.prototype.focus !== 'function'\n    ) {\n        return focusSupportsOptionsCache;\n    }\n\n    const testElement = doc.createElement('button');\n    const root = doc.body || doc.documentElement;\n\n    try {\n        testElement.type = 'button';\n\n        if (root && typeof root.appendChild === 'function') {\n            root.appendChild(testElement);\n        }\n\n        window.HTMLElement.prototype.focus.call(testElement, {\n            get preventScroll() {\n                focusSupportsOptionsCache = true;\n                return true;\n            },\n        });\n    } catch (error) {\n        focusSupportsOptionsCache = false;\n    } finally {\n        if (testElement.parentNode && typeof testElement.parentNode.removeChild === 'function') {\n            testElement.parentNode.removeChild(testElement);\n        }\n    }\n\n    return focusSupportsOptionsCache;\n};\n\nexport const safeFocus = (element, options = { preventScroll: true }) => {\n    if (!element || typeof element.focus !== 'function') {\n        return;\n    }\n\n    const canUseOptions = options && detectFocusOptionsSupport();\n\n    if (canUseOptions) {\n        try {\n            element.focus(options);\n            return;\n        } catch (error) {\n            // Ignore and fall back to focusing without options.\n        }\n    }\n\n    element.focus();\n};\n\nexport const exposeOnWindow = () => {\n    if (typeof window === 'undefined') {\n        return;\n    }\n\n    if (!window.mgaFocusUtils || typeof window.mgaFocusUtils !== 'object') {\n        window.mgaFocusUtils = {};\n    }\n\n    window.mgaFocusUtils.detectFocusOptionsSupport = detectFocusOptionsSupport;\n    window.mgaFocusUtils.safeFocus = safeFocus;\n};\n\nexport default {\n    detectFocusOptionsSupport,\n    safeFocus,\n    exposeOnWindow,\n};\n", "const DEFAULT_TIMEOUT = 12000;\n\nconst getTimestamp = (global) => {\n    if (global && global.performance && typeof global.performance.now === 'function') {\n        return global.performance.now();\n    }\n\n    return Date.now();\n};\n\nconst getDocument = (global) => (global && global.document) || null;\n\nconst getMetricsStore = (global) => {\n    if (!global) {\n        return null;\n    }\n\n    if (!global.mgaSwiperMetrics || typeof global.mgaSwiperMetrics !== 'object') {\n        global.mgaSwiperMetrics = { events: [] };\n    }\n\n    if (!Array.isArray(global.mgaSwiperMetrics.events)) {\n        global.mgaSwiperMetrics.events = [];\n    }\n\n    return global.mgaSwiperMetrics;\n};\n\nconst recordMetric = (global, namespace, event, detail) => {\n    const store = getMetricsStore(global);\n\n    if (!store) {\n        return;\n    }\n\n    store.events.push({\n        namespace: namespace || 'default',\n        event,\n        detail: detail || {},\n        timestamp: getTimestamp(global),\n    });\n\n    if (typeof global.dispatchEvent === 'function') {\n        try {\n            const customEvent = new global.CustomEvent('mga:swiper-metric', {\n                detail: {\n                    namespace: namespace || 'default',\n                    event,\n                    payload: detail || {},\n                },\n            });\n            global.dispatchEvent(customEvent);\n        } catch (error) {\n            // Ignore CustomEvent support issues.\n        }\n    }\n};\n\nconst normalizeAttempts = (config) => {\n    if (!config || typeof config !== 'object') {\n        return [];\n    }\n\n    const rawAttempts = Array.isArray(config.attempts) ? config.attempts : [];\n\n    return rawAttempts\n        .map((attempt) => {\n            if (!attempt || typeof attempt !== 'object') {\n                return null;\n            }\n\n            if (attempt.enabled === false) {\n                return null;\n            }\n\n            const key = typeof attempt.key === 'string' && attempt.key ? attempt.key : 'fallback';\n            const js = attempt.js && typeof attempt.js === 'object' ? attempt.js : {};\n            const css = attempt.css && typeof attempt.css === 'object' ? attempt.css : null;\n            const inject = attempt.inject !== false;\n\n            const jsSrc = typeof js.src === 'string' && js.src ? js.src : '';\n\n            if (!jsSrc) {\n                return null;\n            }\n\n            return {\n                key,\n                label: typeof attempt.label === 'string' && attempt.label ? attempt.label : key,\n                js: {\n                    src: jsSrc,\n                    integrity: typeof js.integrity === 'string' && js.integrity ? js.integrity : null,\n                    crossOrigin: typeof js.crossOrigin === 'string' && js.crossOrigin ? js.crossOrigin : null,\n                    referrerPolicy: typeof js.referrerPolicy === 'string' && js.referrerPolicy ? js.referrerPolicy : null,\n                },\n                css: css && typeof css.href === 'string' && css.href\n                    ? {\n                        href: css.href,\n                        integrity: typeof css.integrity === 'string' && css.integrity ? css.integrity : null,\n                        crossOrigin: typeof css.crossOrigin === 'string' && css.crossOrigin ? css.crossOrigin : null,\n                        referrerPolicy: typeof css.referrerPolicy === 'string' && css.referrerPolicy ? css.referrerPolicy : null,\n                    }\n                    : null,\n                timeout: typeof attempt.timeout === 'number' && attempt.timeout > 0\n                    ? attempt.timeout\n                    : DEFAULT_TIMEOUT,\n                inject,\n            };\n        })\n        .filter(Boolean);\n};\n\nconst loadStylesheet = (global, attempt, namespace) => {\n    if (!attempt || !attempt.css) {\n        return Promise.resolve();\n    }\n\n    const doc = getDocument(global);\n\n    if (!doc) {\n        return Promise.resolve();\n    }\n\n    const existing = Array.from(doc.querySelectorAll('link[rel=\"stylesheet\"]'))\n        .find((link) => link.href === attempt.css.href);\n\n    if (existing) {\n        return Promise.resolve(existing);\n    }\n\n    return new Promise((resolve, reject) => {\n        const link = doc.createElement('link');\n        link.rel = 'stylesheet';\n        link.href = attempt.css.href;\n        link.dataset.mgaSwiperSource = attempt.key;\n\n        if (attempt.css.integrity) {\n            link.integrity = attempt.css.integrity;\n        }\n\n        if (attempt.css.crossOrigin) {\n            link.crossOrigin = attempt.css.crossOrigin;\n        } else if (attempt.css.integrity) {\n            link.crossOrigin = 'anonymous';\n        }\n\n        if (attempt.css.referrerPolicy) {\n            link.referrerPolicy = attempt.css.referrerPolicy;\n        }\n\n        link.onload = () => {\n            recordMetric(global, namespace, 'css_load_success', { source: attempt.key });\n            resolve(link);\n        };\n\n        link.onerror = () => {\n            recordMetric(global, namespace, 'css_load_error', { source: attempt.key });\n            reject(new Error('Stylesheet load error'));\n        };\n\n        doc.head.appendChild(link);\n        recordMetric(global, namespace, 'css_load_start', { source: attempt.key, href: attempt.css.href });\n    });\n};\n\nconst loadScript = (global, attempt, namespace) => {\n    if (!attempt || !attempt.js || !attempt.js.src) {\n        return Promise.reject(new Error('Invalid attempt configuration'));\n    }\n\n    const doc = getDocument(global);\n\n    if (!doc) {\n        return Promise.reject(new Error('Document unavailable'));\n    }\n\n    const existing = Array.from(doc.querySelectorAll('script'))\n        .find((script) => script.src === attempt.js.src && !script.hasAttribute('data-mga-swiper-failed'));\n\n    if (existing) {\n        return new Promise((resolve, reject) => {\n            if (typeof global.Swiper === 'function') {\n                existing.setAttribute('data-mga-swiper-loaded', 'true');\n                recordMetric(global, namespace, 'js_already_available', { source: attempt.key });\n                resolve(existing);\n                return;\n            }\n\n            if (typeof existing.hasAttribute === 'function' && existing.hasAttribute('data-mga-swiper-loaded')) {\n                resolve(existing);\n                return;\n            }\n\n            existing.addEventListener('load', () => {\n                existing.setAttribute('data-mga-swiper-loaded', 'true');\n                resolve(existing);\n            });\n            existing.addEventListener('error', () => {\n                existing.setAttribute('data-mga-swiper-failed', 'true');\n                reject(new Error('Existing script failed'));\n            });\n\n            recordMetric(global, namespace, 'js_existing_observed', { source: attempt.key });\n        });\n    }\n\n    return new Promise((resolve, reject) => {\n        const script = doc.createElement('script');\n        script.src = attempt.js.src;\n        script.async = false;\n        script.dataset.mgaSwiperSource = attempt.key;\n\n        if (attempt.js.integrity) {\n            script.integrity = attempt.js.integrity;\n        }\n\n        if (attempt.js.crossOrigin) {\n            script.crossOrigin = attempt.js.crossOrigin;\n        } else if (attempt.js.integrity) {\n            script.crossOrigin = 'anonymous';\n        }\n\n        if (attempt.js.referrerPolicy) {\n            script.referrerPolicy = attempt.js.referrerPolicy;\n        }\n\n        let timeoutId = null;\n\n        const cleanup = () => {\n            if (timeoutId) {\n                global.clearTimeout(timeoutId);\n                timeoutId = null;\n            }\n        };\n\n        script.onload = () => {\n            cleanup();\n            script.setAttribute('data-mga-swiper-loaded', 'true');\n            recordMetric(global, namespace, 'js_load_success', { source: attempt.key });\n            resolve(script);\n        };\n\n        script.onerror = () => {\n            cleanup();\n            script.setAttribute('data-mga-swiper-failed', 'true');\n            recordMetric(global, namespace, 'js_load_error', { source: attempt.key });\n            reject(new Error('Script load error'));\n        };\n\n        timeoutId = global.setTimeout(() => {\n            cleanup();\n            script.setAttribute('data-mga-swiper-failed', 'true');\n            recordMetric(global, namespace, 'js_load_timeout', { source: attempt.key, timeout: attempt.timeout });\n            reject(new Error('Script load timeout'));\n        }, attempt.timeout || DEFAULT_TIMEOUT);\n\n        doc.head.appendChild(script);\n        recordMetric(global, namespace, 'js_load_start', { source: attempt.key, src: attempt.js.src });\n    });\n};\n\nconst getLoaderState = (global) => {\n    if (!global) {\n        return { promise: null };\n    }\n\n    if (!global.mgaSwiperLoaderState || typeof global.mgaSwiperLoaderState !== 'object') {\n        global.mgaSwiperLoaderState = { promise: null };\n    }\n\n    return global.mgaSwiperLoaderState;\n};\n\nconst attemptLoad = (global, attempt, namespace) => {\n    if (!attempt || !attempt.inject) {\n        return Promise.resolve();\n    }\n\n    if (typeof global.Swiper === 'function') {\n        return Promise.resolve(global.Swiper);\n    }\n\n    recordMetric(global, namespace, 'attempt_start', { source: attempt.key });\n\n    return loadStylesheet(global, attempt, namespace)\n        .catch(() => null)\n        .then(() => loadScript(global, attempt, namespace))\n        .then(() => {\n            if (typeof global.Swiper === 'function') {\n                recordMetric(global, namespace, 'attempt_success', { source: attempt.key });\n                return global.Swiper;\n            }\n\n            recordMetric(global, namespace, 'attempt_no_global', { source: attempt.key });\n            throw new Error('Swiper global missing after load');\n        })\n        .catch((error) => {\n            recordMetric(global, namespace, 'attempt_error', {\n                source: attempt.key,\n                message: error && error.message ? error.message : String(error),\n            });\n            throw error;\n        });\n};\n\nconst runAttemptsSequentially = (global, attempts, namespace) => {\n    return attempts.reduce((promise, attempt) => {\n        return promise.catch(() => attemptLoad(global, attempt, namespace));\n    }, Promise.reject(new Error('initial')));\n};\n\nconst getConfig = (global, explicitConfig) => {\n    if (explicitConfig && typeof explicitConfig === 'object') {\n        return explicitConfig;\n    }\n\n    if (global && global.mgaSwiperLoaderConfig && typeof global.mgaSwiperLoaderConfig === 'object') {\n        return global.mgaSwiperLoaderConfig;\n    }\n\n    if (global && global.mgaAdminConfig && typeof global.mgaAdminConfig === 'object' && global.mgaAdminConfig.swiper) {\n        return global.mgaAdminConfig.swiper;\n    }\n\n    return null;\n};\n\nexport const ensureSwiper = (global = window, options = {}) => {\n    const namespace = typeof options.namespace === 'string' && options.namespace\n        ? options.namespace\n        : 'default';\n\n    if (!global) {\n        return Promise.reject(new Error('Global scope unavailable'));\n    }\n\n    if (typeof global.Swiper === 'function') {\n        recordMetric(global, namespace, 'already_available', {});\n        return Promise.resolve(global.Swiper);\n    }\n\n    const config = getConfig(global, options.config);\n    const attempts = normalizeAttempts(config);\n\n    if (!attempts.length) {\n        recordMetric(global, namespace, 'no_attempts_configured', {});\n        return Promise.reject(new Error('No Swiper attempts configured'));\n    }\n\n    const state = getLoaderState(global);\n\n    if (state.promise) {\n        return state.promise;\n    }\n\n    recordMetric(global, namespace, 'bootstrap', {\n        version: config && config.version ? config.version : null,\n        attempts: attempts.map((attempt) => attempt.key),\n    });\n\n    state.promise = runAttemptsSequentially(global, attempts, namespace)\n        .catch(() => {\n            if (typeof global.Swiper === 'function') {\n                return global.Swiper;\n            }\n\n            recordMetric(global, namespace, 'fatal', {});\n            throw new Error('Swiper could not be loaded');\n        })\n        .then(() => {\n            if (typeof global.Swiper === 'function') {\n                recordMetric(global, namespace, 'ready', {});\n                return global.Swiper;\n            }\n\n            recordMetric(global, namespace, 'fatal', {});\n            throw new Error('Swiper global unavailable');\n        })\n        .finally(() => {\n            state.promise = null;\n        });\n\n    return state.promise;\n};\n\nexport const getSwiperLoaderConfig = (global = window) => getConfig(global, null);\n\n", "export * from './sprintf';\nexport * from './icons';\nexport * from './focus';\nexport * from './swiper';\n", "/* eslint-disable no-underscore-dangle */\nimport {\n    createIconPreview,\n    createSprintf,\n    createTranslate,\n    detectFocusOptionsSupport,\n    ensureSwiper,\n    exposeOnWindow,\n    resolveI18n,\n    safeFocus,\n    sanitizeIconKey,\n} from './shared';\n\n(function(global) {\n    exposeOnWindow();\n\n    const mgaAdminI18n = resolveI18n(global);\n    const mgaAdmin__ = createTranslate(mgaAdminI18n);\n    const mgaAdminSprintf = createSprintf(mgaAdminI18n);\n\n    if (typeof module !== 'undefined' && module.exports) {\n        module.exports = {\n            detectFocusOptionsSupport,\n            safeFocus,\n        };\n    }\n\n    const doc = global.document;\n\n    const createShareIconPreview = (iconKey) => {\n        const preview = createIconPreview(doc, sanitizeIconKey(iconKey));\n\n        if (!preview) {\n            return null;\n        }\n\n        const svg = preview.querySelector('svg');\n\n        return svg || preview;\n    };\n\n    const SHARE_TEMPLATE_SAMPLE = {\n        url: 'https://exemple.com/galerie/photo-01',\n        text: 'Une photo remarquable',\n        title: 'Collection studio',\n    };\n\n    const SHARE_TEMPLATE_PLACEHOLDERS = {\n        '%url%': SHARE_TEMPLATE_SAMPLE.url,\n        '%text%': SHARE_TEMPLATE_SAMPLE.text,\n        '%title%': SHARE_TEMPLATE_SAMPLE.title,\n    };\n\n    const SHARE_TEMPLATE_SCHEMES = ['http', 'https', 'mailto', 'tel', 'sms'];\n\n    const isValidHexColor = (value) => {\n        if (typeof value !== 'string') {\n            return false;\n        }\n\n        return /^#([0-9a-fA-F]{3}|[0-9a-fA-F]{6})$/.test(value.trim());\n    };\n\n    const normalizeHexColor = (value) => {\n        if (!isValidHexColor(value)) {\n            return '';\n        }\n\n        const trimmed = value.trim();\n\n        if (trimmed.length === 4) {\n            const r = trimmed[1];\n            const g = trimmed[2];\n            const b = trimmed[3];\n            return `#${r}${r}${g}${g}${b}${b}`.toLowerCase();\n        }\n\n        return trimmed.toLowerCase();\n    };\n\n    const hexToRgb = (hex) => {\n        const normalized = normalizeHexColor(hex);\n\n        if (!normalized) {\n            return null;\n        }\n\n        const value = normalized.slice(1);\n        const red = parseInt(value.slice(0, 2), 16);\n        const green = parseInt(value.slice(2, 4), 16);\n        const blue = parseInt(value.slice(4, 6), 16);\n\n        if ([red, green, blue].some((component) => Number.isNaN(component))) {\n            return null;\n        }\n\n        return { red, green, blue };\n    };\n\n    const relativeLuminance = (hex) => {\n        const rgb = hexToRgb(hex);\n\n        if (!rgb) {\n            return null;\n        }\n\n        const transform = (channel) => {\n            const value = channel / 255;\n            return value <= 0.03928 ? value / 12.92 : ((value + 0.055) / 1.055) ** 2.4;\n        };\n\n        const r = transform(rgb.red);\n        const g = transform(rgb.green);\n        const b = transform(rgb.blue);\n\n        return 0.2126 * r + 0.7152 * g + 0.0722 * b;\n    };\n\n    const computeContrastRatio = (foreground, background) => {\n        const fgLuminance = relativeLuminance(foreground);\n        const bgLuminance = relativeLuminance(background);\n\n        if (fgLuminance === null || bgLuminance === null) {\n            return null;\n        }\n\n        const [lighter, darker] = fgLuminance > bgLuminance\n            ? [fgLuminance, bgLuminance]\n            : [bgLuminance, fgLuminance];\n\n        const ratio = (lighter + 0.05) / (darker + 0.05);\n\n        return Number.isFinite(ratio) ? ratio : null;\n    };\n\n    const formatRatioText = (ratio) => {\n        if (!Number.isFinite(ratio)) {\n            return '\u2014';\n        }\n\n        return `${ratio.toFixed(2)}:1`;\n    };\n\n    const createContrastInspector = () => {\n        const inspector = doc.querySelector('[data-mga-contrast-inspector]');\n\n        if (!inspector) {\n            return null;\n        }\n\n        const rowNodes = {\n            light: {\n                swatch: inspector.querySelector('[data-mga-contrast-swatch=\"light\"]'),\n                value: inspector.querySelector('[data-mga-contrast-value=\"light\"]'),\n            },\n            dark: {\n                swatch: inspector.querySelector('[data-mga-contrast-swatch=\"dark\"]'),\n                value: inspector.querySelector('[data-mga-contrast-value=\"dark\"]'),\n            },\n        };\n\n        const messageNode = inspector.querySelector('[data-mga-contrast-message]');\n        const contexts = [\n            { key: 'light', label: mgaAdmin__('Fond clair', 'lightbox-jlg'), background: '#ffffff' },\n            { key: 'dark', label: mgaAdmin__('Fond sombre', 'lightbox-jlg'), background: '#111827' },\n        ];\n\n        let audit = { entries: [] };\n\n        const resolveAccentFallback = () => {\n            const accentInput = doc.getElementById('mga_accent_color');\n\n            if (!accentInput) {\n                return '#6366f1';\n            }\n\n            const defaultAttr = accentInput.getAttribute('data-default-color');\n            const normalizedDefault = normalizeHexColor(defaultAttr);\n\n            if (normalizedDefault) {\n                return normalizedDefault;\n            }\n\n            return '#6366f1';\n        };\n\n        const getSeverityFromRatio = (ratio) => {\n            if (!Number.isFinite(ratio)) {\n                return 'error';\n            }\n\n            if (ratio >= 4.5) {\n                return 'success';\n            }\n\n            if (ratio >= 3) {\n                return 'warning';\n            }\n\n            return 'error';\n        };\n\n        const formatSeverityMessage = (entry) => {\n            if (!entry) {\n                return '';\n            }\n\n            if (entry.severity === 'success') {\n                return mgaAdminSprintf(\n                    mgaAdmin__('Contraste valid\u00E9 sur %1$s (%2$s).', 'lightbox-jlg'),\n                    entry.label,\n                    entry.ratioText\n                );\n            }\n\n            if (entry.severity === 'warning') {\n                return mgaAdminSprintf(\n                    mgaAdmin__('Contraste limite sur %1$s (%2$s). Renforcez l\u00E9g\u00E8rement pour atteindre 4,5:1.', 'lightbox-jlg'),\n                    entry.label,\n                    entry.ratioText\n                );\n            }\n\n            return mgaAdminSprintf(\n                mgaAdmin__('Contraste insuffisant sur %1$s (%2$s). Ajustez la couleur ou le fond.', 'lightbox-jlg'),\n                entry.label,\n                entry.ratioText\n            );\n        };\n\n        const update = (rawAccent) => {\n            const normalizedAccent = normalizeHexColor(rawAccent);\n            const accentColor = normalizedAccent || resolveAccentFallback();\n\n            if (!accentColor) {\n                inspector.setAttribute('hidden', 'hidden');\n                inspector.removeAttribute('data-mga-severity');\n                audit = { entries: [] };\n\n                if (messageNode) {\n                    messageNode.textContent = '';\n                }\n\n                Object.values(rowNodes).forEach((row) => {\n                    if (row.value) {\n                        row.value.textContent = '\u2014';\n                    }\n                    if (row.swatch) {\n                        row.swatch.style.removeProperty('--mga-contrast-foreground');\n                        row.swatch.style.removeProperty('--mga-contrast-background');\n                    }\n                });\n\n            } else {\n                inspector.removeAttribute('hidden');\n\n                const entries = contexts.map((context) => {\n                    const ratio = computeContrastRatio(accentColor, context.background);\n                    const ratioText = formatRatioText(ratio);\n                    const severity = getSeverityFromRatio(ratio);\n\n                    const row = rowNodes[context.key];\n\n                    if (row) {\n                        if (row.value) {\n                            row.value.textContent = ratioText;\n                        }\n\n                        if (row.swatch) {\n                            row.swatch.style.setProperty('--mga-contrast-foreground', accentColor);\n                            row.swatch.style.setProperty('--mga-contrast-background', context.background);\n                        }\n                    }\n\n                    return {\n                        key: context.key,\n                        label: context.label,\n                        ratio: ratio || 0,\n                        ratioText,\n                        severity,\n                    };\n                });\n\n                audit = { entries };\n\n                const worstEntry = entries.reduce((worst, entry) => {\n                    if (!worst) {\n                        return entry;\n                    }\n\n                    if (!Number.isFinite(entry.ratio)) {\n                        return entry;\n                    }\n\n                    if (!Number.isFinite(worst.ratio)) {\n                        return entry;\n                    }\n\n                    return entry.ratio < worst.ratio ? entry : worst;\n                }, null);\n\n                const severity = worstEntry ? worstEntry.severity : 'success';\n\n                inspector.setAttribute('data-mga-severity', severity);\n\n                if (messageNode) {\n                    messageNode.textContent = formatSeverityMessage(worstEntry);\n                }\n            }\n\n            return audit;\n        };\n\n        update();\n\n        return {\n            update,\n            readAudit() {\n                return audit;\n            },\n        };\n    };\n\n    const createPresetDiffTracker = (defaults = {}) => {\n        if (!doc) {\n            return null;\n        }\n\n        const formatMissing = () => '\u2014';\n\n        const formatNumber = (value) => {\n            if (!Number.isFinite(value)) {\n                return formatMissing();\n            }\n\n            return String(value);\n        };\n\n        const formatSeconds = (value) => {\n            if (!Number.isFinite(value)) {\n                return formatMissing();\n            }\n\n            const rounded = Math.round(value * 10) / 10;\n            const display = Math.abs(rounded - Math.round(rounded)) < 0.01\n                ? String(Math.round(rounded))\n                : rounded.toFixed(1);\n\n            return mgaAdminSprintf(mgaAdmin__('%1$s\u00A0s', 'lightbox-jlg'), display);\n        };\n\n        const formatMilliseconds = (value) => {\n            if (!Number.isFinite(value)) {\n                return formatMissing();\n            }\n\n            return mgaAdminSprintf(mgaAdmin__('%1$s\u00A0ms', 'lightbox-jlg'), formatNumber(value));\n        };\n\n        const formatPixels = (value) => {\n            if (!Number.isFinite(value)) {\n                return formatMissing();\n            }\n\n            return mgaAdminSprintf(mgaAdmin__('%1$s\u00A0px', 'lightbox-jlg'), formatNumber(value));\n        };\n\n        const formatOpacity = (value) => {\n            if (!Number.isFinite(value)) {\n                return formatMissing();\n            }\n\n            const rounded = Math.round(value * 100) / 100;\n            return String(rounded).replace(/\\.0+$/, '').replace(/(\\.\\d*?)0+$/, '$1');\n        };\n\n        const formatBoolean = (value) => (value\n            ? mgaAdmin__('Activ\u00E9', 'lightbox-jlg')\n            : mgaAdmin__('D\u00E9sactiv\u00E9', 'lightbox-jlg'));\n\n        const getSelectLabel = (controlId, value, fallback = '') => {\n            if (!value) {\n                return fallback || formatMissing();\n            }\n\n            const element = doc.getElementById(controlId);\n\n            if (!element) {\n                return value;\n            }\n\n            const option = Array.from(element.options || []).find((candidate) => candidate.value === value);\n\n            if (option && option.textContent) {\n                return option.textContent.trim();\n            }\n\n            return value;\n        };\n\n        const getControlLabel = (controlId, fallback = '') => {\n            const label = doc.querySelector(`label[for=\"${controlId}\"]`);\n\n            if (!label) {\n                return fallback;\n            }\n\n            const text = label.textContent || '';\n            return text.replace(/\\s+/g, ' ').trim() || fallback;\n        };\n\n        const fieldConfigs = [\n            {\n                key: 'delay',\n                controlId: 'mga_delay',\n                sectionId: 'mga-section-playback',\n                type: 'float',\n                format: formatSeconds,\n            },\n            {\n                key: 'speed',\n                controlId: 'mga_speed',\n                sectionId: 'mga-section-playback',\n                type: 'int',\n                format: formatMilliseconds,\n            },\n            {\n                key: 'effect',\n                controlId: 'mga_effect',\n                sectionId: 'mga-section-playback',\n                type: 'select',\n                format: (value) => getSelectLabel('mga_effect', value, value),\n            },\n            {\n                key: 'easing',\n                controlId: 'mga_easing',\n                sectionId: 'mga-section-playback',\n                type: 'select',\n                format: (value) => getSelectLabel('mga_easing', value, value),\n            },\n            {\n                key: 'thumbs_layout',\n                controlId: 'mga_thumbs_layout',\n                sectionId: 'mga-section-thumbnails',\n                type: 'select',\n                format: (value) => getSelectLabel('mga_thumbs_layout', value, value),\n            },\n            {\n                key: 'thumb_size',\n                controlId: 'mga_thumb_size',\n                sectionId: 'mga-section-thumbnails',\n                type: 'int',\n                format: formatPixels,\n            },\n            {\n                key: 'thumb_size_mobile',\n                controlId: 'mga_thumb_size_mobile',\n                sectionId: 'mga-section-thumbnails',\n                type: 'int',\n                format: formatPixels,\n            },\n            {\n                key: 'show_thumbs_mobile',\n                controlId: 'mga_show_thumbs_mobile',\n                sectionId: 'mga-section-thumbnails',\n                type: 'boolean',\n                format: formatBoolean,\n            },\n            {\n                key: 'accent_color',\n                controlId: 'mga_accent_color',\n                sectionId: 'mga-section-appearance',\n                type: 'color',\n                format: (value) => (value ? value.toUpperCase() : formatMissing()),\n            },\n            {\n                key: 'bg_opacity',\n                controlId: 'mga_bg_opacity',\n                sectionId: 'mga-section-appearance',\n                type: 'float',\n                format: formatOpacity,\n            },\n            {\n                key: 'background_style',\n                controlId: 'mga_background_style',\n                sectionId: 'mga-section-appearance',\n                type: 'select',\n                format: (value) => getSelectLabel('mga_background_style', value, value),\n            },\n            {\n                key: 'autoplay_start',\n                controlId: 'mga_autoplay_start',\n                sectionId: 'mga-section-playback',\n                type: 'boolean',\n                format: formatBoolean,\n            },\n            {\n                key: 'loop',\n                controlId: 'mga_loop',\n                sectionId: 'mga-section-playback',\n                type: 'boolean',\n                format: formatBoolean,\n            },\n            {\n                key: 'show_zoom',\n                controlId: 'mga_show_zoom',\n                sectionId: 'mga-section-toolbar',\n                type: 'boolean',\n                format: formatBoolean,\n            },\n            {\n                key: 'show_download',\n                controlId: 'mga_show_download',\n                sectionId: 'mga-section-toolbar',\n                type: 'boolean',\n                format: formatBoolean,\n            },\n            {\n                key: 'show_share',\n                controlId: 'mga_show_share',\n                sectionId: 'mga-section-toolbar',\n                type: 'boolean',\n                format: formatBoolean,\n            },\n            {\n                key: 'show_cta',\n                controlId: 'mga_show_cta',\n                sectionId: 'mga-section-toolbar',\n                type: 'boolean',\n                format: formatBoolean,\n            },\n            {\n                key: 'show_fullscreen',\n                controlId: 'mga_show_fullscreen',\n                sectionId: 'mga-section-toolbar',\n                type: 'boolean',\n                format: formatBoolean,\n            },\n        ];\n\n        const getDefaultLabel = () => mgaAdmin__('R\u00E9glages recommand\u00E9s', 'lightbox-jlg');\n\n        const normalizeValue = (config, rawValue) => {\n            switch (config.type) {\n                case 'int': {\n                    const number = parseInt(rawValue, 10);\n                    return Number.isFinite(number) ? number : null;\n                }\n                case 'float': {\n                    const number = parseFloat(rawValue);\n                    return Number.isFinite(number) ? Math.round(number * 100) / 100 : null;\n                }\n                case 'boolean':\n                    return Boolean(rawValue);\n                case 'color':\n                    return normalizeHexColor(rawValue);\n                case 'select':\n                    return typeof rawValue === 'string' ? rawValue : '';\n                default:\n                    return rawValue;\n            }\n        };\n\n        const normalizeSettings = (settings = {}) => {\n            const normalized = {};\n\n            fieldConfigs.forEach((config) => {\n                if (Object.prototype.hasOwnProperty.call(settings, config.key)) {\n                    normalized[config.key] = normalizeValue(config, settings[config.key]);\n                }\n            });\n\n            return normalized;\n        };\n\n        const defaultNormalized = normalizeSettings(defaults);\n\n        let navigationApi = null;\n        let lastSectionStates = new Map();\n\n        let baseline = {\n            key: '',\n            label: getDefaultLabel(),\n            settings: { ...defaultNormalized },\n        };\n\n        const readCurrentValue = (config) => {\n            const element = doc.getElementById(config.controlId);\n\n            if (!element) {\n                return config.type === 'boolean' ? false : config.type === 'select' ? '' : null;\n            }\n\n            switch (config.type) {\n                case 'boolean':\n                    return Boolean(element.checked);\n                case 'select':\n                    return element.value || '';\n                case 'color':\n                    return normalizeHexColor(element.value);\n                default:\n                    return element.value;\n            }\n        };\n\n        const areValuesEqual = (config, a, b) => {\n            if (config.type === 'float') {\n                if (a === null && b === null) {\n                    return true;\n                }\n\n                if (a === null || b === null) {\n                    return false;\n                }\n\n                return Math.abs(a - b) < 0.01;\n            }\n\n            return a === b;\n        };\n\n        const ensureLabels = () => {\n            fieldConfigs.forEach((config) => {\n                if (!config.label) {\n                    config.label = getControlLabel(config.controlId, '');\n                }\n            });\n        };\n\n        const updateNavigationState = (sectionStates) => {\n            if (!navigationApi || typeof navigationApi.setSectionModified !== 'function') {\n                return;\n            }\n\n            sectionStates.forEach((isModified, sectionId) => {\n                const sectionElement = sectionId ? doc.getElementById(sectionId) : null;\n\n                if (sectionElement) {\n                    navigationApi.setSectionModified(sectionElement, Boolean(isModified));\n                }\n            });\n        };\n\n        const refresh = () => {\n            ensureLabels();\n\n            const diff = [];\n            const sectionStates = new Map();\n\n            fieldConfigs.forEach((config) => {\n                const baselineValue = Object.prototype.hasOwnProperty.call(baseline.settings, config.key)\n                    ? baseline.settings[config.key]\n                    : defaultNormalized[config.key];\n                const currentValue = normalizeValue(config, readCurrentValue(config));\n                const changed = !areValuesEqual(config, baselineValue, currentValue);\n\n                if (changed) {\n                    diff.push({\n                        key: config.key,\n                        label: config.label || '',\n                        baselineLabel: config.format(baselineValue),\n                        currentLabel: config.format(currentValue),\n                    });\n                }\n\n                if (!sectionStates.has(config.sectionId)) {\n                    sectionStates.set(config.sectionId, changed);\n                } else if (changed) {\n                    sectionStates.set(config.sectionId, true);\n                }\n            });\n\n            updateNavigationState(sectionStates);\n\n            lastSectionStates = sectionStates;\n\n            return diff;\n        };\n\n        const setBaseline = ({ key = '', label = '', settings = {} } = {}) => {\n            baseline = {\n                key,\n                label: label && label.trim() !== '' ? label : getDefaultLabel(),\n                settings: {\n                    ...defaultNormalized,\n                    ...normalizeSettings(settings),\n                },\n            };\n\n            refresh();\n        };\n\n        const setNavigationApi = (api) => {\n            navigationApi = api;\n\n            if (lastSectionStates.size > 0) {\n                updateNavigationState(lastSectionStates);\n            }\n        };\n\n        const getBaselineInfo = () => ({\n            key: baseline.key,\n            label: baseline.label,\n        });\n\n        setBaseline({ settings: baseline.settings });\n\n        return {\n            refresh,\n            setBaseline,\n            getBaselineInfo,\n            getDefaultLabel,\n            setNavigationApi,\n        };\n    };\n\n    if (!doc || typeof doc.addEventListener !== 'function') {\n        return;\n    }\n\n    doc.addEventListener('DOMContentLoaded', function() {\n        const form = doc.querySelector('[data-mga-settings-form]') || doc.querySelector('.mga-admin-wrap form');\n        const adminRoot = doc.querySelector('.mga-admin-wrap');\n        let scheduleSummaryRefresh = () => {};\n        let contrastInspector = null;\n        let presetDiffTracker = null;\n\n        const THEME_STORAGE_KEY = 'mgaAdminThemePreference';\n        const THEME_OPTIONS = ['light', 'dark', 'system'];\n        const themeSelect = adminRoot ? adminRoot.querySelector('[data-mga-theme-select]') : null;\n        const systemThemeQuery = typeof global.matchMedia === 'function'\n            ? global.matchMedia('(prefers-color-scheme: dark)')\n            : null;\n\n        const readStoredTheme = () => {\n            try {\n                return global.localStorage ? global.localStorage.getItem(THEME_STORAGE_KEY) : null;\n            } catch (error) {\n                return null;\n            }\n        };\n\n        const writeStoredTheme = (value) => {\n            try {\n                if (!global.localStorage) {\n                    return;\n                }\n                if (!value) {\n                    global.localStorage.removeItem(THEME_STORAGE_KEY);\n                    return;\n                }\n                global.localStorage.setItem(THEME_STORAGE_KEY, value);\n            } catch (error) {\n                // Silently ignore storage errors (quota, private mode, etc.).\n            }\n        };\n\n        const normalizeThemePreference = (value) => {\n            if (typeof value !== 'string') {\n                return 'system';\n            }\n\n            const trimmed = value.trim().toLowerCase();\n            return THEME_OPTIONS.includes(trimmed) ? trimmed : 'system';\n        };\n\n        let currentThemePreference = normalizeThemePreference(readStoredTheme());\n\n        const resolveAppliedTheme = (preference) => {\n            if (preference === 'dark') {\n                return 'dark';\n            }\n            if (preference === 'light') {\n                return 'light';\n            }\n\n            const prefersDark = systemThemeQuery && typeof systemThemeQuery.matches === 'boolean'\n                ? systemThemeQuery.matches\n                : false;\n\n            return prefersDark ? 'dark' : 'light';\n        };\n\n        const applyThemePreference = (preference, options = {}) => {\n            if (!adminRoot) {\n                return;\n            }\n\n            const normalizedPreference = normalizeThemePreference(preference);\n            const resolvedTheme = resolveAppliedTheme(normalizedPreference);\n\n            adminRoot.setAttribute('data-mga-theme-preference', normalizedPreference);\n            adminRoot.setAttribute('data-mga-theme', resolvedTheme);\n            adminRoot.classList.toggle('is-theme-dark', resolvedTheme === 'dark');\n            adminRoot.classList.toggle('is-theme-light', resolvedTheme !== 'dark');\n\n            if (themeSelect && themeSelect.value !== normalizedPreference) {\n                themeSelect.value = normalizedPreference;\n            }\n\n            if (!options.skipStorage) {\n                writeStoredTheme(normalizedPreference === 'system' ? '' : normalizedPreference);\n            }\n\n            currentThemePreference = normalizedPreference;\n        };\n\n        if (adminRoot) {\n            applyThemePreference(currentThemePreference, { skipStorage: true });\n        }\n\n        if (themeSelect) {\n            themeSelect.value = currentThemePreference;\n            themeSelect.addEventListener('change', (event) => {\n                const nextPreference = normalizeThemePreference(event.target ? event.target.value : null);\n                applyThemePreference(nextPreference);\n            });\n        }\n\n        const handleSystemThemeChange = () => {\n            if (currentThemePreference === 'system') {\n                applyThemePreference('system', { skipStorage: true });\n            }\n        };\n\n        if (systemThemeQuery) {\n            if (typeof systemThemeQuery.addEventListener === 'function') {\n                systemThemeQuery.addEventListener('change', handleSystemThemeChange);\n            } else if (typeof systemThemeQuery.addListener === 'function') {\n                systemThemeQuery.addListener(handleSystemThemeChange);\n            }\n        }\n\n        const initializeWizard = (targetForm) => {\n            const wizard = doc.querySelector('[data-mga-wizard]');\n\n            if (!wizard) {\n                return null;\n            }\n\n            const stepPanels = Array.from(wizard.querySelectorAll('[data-mga-step-panel]'));\n            const indicators = Array.from(wizard.querySelectorAll('[data-mga-step-indicator]'));\n            const prevButton = wizard.querySelector('[data-mga-step-prev]');\n            const nextButton = wizard.querySelector('[data-mga-step-next]');\n            const submitButton = wizard.querySelector('[data-mga-step-submit]');\n            const statusElement = wizard.querySelector('[data-mga-save-status]');\n            const summaryIndex = stepPanels.length - 1;\n            let currentIndex = stepPanels.findIndex((panel) => panel.classList.contains('is-active'));\n\n            if (currentIndex < 0) {\n                currentIndex = 0;\n            }\n\n            const getMessages = () => (global.mgaAdminConfig && global.mgaAdminConfig.messages) || {};\n\n            const setStatusMessage = (state, message) => {\n                if (!statusElement) {\n                    return;\n                }\n\n                const statusMessage = message || getMessages()[state] || '';\n\n                statusElement.textContent = statusMessage;\n                statusElement.setAttribute('data-mga-status-state', state);\n            };\n\n            const updateControls = () => {\n                if (prevButton) {\n                    prevButton.disabled = currentIndex === 0;\n                }\n\n                if (nextButton) {\n                    nextButton.hidden = currentIndex >= summaryIndex;\n                }\n\n                if (submitButton) {\n                    submitButton.hidden = currentIndex < summaryIndex;\n                }\n            };\n\n            const focusPanel = (panel) => {\n                if (!panel) {\n                    return;\n                }\n\n                const focusTarget = panel.querySelector('[data-mga-step-title]') || panel;\n                const focusOptions = detectFocusOptionsSupport() ? { preventScroll: true } : undefined;\n\n                global.requestAnimationFrame(() => {\n                    safeFocus(focusTarget, focusOptions);\n                });\n            };\n\n            const deactivatePanel = (panel) => {\n                panel.classList.remove('is-active');\n                panel.setAttribute('hidden', 'hidden');\n                panel.setAttribute('aria-hidden', 'true');\n            };\n\n            const activatePanel = (panel) => {\n                panel.classList.add('is-active');\n                panel.removeAttribute('hidden');\n                panel.setAttribute('aria-hidden', 'false');\n            };\n\n            const updateIndicators = () => {\n                indicators.forEach((indicator, index) => {\n                    indicator.classList.toggle('is-active', index === currentIndex);\n                    indicator.classList.toggle('is-completed', index < currentIndex);\n                    indicator.setAttribute('aria-current', index === currentIndex ? 'step' : 'false');\n                });\n            };\n\n            const updateSummaryContainers = (() => {\n                let timeoutId = null;\n\n                const presetTarget = wizard.querySelector('[data-mga-summary-preset]');\n                const timingTarget = wizard.querySelector('[data-mga-summary-timing]');\n                const toolbarTarget = wizard.querySelector('[data-mga-summary-toolbar]');\n                const shareTarget = wizard.querySelector('[data-mga-summary-share]');\n                const validationContainer = wizard.querySelector('[data-mga-summary-validations]');\n                const diffContainer = wizard.querySelector('[data-mga-summary-diff]');\n                const diffList = diffContainer ? diffContainer.querySelector('[data-mga-summary-diff-list]') : null;\n                const diffBaseline = diffContainer ? diffContainer.querySelector('[data-mga-summary-diff-baseline]') : null;\n                const diffEmpty = diffContainer ? diffContainer.querySelector('[data-mga-summary-diff-empty]') : null;\n                const scoreboardContainer = wizard.querySelector('[data-mga-summary-scoreboard]');\n                const scorecardMap = (() => {\n                    const map = new Map();\n\n                    if (!scoreboardContainer) {\n                        return map;\n                    }\n\n                    scoreboardContainer.querySelectorAll('[data-mga-scorecard]').forEach((card) => {\n                        const key = card.getAttribute('data-mga-score-key');\n\n                        if (key) {\n                            map.set(key, card);\n                        }\n                    });\n\n                    return map;\n                })();\n\n                const applyScorecardState = (key, payload) => {\n                    const card = scorecardMap.get(key);\n\n                    if (!card || !payload) {\n                        return;\n                    }\n\n                    const level = payload.level || 'info';\n                    card.setAttribute('data-score-level', level);\n\n                    const statusEl = card.querySelector('[data-mga-scorecard-status]');\n\n                    if (statusEl) {\n                        statusEl.textContent = payload.message || '';\n                    }\n\n                    const pointsContainer = card.querySelector('[data-mga-scorecard-points]');\n\n                    if (pointsContainer && Array.isArray(payload.points)) {\n                        payload.points.forEach((point) => {\n                            if (!point || !point.key) {\n                                return;\n                            }\n\n                            const item = pointsContainer.querySelector(`[data-point=\"${point.key}\"]`);\n\n                            if (!item) {\n                                return;\n                            }\n\n                            const state = point.state || 'info';\n                            item.setAttribute('data-point-state', state);\n\n                            if (typeof point.text === 'string') {\n                                item.textContent = point.text;\n                            }\n                        });\n                    }\n                };\n\n                const renderScoreboard = (scores) => {\n                    if (!scores || !scorecardMap.size) {\n                        return;\n                    }\n\n                    Object.keys(scores).forEach((scoreKey) => {\n                        applyScorecardState(scoreKey, scores[scoreKey]);\n                    });\n                };\n\n                const severityRank = {\n                    positive: 0,\n                    info: 1,\n                    warning: 2,\n                    alert: 3,\n                };\n\n                const computeLevelFromPoints = (points) => {\n                    if (!Array.isArray(points) || points.length === 0) {\n                        return 'info';\n                    }\n\n                    let highest = 'positive';\n\n                    points.forEach((point) => {\n                        const state = point && point.state ? point.state : 'info';\n\n                        if (severityRank[state] > severityRank[highest]) {\n                            highest = state;\n                        }\n                    });\n\n                    return highest;\n                };\n\n                const resolveCardMessage = (cardKey, level) => {\n                    const dictionary = {\n                        ux: {\n                            positive: mgaAdmin__('Parcours fluide et align\u00E9 sur les extensions premium.', 'lightbox-jlg'),\n                            info: mgaAdmin__('Quelques optimisations UX restent possibles.', 'lightbox-jlg'),\n                            warning: mgaAdmin__('Ajustez le rythme ou la navigation pour \u00E9galer les standards pro.', 'lightbox-jlg'),\n                            alert: mgaAdmin__('Corrigez les r\u00E9glages UX critiques avant publication.', 'lightbox-jlg'),\n                        },\n                        accessibility: {\n                            positive: mgaAdmin__('Accessible par d\u00E9faut\u00A0: pr\u00EAt pour un audit WCAG.', 'lightbox-jlg'),\n                            info: mgaAdmin__('Affinez deux ou trois points pour une accessibilit\u00E9 parfaite.', 'lightbox-jlg'),\n                            warning: mgaAdmin__('Renforcez l\u2019accessibilit\u00E9 pour rester au niveau des lightbox professionnelles.', 'lightbox-jlg'),\n                            alert: mgaAdmin__('Corrigez les probl\u00E8mes d\u2019accessibilit\u00E9 avant publication.', 'lightbox-jlg'),\n                        },\n                        reliability: {\n                            positive: mgaAdmin__('Stack pr\u00EAte pour une mise en production sans surprise.', 'lightbox-jlg'),\n                            info: mgaAdmin__('V\u00E9rifiez vos fallbacks pour \u00E9galer la robustesse des offres pro.', 'lightbox-jlg'),\n                            warning: mgaAdmin__('S\u00E9curisez la configuration avant de la confier \u00E0 vos clients.', 'lightbox-jlg'),\n                            alert: mgaAdmin__('Corrigez les risques critiques pour garantir la fiabilit\u00E9.', 'lightbox-jlg'),\n                        },\n                        visual: {\n                            positive: mgaAdmin__('Palette pr\u00EAte \u00E0 impressionner vos visiteurs.', 'lightbox-jlg'),\n                            info: mgaAdmin__('Peaufinez les presets pour un rendu au niveau premium.', 'lightbox-jlg'),\n                            warning: mgaAdmin__('Ajustez les \u00E9l\u00E9ments visuels pour conserver une identit\u00E9 coh\u00E9rente.', 'lightbox-jlg'),\n                            alert: mgaAdmin__('Corrigez la couleur ou le style avant publication.', 'lightbox-jlg'),\n                        },\n                    };\n\n                    const variants = dictionary[cardKey] || {};\n                    return variants[level] || variants.info || '';\n                };\n\n                const readNumberValue = (id) => {\n                    const element = doc.getElementById(id);\n\n                    if (!element) {\n                        return Number.NaN;\n                    }\n\n                    const value = parseFloat(element.value);\n                    return Number.isNaN(value) ? Number.NaN : value;\n                };\n\n                const readSelectValue = (id) => {\n                    const element = doc.getElementById(id);\n\n                    if (!element || typeof element.value !== 'string') {\n                        return '';\n                    }\n\n                    return element.value;\n                };\n\n                const readSelectLabel = (id, fallback) => {\n                    const element = doc.getElementById(id);\n\n                    if (!element) {\n                        return fallback || '';\n                    }\n\n                    const selectedOption = Array.from(element.options).find((option) => option.selected);\n\n                    if (selectedOption && selectedOption.textContent) {\n                        return selectedOption.textContent;\n                    }\n\n                    return fallback || '';\n                };\n\n                const readCheckboxValue = (id) => {\n                    const element = doc.getElementById(id);\n                    return element ? Boolean(element.checked) : false;\n                };\n\n                const formatSecondsValue = (value) => {\n                    if (!Number.isFinite(value)) {\n                        return '\u2014';\n                    }\n\n                    const rounded = Math.round(value * 10) / 10;\n\n                    if (Math.abs(rounded - Math.round(rounded)) < 0.01) {\n                        return String(Math.round(rounded));\n                    }\n\n                    return rounded.toFixed(1);\n                };\n\n                const evaluateScoreboard = (validations, diff, baselineInfo) => {\n                    if (!scorecardMap.size) {\n                        return null;\n                    }\n\n                    const worstValidation = Array.isArray(validations)\n                        ? validations.find((item) => item && item.severity === 'error')\n                            || validations.find((item) => item && item.severity === 'warning')\n                        : null;\n\n                    const buildUxScore = () => {\n                        const delayValue = readNumberValue('mga_delay');\n                        const effectValue = readSelectValue('mga_effect');\n                        const effectLabel = readSelectLabel('mga_effect', effectValue);\n                        const autoplay = readCheckboxValue('mga_autoplay_start');\n                        const showThumbsMobile = readCheckboxValue('mga_show_thumbs_mobile');\n                        const thumbsLayout = readSelectValue('mga_thumbs_layout');\n                        const points = [];\n\n                        const formattedDelay = formatSecondsValue(delayValue);\n                        let delayState = 'positive';\n                        let delayText = mgaAdminSprintf(\n                            mgaAdmin__('Tempo confortable : %1$s\u00A0s par diapositive.', 'lightbox-jlg'),\n                            formattedDelay\n                        );\n\n                        if (!Number.isFinite(delayValue)) {\n                            delayState = 'info';\n                            delayText = mgaAdmin__('Renseignez le tempo du diaporama pour caler la cadence.', 'lightbox-jlg');\n                        } else if (delayValue < 2.5) {\n                            delayState = 'alert';\n                            delayText = mgaAdminSprintf(\n                                mgaAdmin__('Tempo tr\u00E8s rapide (%1$s\u00A0s) : ralentissez pour laisser le temps de lecture.', 'lightbox-jlg'),\n                                formattedDelay\n                            );\n                        } else if (delayValue < 3 || delayValue > 6) {\n                            delayState = 'warning';\n                            delayText = mgaAdminSprintf(\n                                mgaAdmin__('Tempo \u00E0 %1$s\u00A0s : ciblez entre 3 et 6\u00A0s pour un rythme premium.', 'lightbox-jlg'),\n                                formattedDelay\n                            );\n                        }\n\n                        points.push({\n                            key: 'delay',\n                            state: delayState,\n                            text: delayText,\n                        });\n\n                        let navState = 'positive';\n                        let navText = mgaAdmin__('Miniatures ou navigation mobile affich\u00E9es : rep\u00E8res clairs.', 'lightbox-jlg');\n\n                        if (thumbsLayout === 'hidden' && !showThumbsMobile) {\n                            navState = 'warning';\n                            navText = mgaAdmin__('Activez les miniatures ou la navigation mobile pour guider vos visiteurs.', 'lightbox-jlg');\n                        } else if (thumbsLayout === 'hidden') {\n                            navState = 'info';\n                            navText = mgaAdmin__('Miniatures masqu\u00E9es sur desktop : v\u00E9rifiez que les fl\u00E8ches restent visibles.', 'lightbox-jlg');\n                        }\n\n                        points.push({\n                            key: 'navigation',\n                            state: navState,\n                            text: navText,\n                        });\n\n                        const heavyEffects = new Set(['cube', 'coverflow', 'flip']);\n                        const normalizedEffect = typeof effectValue === 'string' ? effectValue.toLowerCase() : '';\n                        const effectDisplayLabel = effectLabel || effectValue || 'slide';\n                        let animState = 'positive';\n                        let animText = mgaAdminSprintf(\n                            mgaAdmin__('Transition \u00AB\u00A0%1$s\u00A0\u00BB adapt\u00E9e au parcours.', 'lightbox-jlg'),\n                            effectDisplayLabel\n                        );\n\n                        if (heavyEffects.has(normalizedEffect) && autoplay) {\n                            animState = 'warning';\n                            animText = mgaAdminSprintf(\n                                mgaAdmin__('Effet 3D \u00AB\u00A0%1$s\u00A0\u00BB avec autoplay : envisagez un d\u00E9marrage manuel pour le confort utilisateur.', 'lightbox-jlg'),\n                                effectDisplayLabel\n                            );\n                        } else if (heavyEffects.has(normalizedEffect)) {\n                            animState = 'info';\n                            animText = mgaAdminSprintf(\n                                mgaAdmin__('Effet 3D \u00AB\u00A0%1$s\u00A0\u00BB activ\u00E9 : testez la performance sur mobile.', 'lightbox-jlg'),\n                                effectDisplayLabel\n                            );\n                        } else if (!effectValue) {\n                            animState = 'info';\n                            animText = mgaAdmin__('Choisissez un effet pour personnaliser le ressenti.', 'lightbox-jlg');\n                        }\n\n                        points.push({\n                            key: 'animation',\n                            state: animState,\n                            text: animText,\n                        });\n\n                        const level = computeLevelFromPoints(points);\n                        const message = resolveCardMessage('ux', level);\n\n                        return { level, message, points };\n                    };\n\n                    const buildAccessibilityScore = () => {\n                        const autoplay = readCheckboxValue('mga_autoplay_start');\n                        const startOnClicked = readCheckboxValue('mga_start_on_clicked_image');\n                        const points = [];\n\n                        let contrastState = 'positive';\n                        let contrastText = mgaAdmin__('Contraste valid\u00E9 : aucun blocage d\u00E9tect\u00E9.', 'lightbox-jlg');\n\n                        if (worstValidation) {\n                            contrastState = worstValidation.severity === 'error' ? 'alert' : 'warning';\n                            contrastText = worstValidation.message;\n                        }\n\n                        points.push({\n                            key: 'contrast',\n                            state: contrastState,\n                            text: contrastText,\n                        });\n\n                        let autoplayState = 'positive';\n                        let autoplayText = mgaAdmin__('Lecture d\u00E9clench\u00E9e par l\u2019utilisateur : confort respect\u00E9.', 'lightbox-jlg');\n\n                        if (autoplay) {\n                            autoplayState = 'warning';\n                            autoplayText = mgaAdmin__('D\u00E9sactivez le d\u00E9marrage automatique pour laisser le contr\u00F4le aux visiteurs.', 'lightbox-jlg');\n                        }\n\n                        points.push({\n                            key: 'autoplay',\n                            state: autoplayState,\n                            text: autoplayText,\n                        });\n\n                        let contextState = 'positive';\n                        let contextText = mgaAdmin__('La visionneuse s\u2019ouvre sur l\u2019image cliqu\u00E9e : orientation conserv\u00E9e.', 'lightbox-jlg');\n\n                        if (!startOnClicked) {\n                            contextState = 'info';\n                            contextText = mgaAdmin__('Activez \u00AB\u00A0D\u00E9marrer sur l\u2019image cliqu\u00E9e\u00A0\u00BB pour \u00E9viter les sauts de focus.', 'lightbox-jlg');\n                        }\n\n                        points.push({\n                            key: 'context',\n                            state: contextState,\n                            text: contextText,\n                        });\n\n                        const level = computeLevelFromPoints(points);\n                        const message = resolveCardMessage('accessibility', level);\n\n                        return { level, message, points };\n                    };\n\n                    const buildReliabilityScore = () => {\n                        const includeSvg = readCheckboxValue('mga_include_svg');\n                        const allowFallback = readCheckboxValue('mga_allow_body_fallback');\n                        const debugMode = readCheckboxValue('mga_debug_mode');\n                        const loadArchives = readCheckboxValue('mga_load_on_archives');\n                        const points = [];\n\n                        const assetsState = includeSvg ? 'positive' : 'alert';\n                        const assetsText = includeSvg\n                            ? mgaAdmin__('Ic\u00F4nes SVG locales actives : vos contr\u00F4les restent visibles hors connexion.', 'lightbox-jlg')\n                            : mgaAdmin__('R\u00E9activez les ic\u00F4nes SVG locales pour \u00E9viter les boutons invisibles si le CDN est indisponible.', 'lightbox-jlg');\n\n                        points.push({\n                            key: 'assets',\n                            state: assetsState,\n                            text: assetsText,\n                        });\n\n                        let fallbackState = allowFallback ? 'positive' : 'info';\n                        let fallbackText = allowFallback\n                            ? mgaAdmin__('Fallback \u00AB\u00A0body\u00A0\u00BB actif : compatibilit\u00E9 renforc\u00E9e avec les constructeurs de pages.', 'lightbox-jlg')\n                            : mgaAdmin__('Activez le fallback \u00AB\u00A0body\u00A0\u00BB si vos galeries sont inject\u00E9es dynamiquement.', 'lightbox-jlg');\n\n                        if (loadArchives) {\n                            fallbackState = 'positive';\n                            fallbackText = mgaAdmin__('Chargement sur les pages d\u2019archives activ\u00E9 : visionneuse pr\u00EAte dans les listes.', 'lightbox-jlg');\n                        }\n\n                        points.push({\n                            key: 'fallback',\n                            state: fallbackState,\n                            text: fallbackText,\n                        });\n\n                        const debugState = debugMode ? 'warning' : 'positive';\n                        const debugText = debugMode\n                            ? mgaAdmin__('D\u00E9sactivez le mode debug pour \u00E9viter les logs verbeux en production.', 'lightbox-jlg')\n                            : mgaAdmin__('Mode debug d\u00E9sactiv\u00E9 : stabilit\u00E9 optimale.', 'lightbox-jlg');\n\n                        points.push({\n                            key: 'debug',\n                            state: debugState,\n                            text: debugText,\n                        });\n\n                        const level = computeLevelFromPoints(points);\n                        const message = resolveCardMessage('reliability', level);\n\n                        return { level, message, points };\n                    };\n\n                    const buildVisualScore = () => {\n                        const presetSelect = doc.getElementById('mga_style_preset');\n                        const presetValue = presetSelect && typeof presetSelect.value === 'string' ? presetSelect.value : '';\n                        const accentInput = doc.getElementById('mga_accent_color');\n                        const rawAccentValue = accentInput && typeof accentInput.value === 'string'\n                            ? accentInput.value.trim()\n                            : '';\n                        const backgroundValue = readSelectValue('mga_background_style');\n                        const backgroundLabel = readSelectLabel('mga_background_style', backgroundValue);\n                        const hasDiff = Array.isArray(diff) && diff.length > 0;\n                        const baselineLabel = baselineInfo && baselineInfo.label ? baselineInfo.label : '';\n                        const points = [];\n\n                        const resolvePresetLabel = () => {\n                            if (presetSelect) {\n                                const option = Array.from(presetSelect.options).find((candidate) => candidate.value === presetValue);\n\n                                if (option && option.textContent) {\n                                    return option.textContent.trim();\n                                }\n                            }\n\n                            if (baselineLabel) {\n                                return baselineLabel;\n                            }\n\n                            return '';\n                        };\n\n                        const presetLabel = resolvePresetLabel();\n                        let presetState = 'info';\n                        let presetText = mgaAdmin__('Aucun preset s\u00E9lectionn\u00E9 : testez les styles propos\u00E9s pour un rendu premium.', 'lightbox-jlg');\n\n                        if (presetValue) {\n                            presetState = 'positive';\n                            presetText = mgaAdminSprintf(\n                                mgaAdmin__('Preset professionnel \u00AB\u00A0%1$s\u00A0\u00BB appliqu\u00E9.', 'lightbox-jlg'),\n                                presetLabel || presetValue\n                            );\n                        } else if (hasDiff) {\n                            presetState = 'positive';\n                            presetText = baselineLabel\n                                ? mgaAdminSprintf(\n                                    mgaAdmin__('Palette personnalis\u00E9e bas\u00E9e sur \u00AB\u00A0%1$s\u00A0\u00BB.', 'lightbox-jlg'),\n                                    baselineLabel\n                                )\n                                : mgaAdmin__('Palette personnalis\u00E9e active.', 'lightbox-jlg');\n                        }\n\n                        points.push({\n                            key: 'preset',\n                            state: presetState,\n                            text: presetText,\n                        });\n\n                        const accentLower = rawAccentValue.toLowerCase();\n                        let accentState = 'positive';\n                        let accentText = mgaAdmin__('Couleur d\u2019accent personnalis\u00E9e pr\u00EAte \u00E0 \u00EAtre d\u00E9clin\u00E9e.', 'lightbox-jlg');\n\n                        if (!isValidHexColor(rawAccentValue)) {\n                            accentState = 'alert';\n                            accentText = mgaAdmin__('Couleur d\u2019accent invalide : utilisez un code hexad\u00E9cimal (#123ABC).', 'lightbox-jlg');\n                        } else if (accentLower === '#ffffff') {\n                            accentState = 'info';\n                            accentText = mgaAdmin__('Personnalisez la couleur d\u2019accent pour refl\u00E9ter votre marque.', 'lightbox-jlg');\n                        } else {\n                            accentText = mgaAdminSprintf(\n                                mgaAdmin__('Accent d\u00E9fini sur %1$s : pensez \u00E0 l\u2019harmoniser avec vos CTA.', 'lightbox-jlg'),\n                                rawAccentValue.toUpperCase()\n                            );\n                        }\n\n                        points.push({\n                            key: 'accent',\n                            state: accentState,\n                            text: accentText,\n                        });\n\n                        let backgroundState = 'info';\n                        let backgroundText = mgaAdmin__('Choisissez un style de fond (\u00E9cho, blur, texture) pour enrichir la sc\u00E9nographie.', 'lightbox-jlg');\n\n                        if (backgroundValue) {\n                            backgroundState = 'positive';\n                            backgroundText = mgaAdminSprintf(\n                                mgaAdmin__('Arri\u00E8re-plan \u00AB\u00A0%1$s\u00A0\u00BB activ\u00E9 pour cr\u00E9er de la profondeur.', 'lightbox-jlg'),\n                                backgroundLabel || backgroundValue\n                            );\n                        }\n\n                        points.push({\n                            key: 'background',\n                            state: backgroundState,\n                            text: backgroundText,\n                        });\n\n                        const level = computeLevelFromPoints(points);\n                        const message = resolveCardMessage('visual', level);\n\n                        return { level, message, points };\n                    };\n\n                    return {\n                        ux: buildUxScore(),\n                        accessibility: buildAccessibilityScore(),\n                        reliability: buildReliabilityScore(),\n                        visual: buildVisualScore(),\n                    };\n                };\n\n                const renderToolbarSummary = () => {\n                    if (!toolbarTarget) {\n                        return;\n                    }\n\n                    const toolbarToggles = [\n                        { id: 'mga_show_zoom', label: mgaAdmin__('Zoom', 'lightbox-jlg') },\n                        { id: 'mga_show_download', label: mgaAdmin__('T\u00E9l\u00E9chargement', 'lightbox-jlg') },\n                        { id: 'mga_show_share', label: mgaAdmin__('Partage', 'lightbox-jlg') },\n                        { id: 'mga_show_cta', label: mgaAdmin__('Appel \u00E0 l\u2019action', 'lightbox-jlg') },\n                        { id: 'mga_show_fullscreen', label: mgaAdmin__('Plein \u00E9cran', 'lightbox-jlg') },\n                    ];\n\n                    const active = toolbarToggles.filter((toggle) => {\n                        const input = doc.getElementById(toggle.id);\n                        return input ? input.checked : false;\n                    });\n\n                    toolbarTarget.textContent = active.length > 0\n                        ? active.map((toggle) => toggle.label).join(', ')\n                        : mgaAdmin__('Aucun bouton affich\u00E9', 'lightbox-jlg');\n                };\n\n                const renderPresetSummary = (diff, baselineInfo) => {\n                    if (!presetTarget) {\n                        return;\n                    }\n\n                    const presetSelect = doc.getElementById('mga_style_preset');\n                    const value = presetSelect ? presetSelect.value : '';\n                    let label = '';\n\n                    if (presetSelect && value) {\n                        const fallback = Array.from(presetSelect.options).find((option) => option.value === value);\n\n                        if (fallback) {\n                            label = fallback.textContent || '';\n                        }\n                    }\n\n                    if (!label) {\n                        if (diff.length > 0 && baselineInfo && baselineInfo.label) {\n                            label = mgaAdminSprintf(\n                                mgaAdmin__('Personnalis\u00E9 \u00E0 partir de %1$s', 'lightbox-jlg'),\n                                baselineInfo.label\n                            );\n                        } else if (diff.length > 0) {\n                            label = mgaAdmin__('R\u00E9glages personnalis\u00E9s', 'lightbox-jlg');\n                        } else if (baselineInfo && baselineInfo.label) {\n                            label = baselineInfo.label;\n                        } else if (global.mgaStylePresets && typeof global.mgaStylePresets.customDescription === 'string') {\n                            label = global.mgaStylePresets.customDescription;\n                        } else {\n                            label = mgaAdmin__('R\u00E9glages personnalis\u00E9s', 'lightbox-jlg');\n                        }\n                    }\n\n                    presetTarget.textContent = label;\n                };\n\n                const renderTimingSummary = () => {\n                    if (!timingTarget) {\n                        return;\n                    }\n\n                    const delayInput = doc.getElementById('mga_delay');\n                    const effectSelect = doc.getElementById('mga_effect');\n                    const delayValue = delayInput && delayInput.value ? delayInput.value : '\u2014';\n                    let effectLabel = mgaAdmin__('Transition personnalis\u00E9e', 'lightbox-jlg');\n\n                    if (effectSelect) {\n                        const selectedOption = Array.from(effectSelect.options).find((option) => option.selected);\n                        effectLabel = selectedOption ? selectedOption.textContent : effectLabel;\n                    }\n\n                    timingTarget.textContent = mgaAdminSprintf(\n                        mgaAdmin__('Diaporama : %1$s\u00A0s \u00B7 Effet : %2$s', 'lightbox-jlg'),\n                        delayValue,\n                        effectLabel\n                    );\n                };\n\n                const renderShareSummary = () => {\n                    if (!shareTarget) {\n                        return;\n                    }\n\n                    const items = Array.from(doc.querySelectorAll('[data-share-repeater-item]'));\n                    const activeLabels = items\n                        .filter((item) => {\n                            const enabledField = item.querySelector('[data-share-field=\"enabled\"]');\n                            return enabledField ? enabledField.checked : false;\n                        })\n                        .map((item) => {\n                            const labelField = item.querySelector('[data-share-field=\"label\"]');\n                            const keyField = item.querySelector('[data-share-field=\"key\"]');\n                            const labelValue = labelField && labelField.value ? labelField.value.trim() : '';\n                            const keyValue = keyField && keyField.value ? keyField.value.trim() : '';\n\n                            return labelValue || (keyValue ? keyValue.toUpperCase() : mgaAdmin__('Canal sans titre', 'lightbox-jlg'));\n                        });\n\n                    if (activeLabels.length > 0) {\n                        shareTarget.textContent = mgaAdminSprintf(\n                            mgaAdmin__('%1$d canaux actifs : %2$s', 'lightbox-jlg'),\n                            activeLabels.length,\n                            activeLabels.join(', ')\n                        );\n                    } else {\n                        shareTarget.textContent = mgaAdmin__('Aucun canal actif', 'lightbox-jlg');\n                    }\n                };\n\n                const collectValidations = () => {\n                    if (!contrastInspector || typeof contrastInspector.readAudit !== 'function') {\n                        return [];\n                    }\n\n                    const audit = contrastInspector.readAudit();\n\n                    if (!audit || !Array.isArray(audit.entries)) {\n                        return [];\n                    }\n\n                    return audit.entries\n                        .filter((entry) => entry && (entry.severity === 'warning' || entry.severity === 'error'))\n                        .map((entry) => {\n                            const message = entry.severity === 'error'\n                                ? mgaAdminSprintf(\n                                    mgaAdmin__('Contraste %1$s insuffisant\u00A0: %2$s. Ajustez la couleur ou le fond pour atteindre au moins 3,0 (AA\u00A0\u2265\u00A04,5).', 'lightbox-jlg'),\n                                    entry.label,\n                                    entry.ratioText\n                                )\n                                : mgaAdminSprintf(\n                                    mgaAdmin__('Contraste %1$s limit\u00E9\u00A0: %2$s. Augmentez l\u00E9g\u00E8rement pour viser AA (\u2265\u00A04,5).', 'lightbox-jlg'),\n                                    entry.label,\n                                    entry.ratioText\n                                );\n\n                            return {\n                                severity: entry.severity,\n                                message,\n                            };\n                        });\n                };\n\n                const renderValidations = (validations) => {\n                    if (!validationContainer) {\n                        return;\n                    }\n\n                    validationContainer.innerHTML = '';\n\n                    if (!validations || validations.length === 0) {\n                        validationContainer.setAttribute('hidden', 'hidden');\n                        return;\n                    }\n\n                    validationContainer.removeAttribute('hidden');\n\n                    validations.forEach((validation) => {\n                        const alert = doc.createElement('div');\n                        alert.className = 'mga-summary__alert';\n                        alert.setAttribute('data-mga-severity', validation.severity);\n                        alert.textContent = validation.message;\n                        validationContainer.appendChild(alert);\n                    });\n                };\n\n                const renderPresetDiff = (diff, baselineInfo) => {\n                    if (!diffContainer || !diffList) {\n                        return;\n                    }\n\n                    diffList.innerHTML = '';\n\n                    if (!diff || diff.length === 0) {\n                        diffContainer.setAttribute('hidden', 'hidden');\n\n                        if (diffBaseline) {\n                            diffBaseline.textContent = '';\n                        }\n\n                        if (diffEmpty) {\n                            diffEmpty.setAttribute('hidden', 'hidden');\n                        }\n\n                        return;\n                    }\n\n                    diffContainer.removeAttribute('hidden');\n\n                    if (diffBaseline) {\n                        diffBaseline.textContent = baselineInfo && baselineInfo.label\n                            ? mgaAdminSprintf(mgaAdmin__('Base\u00A0: %1$s', 'lightbox-jlg'), baselineInfo.label)\n                            : '';\n                    }\n\n                    if (diffEmpty) {\n                        diffEmpty.setAttribute('hidden', 'hidden');\n                    }\n\n                    diff.forEach((item) => {\n                        const row = doc.createElement('li');\n                        row.className = 'mga-summary__diff-item';\n\n                        const label = doc.createElement('span');\n                        label.className = 'mga-summary__diff-label';\n                        label.textContent = item.label;\n                        row.appendChild(label);\n\n                        const values = doc.createElement('span');\n                        values.className = 'mga-summary__diff-values';\n\n                        const beforeValue = doc.createElement('span');\n                        beforeValue.className = 'mga-summary__diff-before';\n                        beforeValue.textContent = item.baselineLabel;\n                        values.appendChild(beforeValue);\n\n                        const arrow = doc.createElement('span');\n                        arrow.textContent = '\u2192';\n                        values.appendChild(arrow);\n\n                        const afterValue = doc.createElement('span');\n                        afterValue.className = 'mga-summary__diff-after';\n                        afterValue.textContent = item.currentLabel;\n                        values.appendChild(afterValue);\n\n                        row.appendChild(values);\n                        diffList.appendChild(row);\n                    });\n                };\n\n                const update = () => {\n                    const diff = presetDiffTracker ? presetDiffTracker.refresh() : [];\n                    const baselineInfo = presetDiffTracker ? presetDiffTracker.getBaselineInfo() : { label: '', key: '' };\n                    const validations = collectValidations();\n\n                    renderPresetSummary(diff, baselineInfo);\n                    renderTimingSummary();\n                    renderToolbarSummary();\n                    renderShareSummary();\n                    renderPresetDiff(diff, baselineInfo);\n                    renderValidations(validations);\n                    renderScoreboard(evaluateScoreboard(validations, diff, baselineInfo));\n                };\n\n                return () => {\n                    if (timeoutId) {\n                        global.clearTimeout(timeoutId);\n                    }\n\n                    timeoutId = global.setTimeout(() => {\n                        timeoutId = null;\n                        update();\n                    }, 120);\n                };\n            })();\n\n            const goToStep = (targetIndex) => {\n                const normalizedIndex = Math.max(0, Math.min(stepPanels.length - 1, targetIndex));\n\n                if (normalizedIndex === currentIndex) {\n                    return;\n                }\n\n                const currentPanel = stepPanels[currentIndex];\n                const nextPanel = stepPanels[normalizedIndex];\n\n                if (currentPanel) {\n                    deactivatePanel(currentPanel);\n                }\n\n                if (nextPanel) {\n                    activatePanel(nextPanel);\n                    focusPanel(nextPanel);\n                }\n\n                currentIndex = normalizedIndex;\n                updateIndicators();\n                updateControls();\n\n                if (currentIndex === summaryIndex) {\n                    updateSummaryContainers();\n                }\n            };\n\n            const handleNext = () => {\n                if (targetForm && typeof targetForm.reportValidity === 'function' && !targetForm.reportValidity()) {\n                    return;\n                }\n\n                goToStep(currentIndex + 1);\n            };\n\n            const handlePrev = () => {\n                goToStep(currentIndex - 1);\n            };\n\n            const attachIndicatorNavigation = () => {\n                indicators.forEach((indicator, index) => {\n                    indicator.addEventListener('click', (event) => {\n                        event.preventDefault();\n\n                        if (index < currentIndex && index >= 0) {\n                            goToStep(index);\n                        } else if (index > currentIndex && index <= summaryIndex) {\n                            if (targetForm && typeof targetForm.reportValidity === 'function' && !targetForm.reportValidity()) {\n                                return;\n                            }\n\n                            goToStep(index);\n                        }\n                    });\n                });\n            };\n\n            if (prevButton) {\n                prevButton.addEventListener('click', (event) => {\n                    event.preventDefault();\n                    handlePrev();\n                });\n            }\n\n            if (nextButton) {\n                nextButton.addEventListener('click', (event) => {\n                    event.preventDefault();\n                    handleNext();\n                });\n            }\n\n            attachIndicatorNavigation();\n            updateIndicators();\n            updateControls();\n\n            if (currentIndex === summaryIndex) {\n                updateSummaryContainers();\n            }\n\n            const handleFormInput = () => {\n                updateSummaryContainers();\n            };\n\n            if (targetForm) {\n                targetForm.addEventListener('change', handleFormInput);\n                targetForm.addEventListener('input', handleFormInput);\n            }\n\n            return {\n                scheduleSummaryUpdate: updateSummaryContainers,\n                setStatusMessage,\n                goToSummary: () => goToStep(summaryIndex),\n            };\n        };\n\n        const wizardApi = initializeWizard(form);\n\n        if (wizardApi && typeof wizardApi.scheduleSummaryUpdate === 'function') {\n            scheduleSummaryRefresh = wizardApi.scheduleSummaryUpdate;\n        }\n\n        const initializeAsyncSave = (targetForm, wizard) => {\n            if (!targetForm) {\n                return;\n            }\n\n            const config = global.mgaAdminConfig || {};\n            const ajaxUrl = typeof config.ajaxUrl === 'string' && config.ajaxUrl ? config.ajaxUrl : global.ajaxurl;\n            const nonce = typeof config.nonce === 'string' ? config.nonce : '';\n            const submitButton = targetForm.querySelector('[data-mga-step-submit]');\n\n            if (!ajaxUrl || !nonce) {\n                return;\n            }\n\n            const setStatus = (state, explicitMessage) => {\n                if (wizard && typeof wizard.setStatusMessage === 'function') {\n                    wizard.setStatusMessage(state, explicitMessage);\n                }\n            };\n\n            const setSavingState = (isSaving) => {\n                if (submitButton) {\n                    submitButton.disabled = isSaving;\n                    submitButton.setAttribute('aria-busy', isSaving ? 'true' : 'false');\n                }\n\n                if (isSaving) {\n                    setStatus('saving');\n                }\n            };\n\n            targetForm.addEventListener('submit', (event) => {\n                event.preventDefault();\n\n                if (typeof targetForm.reportValidity === 'function' && !targetForm.reportValidity()) {\n                    return;\n                }\n\n                const formData = new FormData(targetForm);\n                formData.append('action', 'mga_save_settings');\n                formData.append('_ajax_nonce', nonce);\n\n                setSavingState(true);\n\n                fetch(ajaxUrl, {\n                    method: 'POST',\n                    credentials: 'same-origin',\n                    body: formData,\n                })\n                    .then((response) => {\n                        if (!response.ok) {\n                            throw new Error(response.statusText || 'HTTP error');\n                        }\n\n                        return response.json();\n                    })\n                    .then((payload) => {\n                        if (!payload || payload.success !== true) {\n                            const message = payload && payload.data && payload.data.message\n                                ? payload.data.message\n                                : null;\n\n                            throw new Error(message || (config.messages && config.messages.error) || mgaAdmin__('Impossible d\u2019enregistrer les r\u00E9glages.', 'lightbox-jlg'));\n                        }\n\n                        const successMessage = payload.data && payload.data.message\n                            ? payload.data.message\n                            : (config.messages && config.messages.success) || mgaAdmin__('R\u00E9glages enregistr\u00E9s.', 'lightbox-jlg');\n\n                        setStatus('success', successMessage);\n                        scheduleSummaryRefresh();\n                    })\n                    .catch((error) => {\n                        const fallbackMessage = (config.messages && config.messages.error)\n                            ? config.messages.error\n                            : mgaAdmin__('Impossible d\u2019enregistrer les r\u00E9glages.', 'lightbox-jlg');\n\n                        setStatus('error', error && error.message ? error.message : fallbackMessage);\n                    })\n                    .finally(() => {\n                        setSavingState(false);\n                    });\n            });\n        };\n\n        initializeAsyncSave(form, wizardApi);\n\n        const initSettingsNavigation = () => {\n            const noopApi = {\n                setSectionModified: () => {},\n            };\n\n            const layout = doc.querySelector('[data-mga-settings-layout]');\n\n            if (!layout) {\n                return noopApi;\n            }\n\n            const sections = Array.from(layout.querySelectorAll('[data-mga-settings-section]'));\n\n            if (sections.length === 0) {\n                return noopApi;\n            }\n\n            const navList = layout.querySelector('[data-mga-settings-nav]');\n            const navLinks = navList ? Array.from(navList.querySelectorAll('[data-mga-section-link]')) : [];\n            const linkBySection = new Map();\n            const navItemBySection = new Map();\n            const navBadgeBySection = new Map();\n            const viewToggle = layout.querySelector('[data-mga-view-toggle]');\n            const viewSelect = viewToggle ? viewToggle.querySelector('[data-mga-view-select]') : null;\n            const VIEW_STORAGE_KEY = 'mga-settings-view-mode';\n\n            const readStoredViewMode = () => {\n                if (typeof global.localStorage === 'undefined') {\n                    return 'essential';\n                }\n\n                try {\n                    const stored = global.localStorage.getItem(VIEW_STORAGE_KEY);\n                    return stored === 'advanced' ? 'advanced' : 'essential';\n                } catch (error) {\n                    return 'essential';\n                }\n            };\n\n            let currentViewMode = readStoredViewMode();\n\n            const syncViewSelect = () => {\n                if (viewSelect) {\n                    viewSelect.value = currentViewMode;\n                }\n            };\n\n            const persistViewMode = () => {\n                if (typeof global.localStorage === 'undefined') {\n                    return;\n                }\n\n                try {\n                    global.localStorage.setItem(VIEW_STORAGE_KEY, currentViewMode);\n                } catch (error) {\n                    // Ignore storage access restrictions.\n                }\n            };\n\n            const updateLayoutViewMode = () => {\n                layout.setAttribute('data-mga-view-mode', currentViewMode);\n            };\n\n            const getSectionVisibility = (section) => {\n                if (!section) {\n                    return 'advanced';\n                }\n\n                const visibility = section.getAttribute('data-mga-visibility');\n                return visibility === 'essential' ? 'essential' : 'advanced';\n            };\n\n            const searchInput = layout.querySelector('[data-mga-settings-search]');\n            const emptyState = layout.querySelector('[data-mga-search-empty]');\n            const highlightTimeouts = new WeakMap();\n\n            const isSearchActive = () => layout.getAttribute('data-mga-search-active') === 'true';\n\n            const updateEmptyState = (visibleCount, searchActive) => {\n                if (!emptyState) {\n                    return;\n                }\n\n                if (searchActive && visibleCount === 0) {\n                    emptyState.removeAttribute('hidden');\n                } else {\n                    emptyState.setAttribute('hidden', 'hidden');\n                }\n            };\n\n            const setActiveLink = (section) => {\n                if (!section) {\n                    return;\n                }\n\n                linkBySection.forEach((link, candidate) => {\n                    if (candidate === section) {\n                        link.setAttribute('aria-current', 'true');\n                    } else {\n                        link.removeAttribute('aria-current');\n                    }\n                });\n            };\n\n            const clearHighlights = () => {\n                sections.forEach((section) => {\n                    section.removeAttribute('data-mga-section-highlight');\n\n                    if (highlightTimeouts.has(section)) {\n                        global.clearTimeout(highlightTimeouts.get(section));\n                        highlightTimeouts.delete(section);\n                    }\n                });\n            };\n\n            const highlightSection = (section) => {\n                if (!section) {\n                    return;\n                }\n\n                section.setAttribute('data-mga-section-highlight', 'true');\n\n                if (highlightTimeouts.has(section)) {\n                    global.clearTimeout(highlightTimeouts.get(section));\n                }\n\n                const timeoutId = global.setTimeout(() => {\n                    section.removeAttribute('data-mga-section-highlight');\n                    highlightTimeouts.delete(section);\n                }, 1600);\n\n                highlightTimeouts.set(section, timeoutId);\n            };\n\n            const filterSections = (rawQuery) => {\n                const query = typeof rawQuery === 'string' ? rawQuery.trim().toLowerCase() : '';\n                const searchActive = query.length > 0;\n                let visibleCount = 0;\n\n                if (searchActive) {\n                    layout.setAttribute('data-mga-search-active', 'true');\n                } else {\n                    layout.removeAttribute('data-mga-search-active');\n                    clearHighlights();\n                }\n\n                sections.forEach((section) => {\n                    const link = linkBySection.get(section);\n                    const navItem = navItemBySection.get(section);\n\n                    if (!searchActive) {\n                        const hide = currentViewMode === 'essential' && getSectionVisibility(section) === 'advanced';\n\n                        if (hide) {\n                            section.setAttribute('hidden', 'hidden');\n\n                            if (link) {\n                                link.setAttribute('hidden', 'hidden');\n                                link.removeAttribute('aria-current');\n                            }\n\n                            if (navItem) {\n                                navItem.setAttribute('hidden', 'hidden');\n                            }\n\n                            return;\n                        }\n\n                        section.removeAttribute('hidden');\n\n                        if (link) {\n                            link.removeAttribute('hidden');\n                        }\n\n                        if (navItem) {\n                            navItem.removeAttribute('hidden');\n                        }\n\n                        return;\n                    }\n\n                    const text = (section.textContent || '').toLowerCase();\n                    const isMatch = text.includes(query);\n\n                    if (isMatch) {\n                        section.removeAttribute('hidden');\n                        section.setAttribute('data-mga-section-highlight', 'true');\n                        visibleCount += 1;\n\n                        if (link) {\n                            link.removeAttribute('hidden');\n                        }\n\n                        if (navItem) {\n                            navItem.removeAttribute('hidden');\n                        }\n                    } else {\n                        section.setAttribute('hidden', 'hidden');\n                        section.removeAttribute('data-mga-section-highlight');\n\n                        if (link) {\n                            link.setAttribute('hidden', 'hidden');\n                            link.removeAttribute('aria-current');\n                        }\n\n                        if (navItem) {\n                            navItem.setAttribute('hidden', 'hidden');\n                        }\n                    }\n                });\n\n                if (searchActive) {\n                    const firstMatch = sections.find((section) => !section.hasAttribute('hidden'));\n\n                    if (firstMatch) {\n                        setActiveLink(firstMatch);\n                    }\n                }\n\n                updateEmptyState(visibleCount, searchActive);\n            };\n\n            const applyViewMode = (nextMode, options = {}) => {\n                const normalized = nextMode === 'advanced' ? 'advanced' : 'essential';\n\n                if (normalized === currentViewMode && !options.force) {\n                    return;\n                }\n\n                currentViewMode = normalized;\n                syncViewSelect();\n                updateLayoutViewMode();\n\n                if (options.persist !== false) {\n                    persistViewMode();\n                }\n\n                const currentQuery = searchInput ? searchInput.value || '' : '';\n                filterSections(currentQuery);\n            };\n\n            navLinks.forEach((link) => {\n                const href = link.getAttribute('href');\n\n                if (!href || href.charAt(0) !== '#') {\n                    return;\n                }\n\n                const target = layout.querySelector(href);\n\n                if (!target) {\n                    return;\n                }\n\n                linkBySection.set(target, link);\n                const navItem = link.closest('[data-mga-visibility]');\n\n                if (navItem) {\n                    navItemBySection.set(target, navItem);\n\n                    let badge = navItem.querySelector('[data-mga-modified-badge]');\n\n                    if (!badge) {\n                        badge = doc.createElement('span');\n                        badge.className = 'mga-settings-layout__badge';\n                        badge.textContent = mgaAdmin__('Modifi\u00E9', 'lightbox-jlg');\n                        badge.hidden = true;\n                        badge.setAttribute('data-mga-modified-badge', 'true');\n                        navItem.appendChild(badge);\n                    }\n\n                    navBadgeBySection.set(target, badge);\n                }\n\n                link.addEventListener('click', (event) => {\n                    event.preventDefault();\n\n                    if (target.hasAttribute('hidden')) {\n                        target.removeAttribute('hidden');\n                    }\n\n                    try {\n                        target.scrollIntoView({ behavior: 'smooth', block: 'start' });\n                    } catch (error) {\n                        if (typeof target.scrollIntoView === 'function') {\n                            target.scrollIntoView();\n                        }\n                    }\n\n                    setActiveLink(target);\n                    highlightSection(target);\n\n                    const focusOptions = detectFocusOptionsSupport() ? { preventScroll: true } : undefined;\n\n                    if (typeof global.requestAnimationFrame === 'function') {\n                        global.requestAnimationFrame(() => {\n                            safeFocus(target, focusOptions);\n                        });\n                    } else {\n                        safeFocus(target, focusOptions);\n                    }\n                });\n            });\n\n            syncViewSelect();\n            updateLayoutViewMode();\n\n            if (viewSelect) {\n                viewSelect.addEventListener('change', (event) => {\n                    applyViewMode(event.target.value || 'essential');\n                });\n            }\n\n            if ('IntersectionObserver' in global) {\n                let lastVisibleSection = null;\n\n                const observer = new IntersectionObserver((entries) => {\n                    if (isSearchActive()) {\n                        return;\n                    }\n\n                    entries.forEach((entry) => {\n                        if (entry.isIntersecting) {\n                            lastVisibleSection = entry.target;\n                        }\n                    });\n\n                    if (lastVisibleSection) {\n                        setActiveLink(lastVisibleSection);\n                    }\n                }, {\n                    rootMargin: '-40% 0px -40% 0px',\n                    threshold: 0.1,\n                });\n\n                sections.forEach((section) => observer.observe(section));\n            } else {\n                const handleScroll = () => {\n                    if (isSearchActive()) {\n                        return;\n                    }\n\n                    let bestSection = null;\n                    let bestOffset = Infinity;\n                    const scrollY = global.pageYOffset || doc.documentElement.scrollTop || 0;\n\n                    sections.forEach((section) => {\n                        const rect = section.getBoundingClientRect();\n                        const absoluteTop = rect.top + scrollY;\n                        const delta = Math.abs(absoluteTop - scrollY - 140);\n\n                        if (delta < bestOffset) {\n                            bestSection = section;\n                            bestOffset = delta;\n                        }\n                    });\n\n                    if (bestSection) {\n                        setActiveLink(bestSection);\n                    }\n                };\n\n                global.addEventListener('scroll', handleScroll, { passive: true });\n                handleScroll();\n            }\n\n            if (searchInput) {\n                searchInput.addEventListener('input', (event) => {\n                    filterSections(event.target.value || '');\n                });\n\n                filterSections(searchInput.value || '');\n            } else {\n                updateEmptyState(sections.length, false);\n            }\n\n            applyViewMode(currentViewMode, { force: true, persist: false });\n\n            if (!isSearchActive()) {\n                setActiveLink(sections[0]);\n            }\n\n            return {\n                setSectionModified(section, isModified) {\n                    if (!section) {\n                        return;\n                    }\n\n                    const badge = navBadgeBySection.get(section);\n                    const navItem = navItemBySection.get(section);\n\n                    if (badge) {\n                        badge.hidden = !isModified;\n                    }\n\n                    if (navItem) {\n                        if (isModified) {\n                            navItem.setAttribute('data-mga-modified', 'true');\n                        } else {\n                            navItem.removeAttribute('data-mga-modified');\n                        }\n                    }\n                },\n            };\n        };\n\n        const navigationApi = initSettingsNavigation();\n\n        // Live update for range sliders\n        const bindRangeToOutput = (sliderId, outputId, displayFormatter, ariaFormatter) => {\n            const slider = doc.getElementById(sliderId);\n            const output = doc.getElementById(outputId);\n\n            if (!slider || !output) {\n                return;\n            }\n\n            const updateOutput = () => {\n                const value = slider.value;\n                const displayValue = typeof displayFormatter === 'function'\n                    ? displayFormatter(value)\n                    : value;\n                const ariaValue = typeof ariaFormatter === 'function'\n                    ? ariaFormatter(value)\n                    : displayValue;\n\n                if (typeof output.value !== 'undefined') {\n                    output.value = displayValue;\n                }\n\n                output.textContent = displayValue;\n                slider.setAttribute('aria-valuenow', value);\n                slider.setAttribute('aria-valuetext', ariaValue);\n            };\n\n            slider.addEventListener('input', updateOutput);\n            updateOutput();\n        };\n\n        bindRangeToOutput(\n            'mga_thumb_size',\n            'mga_thumb_size_value',\n            (value) => mgaAdminSprintf(mgaAdmin__('%spx', 'lightbox-jlg'), value),\n            (value) => mgaAdminSprintf(mgaAdmin__('%s pixels', 'lightbox-jlg'), value)\n        );\n\n        bindRangeToOutput(\n            'mga_thumb_size_mobile',\n            'mga_thumb_size_mobile_value',\n            (value) => mgaAdminSprintf(mgaAdmin__('%spx', 'lightbox-jlg'), value),\n            (value) => mgaAdminSprintf(mgaAdmin__('%s pixels', 'lightbox-jlg'), value)\n        );\n\n        bindRangeToOutput(\n            'mga_bg_opacity',\n            'mga_bg_opacity_value',\n            (value) => value,\n            (value) => mgaAdminSprintf(mgaAdmin__('%s opacity', 'lightbox-jlg'), value)\n        );\n\n        const accentColorInput = doc.getElementById('mga_accent_color');\n        const accentColorPreview = doc.getElementById('mga_accent_color_preview');\n\n        if (accentColorInput) {\n            const defaultColorAttr = accentColorInput.getAttribute('data-default-color');\n            const fallbackColor = isValidHexColor(defaultColorAttr) ? defaultColorAttr : '#ffffff';\n\n            const applyPreviewColor = (rawColor) => {\n                const color = isValidHexColor(rawColor) ? rawColor : fallbackColor;\n\n                if (accentColorPreview) {\n                    accentColorPreview.style.backgroundColor = color;\n                }\n\n                return color;\n            };\n\n            applyPreviewColor(accentColorInput.value);\n\n            const maybeJQuery = global.jQuery;\n\n            if (maybeJQuery && typeof maybeJQuery.fn === 'object' && typeof maybeJQuery.fn.wpColorPicker === 'function') {\n                maybeJQuery(accentColorInput).wpColorPicker({\n                    change(event, ui) {\n                        const colorValue = ui && ui.color ? ui.color.toString() : event.target.value;\n                        applyPreviewColor(colorValue);\n                    },\n                    clear() {\n                        const defaultColor = accentColorInput.getAttribute('data-default-color') || fallbackColor;\n                        maybeJQuery(accentColorInput).val(defaultColor);\n                        applyPreviewColor(defaultColor);\n                    },\n                });\n\n                maybeJQuery(accentColorInput).on('input', (event) => {\n                    applyPreviewColor(event.target.value);\n                });\n            } else {\n                accentColorInput.addEventListener('input', () => {\n                    applyPreviewColor(accentColorInput.value);\n                });\n            }\n        }\n\n        contrastInspector = createContrastInspector();\n\n        const initLivePreview = () => {\n            const previewContainer = doc.querySelector('[data-mga-live-preview]');\n\n            if (!previewContainer) {\n                return;\n            }\n\n            const previewMock = previewContainer.querySelector('[data-mga-live-preview-mock]');\n            const effectLabel = previewContainer.querySelector('[data-mga-preview-effect]');\n            const thumbsContainer = previewContainer.querySelector('[data-mga-preview-thumbs]');\n            const statusRegion = previewContainer.querySelector('[data-mga-preview-status]');\n            const fallbackMessage = previewContainer.querySelector('[data-mga-preview-fallback]');\n            const mainSwiperEl = previewContainer.querySelector('[data-mga-preview-swiper]');\n            const paginationEl = previewContainer.querySelector('[data-mga-preview-pagination]');\n            const nextButton = previewContainer.querySelector('[data-mga-preview-next]');\n            const prevButton = previewContainer.querySelector('[data-mga-preview-prev]');\n\n            const toolbarActions = {\n                zoom: Array.from(previewContainer.querySelectorAll('[data-preview-action=\"zoom\"]')),\n                download: Array.from(previewContainer.querySelectorAll('[data-preview-action=\"download\"]')),\n                share: Array.from(previewContainer.querySelectorAll('[data-preview-action=\"share\"]')),\n                cta: Array.from(previewContainer.querySelectorAll('[data-preview-action=\"cta\"]')),\n                fullscreen: Array.from(previewContainer.querySelectorAll('[data-preview-action=\"fullscreen\"]')),\n            };\n\n            let previewSwiper = null;\n\n            const shouldAnnounce = (event) => {\n                if (!event || typeof event !== 'object') {\n                    return false;\n                }\n\n                if (event.type === 'init') {\n                    return false;\n                }\n\n                return event.type !== 'input';\n            };\n\n            const announce = (message) => {\n                if (!statusRegion || typeof message !== 'string' || message.trim() === '') {\n                    return;\n                }\n\n                statusRegion.textContent = message;\n            };\n\n            const setPreviewState = (state) => {\n                if (!previewContainer) {\n                    return;\n                }\n\n                previewContainer.setAttribute('data-mga-preview-state', state);\n            };\n\n            const showFallback = (message) => {\n                setPreviewState('error');\n\n                if (fallbackMessage) {\n                    fallbackMessage.hidden = false;\n\n                    if (typeof message === 'string' && message.trim() !== '') {\n                        fallbackMessage.textContent = message;\n                    }\n                }\n\n                if (message) {\n                    announce(message);\n                }\n            };\n\n            const destroyPreviewSwiper = () => {\n                if (previewSwiper && typeof previewSwiper.destroy === 'function') {\n                    previewSwiper.destroy(true, true);\n                }\n\n                previewSwiper = null;\n            };\n\n            const parseNumber = (value, fallbackValue) => {\n                const numeric = typeof value === 'number' ? value : parseFloat(value);\n\n                if (Number.isNaN(numeric)) {\n                    return fallbackValue;\n                }\n\n                return numeric;\n            };\n\n            const buildSwiperConfig = () => {\n                const effectSelect = doc.getElementById('mga_effect');\n                const delayInput = doc.getElementById('mga_delay');\n                const speedInput = doc.getElementById('mga_speed');\n                const effectValue = effectSelect ? effectSelect.value : 'slide';\n                const delaySeconds = parseNumber(delayInput ? delayInput.value : null, 4);\n                const speedValue = parseNumber(speedInput ? speedInput.value : null, 600);\n\n                const autoplayDelay = Math.max(Math.round(delaySeconds * 1000), 1000);\n                const speed = Math.max(Math.round(speedValue), 100);\n\n                const config = {\n                    allowTouchMove: false,\n                    simulateTouch: false,\n                    centeredSlides: true,\n                    effect: effectValue || 'slide',\n                    loop: true,\n                    slidesPerView: 1,\n                    speed,\n                };\n\n                if (paginationEl) {\n                    config.pagination = {\n                        el: paginationEl,\n                        clickable: false,\n                    };\n                }\n\n                if (nextButton && prevButton) {\n                    config.navigation = {\n                        nextEl: nextButton,\n                        prevEl: prevButton,\n                    };\n                }\n\n                if (!Number.isNaN(autoplayDelay) && autoplayDelay > 0) {\n                    config.autoplay = {\n                        delay: autoplayDelay,\n                        disableOnInteraction: false,\n                    };\n                }\n\n                if (config.effect === 'fade') {\n                    config.fadeEffect = { crossFade: true };\n                }\n\n                config.on = {\n                    init(swiper) {\n                        if (swiper && typeof swiper.slideToLoop === 'function') {\n                            swiper.slideToLoop(0, 0, false);\n                        }\n                    },\n                };\n\n                return config;\n            };\n\n            const rebuildPreviewSwiper = () => {\n                if (!mainSwiperEl || typeof global.Swiper !== 'function') {\n                    return;\n                }\n\n                destroyPreviewSwiper();\n\n                try {\n                    previewSwiper = new global.Swiper(mainSwiperEl, buildSwiperConfig());\n                    setPreviewState('ready');\n                } catch (error) {\n                    showFallback(mgaAdmin__('Impossible d\u2019initialiser l\u2019aper\u00E7u Swiper.', 'lightbox-jlg'));\n                }\n            };\n\n            if (!mainSwiperEl) {\n                showFallback(mgaAdmin__('Pr\u00E9visualisation indisponible\u00A0: conteneur Swiper manquant.', 'lightbox-jlg'));\n            } else {\n                if (fallbackMessage) {\n                    fallbackMessage.hidden = true;\n                }\n\n                setPreviewState('loading');\n                announce(mgaAdmin__('Pr\u00E9paration de la pr\u00E9visualisation\u2026', 'lightbox-jlg'));\n\n                ensureSwiper(global, { namespace: 'admin-preview' })\n                    .then(() => {\n                        rebuildPreviewSwiper();\n                        if (previewSwiper && typeof previewSwiper.update === 'function') {\n                            previewSwiper.update();\n                        }\n                        announce(mgaAdmin__('Pr\u00E9visualisation pr\u00EAte.', 'lightbox-jlg'));\n                    })\n                    .catch(() => {\n                        showFallback(mgaAdmin__('Impossible de charger Swiper. La pr\u00E9visualisation interactive est d\u00E9sactiv\u00E9e.', 'lightbox-jlg'));\n                    });\n            }\n\n            const setAccent = (value, _element, event) => {\n                if (!previewMock) {\n                    return;\n                }\n\n                const color = isValidHexColor(value) ? value : '#6366f1';\n                previewMock.style.setProperty('--mga-preview-accent', color);\n\n                if (shouldAnnounce(event)) {\n                    announce(mgaAdmin__('Couleur d\u2019accent mise \u00E0 jour.', 'lightbox-jlg'));\n                }\n            };\n\n            const setOverlay = (value, _element, event) => {\n                if (!previewMock) {\n                    return;\n                }\n\n                const numeric = parseFloat(value);\n\n                if (Number.isNaN(numeric)) {\n                    return;\n                }\n\n                const clamped = Math.min(Math.max(numeric, 0), 1);\n                previewMock.style.setProperty('--mga-preview-overlay', `rgba(15, 23, 42, ${clamped})`);\n\n                if (shouldAnnounce(event)) {\n                    announce(mgaAdmin__('Opacit\u00E9 de l\u2019arri\u00E8re-plan mise \u00E0 jour.', 'lightbox-jlg'));\n                }\n            };\n\n            const setBackgroundStyle = (style, _element, event) => {\n                if (!previewMock) {\n                    return;\n                }\n\n                const normalized = typeof style === 'string' && style ? style : 'echo';\n                previewMock.setAttribute('data-preview-style', normalized);\n\n                if (shouldAnnounce(event)) {\n                    announce(mgaAdmin__('Style d\u2019arri\u00E8re-plan actualis\u00E9.', 'lightbox-jlg'));\n                }\n            };\n\n            const toggleAction = (name, enabled, _element, event) => {\n                const actions = toolbarActions[name] || [];\n\n                actions.forEach((action) => {\n                    action.setAttribute('data-preview-hidden', enabled ? 'false' : 'true');\n                    action.setAttribute('aria-hidden', enabled ? 'false' : 'true');\n                });\n\n                if (shouldAnnounce(event)) {\n                    const label = {\n                        zoom: mgaAdmin__('Zoom', 'lightbox-jlg'),\n                        download: mgaAdmin__('T\u00E9l\u00E9chargement', 'lightbox-jlg'),\n                        share: mgaAdmin__('Partage', 'lightbox-jlg'),\n                        cta: mgaAdmin__('Appel \u00E0 l\u2019action', 'lightbox-jlg'),\n                        fullscreen: mgaAdmin__('Plein \u00E9cran', 'lightbox-jlg'),\n                    }[name] || name;\n\n                    announce(mgaAdminSprintf(\n                        enabled\n                            ? mgaAdmin__('%s activ\u00E9 dans l\u2019aper\u00E7u.', 'lightbox-jlg')\n                            : mgaAdmin__('%s masqu\u00E9 dans l\u2019aper\u00E7u.', 'lightbox-jlg'),\n                        label\n                    ));\n                }\n            };\n\n            const setThumbScale = (value, _element, event) => {\n                if (!thumbsContainer) {\n                    return;\n                }\n\n                const numeric = parseFloat(value);\n\n                if (Number.isNaN(numeric)) {\n                    thumbsContainer.style.setProperty('--mga-preview-thumb-scale', '1');\n                } else {\n                    const normalized = Math.min(Math.max(numeric / 90, 0.6), 1.4);\n                    thumbsContainer.style.setProperty('--mga-preview-thumb-scale', normalized.toString());\n                }\n\n                if (shouldAnnounce(event)) {\n                    announce(mgaAdmin__('Taille des miniatures mise \u00E0 jour.', 'lightbox-jlg'));\n                }\n            };\n\n            const updateEffectLabel = (_value, _element, event) => {\n                if (!effectLabel) {\n                    return;\n                }\n\n                const effectSelect = doc.getElementById('mga_effect');\n                const delayInput = doc.getElementById('mga_delay');\n                const speedInput = doc.getElementById('mga_speed');\n                const effectValue = effectSelect ? effectSelect.value : '';\n                const delayValue = delayInput ? delayInput.value || '4' : '4';\n                const speedValue = speedInput ? speedInput.value || '600' : '600';\n                const effectLabelText = EFFECT_LABELS[effectValue] || mgaAdmin__('personnalis\u00E9e', 'lightbox-jlg');\n\n                effectLabel.textContent = mgaAdminSprintf(\n                    mgaAdmin__('Transition : %1$s \u2022 %2$ss / %3$sms', 'lightbox-jlg'),\n                    effectLabelText,\n                    delayValue,\n                    speedValue\n                );\n\n                if (shouldAnnounce(event)) {\n                    announce(mgaAdminSprintf(\n                        mgaAdmin__('Transition mise \u00E0 jour\u00A0: %1$s, rythme de %2$ss.', 'lightbox-jlg'),\n                        effectLabelText,\n                        delayValue\n                    ));\n                }\n\n                rebuildPreviewSwiper();\n            };\n\n            const bindPreviewControl = (id, handler, events = ['change']) => {\n                const element = doc.getElementById(id);\n\n                if (!element || typeof handler !== 'function') {\n                    return;\n                }\n\n                const invoke = (event) => {\n                    const payload = element.type === 'checkbox' ? element.checked : element.value;\n                    handler(payload, element, event || { type: 'init' });\n                };\n\n                events.forEach((eventName) => {\n                    element.addEventListener(eventName, invoke);\n                });\n\n                invoke({ type: 'init' });\n            };\n\n            bindPreviewControl('mga_accent_color', setAccent, ['input', 'change']);\n            bindPreviewControl('mga_bg_opacity', setOverlay, ['input', 'change']);\n            bindPreviewControl('mga_background_style', setBackgroundStyle);\n            bindPreviewControl('mga_thumb_size', setThumbScale, ['input', 'change']);\n            bindPreviewControl('mga_show_zoom', (checked, element, event) => toggleAction('zoom', checked, element, event));\n            bindPreviewControl('mga_show_download', (checked, element, event) => toggleAction('download', checked, element, event));\n            bindPreviewControl('mga_show_share', (checked, element, event) => toggleAction('share', checked, element, event));\n            bindPreviewControl('mga_show_cta', (checked, element, event) => toggleAction('cta', checked, element, event));\n            bindPreviewControl('mga_show_fullscreen', (checked, element, event) => toggleAction('fullscreen', checked, element, event));\n            bindPreviewControl('mga_effect', updateEffectLabel);\n            bindPreviewControl('mga_delay', updateEffectLabel, ['input', 'change']);\n            bindPreviewControl('mga_speed', updateEffectLabel, ['input', 'change']);\n        };\n\n        initLivePreview();\n\n        const stylePresetExport = global.mgaStylePresets && typeof global.mgaStylePresets === 'object'\n            ? global.mgaStylePresets\n            : {};\n        const stylePresets = stylePresetExport.presets && typeof stylePresetExport.presets === 'object'\n            ? stylePresetExport.presets\n            : {};\n        const presetSelect = doc.getElementById('mga_style_preset');\n        const applyPresetButton = doc.querySelector('[data-mga-apply-style-preset]');\n        const resetPresetButton = doc.querySelector('[data-mga-reset-style-preset]');\n        const presetDescription = doc.querySelector('[data-mga-style-preset-description]');\n        let isApplyingPreset = false;\n\n        presetDiffTracker = createPresetDiffTracker(stylePresetExport.defaults || {});\n\n        if (presetDiffTracker && typeof presetDiffTracker.setNavigationApi === 'function') {\n            presetDiffTracker.setNavigationApi(navigationApi);\n        }\n\n        const maybeDispatchEvent = (element, eventType) => {\n            if (!element || typeof element.dispatchEvent !== 'function') {\n                return;\n            }\n\n            try {\n                element.dispatchEvent(new Event(eventType, { bubbles: true }));\n            } catch (error) {\n                if (typeof doc.createEvent === 'function') {\n                    try {\n                        const fallbackEvent = doc.createEvent('Event');\n                        fallbackEvent.initEvent(eventType, true, true);\n                        element.dispatchEvent(fallbackEvent);\n                    } catch (fallbackError) {\n                        // Ignore unsupported event creation paths.\n                    }\n                }\n            }\n        };\n\n        const setNumericInputValue = (id, value) => {\n            const input = doc.getElementById(id);\n\n            if (!input) {\n                return;\n            }\n\n            input.value = value;\n            maybeDispatchEvent(input, 'input');\n            maybeDispatchEvent(input, 'change');\n        };\n\n        const setRangeInputValue = setNumericInputValue;\n\n        const setSelectValue = (id, value) => {\n            const select = doc.getElementById(id);\n\n            if (!select) {\n                return;\n            }\n\n            select.value = value;\n            maybeDispatchEvent(select, 'change');\n        };\n\n        const setCheckboxValue = (id, value) => {\n            const checkbox = doc.getElementById(id);\n\n            if (!checkbox) {\n                return;\n            }\n\n            checkbox.checked = Boolean(value);\n            maybeDispatchEvent(checkbox, 'change');\n        };\n\n        const setAccentColorValue = (value) => {\n            if (!accentColorInput) {\n                return;\n            }\n\n            const targetColor = typeof value === 'string' ? value : '';\n            const maybeJQuery = global.jQuery;\n\n            if (maybeJQuery && typeof maybeJQuery.fn === 'object' && typeof maybeJQuery.fn.wpColorPicker === 'function') {\n                const picker = maybeJQuery(accentColorInput);\n\n                if (picker && typeof picker.wpColorPicker === 'function') {\n                    picker.wpColorPicker('color', targetColor);\n                    if (contrastInspector) {\n                        contrastInspector.update(targetColor);\n                    }\n                    return;\n                }\n            }\n\n            accentColorInput.value = targetColor;\n            maybeDispatchEvent(accentColorInput, 'change');\n\n            if (contrastInspector) {\n                contrastInspector.update(targetColor);\n            }\n        };\n\n        const applyPresetSettings = (settings) => {\n            if (!settings || typeof settings !== 'object') {\n                return;\n            }\n\n            if (Object.prototype.hasOwnProperty.call(settings, 'delay')) {\n                setNumericInputValue('mga_delay', settings.delay);\n            }\n\n            if (Object.prototype.hasOwnProperty.call(settings, 'speed')) {\n                setNumericInputValue('mga_speed', settings.speed);\n            }\n\n            if (Object.prototype.hasOwnProperty.call(settings, 'effect')) {\n                setSelectValue('mga_effect', settings.effect);\n            }\n\n            if (Object.prototype.hasOwnProperty.call(settings, 'easing')) {\n                setSelectValue('mga_easing', settings.easing);\n            }\n\n            if (Object.prototype.hasOwnProperty.call(settings, 'thumbs_layout')) {\n                setSelectValue('mga_thumbs_layout', settings.thumbs_layout);\n            }\n\n            if (Object.prototype.hasOwnProperty.call(settings, 'thumb_size')) {\n                setRangeInputValue('mga_thumb_size', settings.thumb_size);\n            }\n\n            if (Object.prototype.hasOwnProperty.call(settings, 'thumb_size_mobile')) {\n                setRangeInputValue('mga_thumb_size_mobile', settings.thumb_size_mobile);\n            }\n\n            if (Object.prototype.hasOwnProperty.call(settings, 'show_thumbs_mobile')) {\n                setCheckboxValue('mga_show_thumbs_mobile', settings.show_thumbs_mobile);\n            }\n\n            if (Object.prototype.hasOwnProperty.call(settings, 'accent_color')) {\n                setAccentColorValue(settings.accent_color);\n            }\n\n            if (Object.prototype.hasOwnProperty.call(settings, 'bg_opacity')) {\n                setRangeInputValue('mga_bg_opacity', settings.bg_opacity);\n            }\n\n            if (Object.prototype.hasOwnProperty.call(settings, 'background_style')) {\n                setSelectValue('mga_background_style', settings.background_style);\n            }\n\n            if (Object.prototype.hasOwnProperty.call(settings, 'autoplay_start')) {\n                setCheckboxValue('mga_autoplay_start', settings.autoplay_start);\n            }\n\n            if (Object.prototype.hasOwnProperty.call(settings, 'loop')) {\n                setCheckboxValue('mga_loop', settings.loop);\n            }\n\n            if (Object.prototype.hasOwnProperty.call(settings, 'show_zoom')) {\n                setCheckboxValue('mga_show_zoom', settings.show_zoom);\n            }\n\n            if (Object.prototype.hasOwnProperty.call(settings, 'show_download')) {\n                setCheckboxValue('mga_show_download', settings.show_download);\n            }\n\n            if (Object.prototype.hasOwnProperty.call(settings, 'show_share')) {\n                setCheckboxValue('mga_show_share', settings.show_share);\n            }\n\n            if (Object.prototype.hasOwnProperty.call(settings, 'show_cta')) {\n                setCheckboxValue('mga_show_cta', settings.show_cta);\n            }\n\n            if (Object.prototype.hasOwnProperty.call(settings, 'show_fullscreen')) {\n                setCheckboxValue('mga_show_fullscreen', settings.show_fullscreen);\n            }\n        };\n\n        const updatePresetDescription = () => {\n            if (!presetDescription) {\n                return;\n            }\n\n            const key = presetSelect ? presetSelect.value : '';\n\n            if (key && stylePresets[key] && stylePresets[key].description) {\n                presetDescription.textContent = stylePresets[key].description;\n                return;\n            }\n\n            const customDescription = typeof stylePresetExport.customDescription === 'string'\n                ? stylePresetExport.customDescription\n                : '';\n            const baselineInfo = presetDiffTracker ? presetDiffTracker.getBaselineInfo() : { label: '', key: '' };\n            const baselineNote = baselineInfo && baselineInfo.label\n                ? mgaAdminSprintf(mgaAdmin__('Base\u00A0: %1$s.', 'lightbox-jlg'), baselineInfo.label)\n                : '';\n            const segments = [customDescription, baselineNote].filter((segment) => segment && segment.trim() !== '');\n\n            if (segments.length === 0) {\n                presetDescription.textContent = '';\n                return;\n            }\n\n            presetDescription.textContent = segments.join(' ');\n        };\n\n        const markPresetAsCustom = () => {\n            if (isApplyingPreset) {\n                return;\n            }\n\n            if (presetSelect && presetSelect.value !== '') {\n                presetSelect.value = '';\n            }\n\n            updatePresetDescription();\n\n            if (presetDiffTracker && typeof presetDiffTracker.refresh === 'function') {\n                presetDiffTracker.refresh();\n            }\n\n            scheduleSummaryRefresh();\n        };\n\n        const registerPresetWatcher = (id) => {\n            const element = doc.getElementById(id);\n\n            if (!element) {\n                return;\n            }\n\n            const eventNames = ['change'];\n\n            if (element.tagName === 'INPUT' && ['text', 'number', 'range'].includes(element.type)) {\n                eventNames.push('input');\n            }\n\n            eventNames.forEach((eventName) => {\n                element.addEventListener(eventName, markPresetAsCustom);\n            });\n        };\n\n        if (presetSelect) {\n            updatePresetDescription();\n            presetSelect.addEventListener('change', updatePresetDescription);\n        }\n\n        if (presetDiffTracker) {\n            if (presetSelect && presetSelect.value && stylePresets[presetSelect.value]) {\n                const initialPreset = stylePresets[presetSelect.value];\n\n                presetDiffTracker.setBaseline({\n                    key: presetSelect.value,\n                    label: initialPreset.label || presetSelect.options[presetSelect.selectedIndex]?.text || '',\n                    settings: initialPreset.settings || {},\n                });\n            } else {\n                presetDiffTracker.setBaseline({\n                    key: '',\n                    label: presetDiffTracker.getDefaultLabel(),\n                    settings: stylePresetExport.defaults || {},\n                });\n            }\n        }\n\n        if (applyPresetButton) {\n            applyPresetButton.addEventListener('click', (event) => {\n                event.preventDefault();\n\n                if (!presetSelect) {\n                    return;\n                }\n\n                const key = presetSelect.value;\n\n                if (!key || !stylePresets[key]) {\n                    return;\n                }\n\n                isApplyingPreset = true;\n                applyPresetSettings(stylePresets[key].settings || {});\n                if (presetDiffTracker) {\n                    presetDiffTracker.setBaseline({\n                        key,\n                        label: stylePresets[key].label || '',\n                        settings: stylePresets[key].settings || {},\n                    });\n                }\n                isApplyingPreset = false;\n                updatePresetDescription();\n                scheduleSummaryRefresh();\n            });\n        }\n\n        if (resetPresetButton) {\n            resetPresetButton.addEventListener('click', (event) => {\n                event.preventDefault();\n\n                const defaults = stylePresetExport.defaults || {};\n\n                if (defaults && typeof defaults === 'object' && Object.keys(defaults).length > 0) {\n                    isApplyingPreset = true;\n                    applyPresetSettings(defaults);\n                    if (presetDiffTracker) {\n                        presetDiffTracker.setBaseline({\n                            key: '',\n                            label: presetDiffTracker.getDefaultLabel(),\n                            settings: defaults,\n                        });\n                    }\n                    isApplyingPreset = false;\n                }\n\n                if (presetSelect) {\n                    presetSelect.value = '';\n                }\n\n                updatePresetDescription();\n                scheduleSummaryRefresh();\n            });\n        }\n\n        [\n            'mga_delay',\n            'mga_speed',\n            'mga_effect',\n            'mga_easing',\n            'mga_thumb_size',\n            'mga_thumb_size_mobile',\n            'mga_thumbs_layout',\n            'mga_accent_color',\n            'mga_bg_opacity',\n            'mga_background_style',\n            'mga_show_thumbs_mobile',\n            'mga_autoplay_start',\n            'mga_loop',\n            'mga_show_zoom',\n            'mga_show_download',\n            'mga_show_share',\n            'mga_show_cta',\n            'mga_show_fullscreen',\n        ].forEach(registerPresetWatcher);\n\n        const shareRepeater = doc.querySelector('[data-share-repeater]');\n\n        if (shareRepeater) {\n            initShareRepeater(shareRepeater);\n        }\n\n        const selectorsWrapper = doc.querySelector('[data-mga-content-selectors]');\n\n        if (selectorsWrapper) {\n            const selectorsList = selectorsWrapper.querySelector('[data-mga-content-selectors-list]');\n            const selectorsTextarea = selectorsWrapper.querySelector('[data-mga-content-selectors-textarea]');\n            const template = doc.getElementById('mga-content-selector-template');\n            const placeholder = selectorsWrapper.getAttribute('data-mga-selector-placeholder') || '';\n            let isSyncingSelectors = false;\n            let addRow = () => {};\n\n            if (selectorsList) {\n                const queryRows = () => selectorsList.querySelectorAll('[data-mga-content-selector-row]');\n                const queryInputs = () => selectorsList.querySelectorAll('[data-mga-content-selector-input]');\n                const hasEmptyRow = () => Array.from(queryInputs()).some((input) => input.value.trim() === '');\n\n                const updateRemoveState = () => {\n                    const rows = queryRows();\n                    const disable = rows.length <= 1;\n\n                    rows.forEach((row) => {\n                        const removeButton = row.querySelector('[data-mga-remove-selector]');\n\n                        if (removeButton) {\n                            removeButton.disabled = disable;\n                            removeButton.setAttribute('aria-disabled', disable ? 'true' : 'false');\n                        }\n                    });\n                };\n\n                const getRowValues = () => Array.from(queryInputs()).map((input) => input.value.trim()).filter((value) => value !== '');\n\n                const syncTextareaFromRows = () => {\n                    if (!selectorsTextarea || isSyncingSelectors) {\n                        return;\n                    }\n\n                    const values = getRowValues();\n                    isSyncingSelectors = true;\n                    selectorsTextarea.value = values.join('\\n');\n                    isSyncingSelectors = false;\n                };\n\n                const bindRow = (row) => {\n                    if (!row || row.getAttribute('data-mga-selector-bound') === 'true') {\n                        return;\n                    }\n\n                    const removeButton = row.querySelector('[data-mga-remove-selector]');\n\n                    if (removeButton) {\n                        removeButton.addEventListener('click', (event) => {\n                            event.preventDefault();\n                            const rows = queryRows();\n\n                            if (rows.length <= 1) {\n                                const input = row.querySelector('[data-mga-content-selector-input]');\n\n                                if (input) {\n                                    input.value = '';\n                                    syncTextareaFromRows();\n                                }\n\n                                return;\n                            }\n\n                            row.remove();\n                            updateRemoveState();\n                            syncTextareaFromRows();\n                        });\n                    }\n\n                    const input = row.querySelector('[data-mga-content-selector-input]');\n\n                    if (input) {\n                        input.addEventListener('input', () => {\n                            if (!isSyncingSelectors) {\n                                syncTextareaFromRows();\n                            }\n                        });\n\n                        input.addEventListener('keydown', (event) => {\n                            if (event.key !== 'Enter' || event.shiftKey || event.altKey || event.metaKey || event.ctrlKey) {\n                                return;\n                            }\n\n                            event.preventDefault();\n\n                            if (!hasEmptyRow() && typeof addRow === 'function') {\n                                addRow('');\n                                return;\n                            }\n\n                            const rows = queryRows();\n\n                            if (rows.length === 0) {\n                                return;\n                            }\n\n                            const lastRow = rows[rows.length - 1];\n\n                            if (!lastRow) {\n                                return;\n                            }\n\n                            const lastInput = lastRow.querySelector('[data-mga-content-selector-input]');\n\n                            if (lastInput && lastInput !== event.target) {\n                                safeFocus(lastInput);\n                            }\n                        });\n\n                        if (placeholder && !input.getAttribute('placeholder')) {\n                            input.setAttribute('placeholder', placeholder);\n                        }\n                    }\n\n                    row.setAttribute('data-mga-selector-bound', 'true');\n                };\n\n                const createRow = (value = '') => {\n                    let row = null;\n\n                    if (template && template.content) {\n                        const fragment = doc.importNode(template.content, true);\n\n                        row = fragment.firstElementChild;\n                        if (row) {\n                            const input = row.querySelector('[data-mga-content-selector-input]');\n\n                            if (input) {\n                                input.value = value;\n\n                                if (placeholder) {\n                                    input.setAttribute('placeholder', placeholder);\n                                }\n                            }\n\n                            bindRow(row);\n\n                            return row;\n                        }\n                    }\n\n                    row = doc.createElement('div');\n                    row.className = 'mga-content-selectors__row';\n                    row.setAttribute('data-mga-content-selector-row', '');\n\n                    const input = doc.createElement('input');\n                    input.type = 'text';\n                    input.className = 'regular-text';\n                    input.setAttribute('data-mga-content-selector-input', '');\n                    input.value = value;\n\n                    if (placeholder) {\n                        input.setAttribute('placeholder', placeholder);\n                    }\n\n                    row.appendChild(input);\n\n                    const removeButton = doc.createElement('button');\n                    removeButton.type = 'button';\n                    removeButton.className = 'button-link mga-content-selectors__remove';\n                    removeButton.setAttribute('data-mga-remove-selector', '');\n                    removeButton.textContent = mgaAdmin__('Retirer', 'lightbox-jlg');\n                    row.appendChild(removeButton);\n\n                    bindRow(row);\n\n                    return row;\n                };\n\n                const renderRows = (values) => {\n                    selectorsList.innerHTML = '';\n\n                    if (values.length === 0) {\n                        const emptyRow = createRow('');\n                        if (emptyRow) {\n                            selectorsList.appendChild(emptyRow);\n                        }\n                    } else {\n                        values.forEach((value) => {\n                            const row = createRow(value);\n\n                            if (row) {\n                                selectorsList.appendChild(row);\n                            }\n                        });\n                    }\n\n                    updateRemoveState();\n                };\n\n                const syncRowsFromTextarea = () => {\n                    if (!selectorsTextarea || isSyncingSelectors) {\n                        return;\n                    }\n\n                    const values = selectorsTextarea.value\n                        .split(/\\r\\n|\\r|\\n/)\n                        .map((selector) => selector.trim())\n                        .filter((selector) => selector.length > 0);\n\n                    isSyncingSelectors = true;\n                    renderRows(values);\n                    isSyncingSelectors = false;\n                };\n\n                addRow = (value = '') => {\n                    const row = createRow(value);\n\n                    if (row) {\n                        selectorsList.appendChild(row);\n                        updateRemoveState();\n\n                        const input = row.querySelector('[data-mga-content-selector-input]');\n\n                        if (input) {\n                            safeFocus(input);\n                        }\n                    }\n\n                    syncTextareaFromRows();\n                };\n\n                if (selectorsTextarea) {\n                    syncRowsFromTextarea();\n\n                    selectorsTextarea.addEventListener('input', () => {\n                        if (!isSyncingSelectors) {\n                            syncRowsFromTextarea();\n                        }\n                    });\n                } else {\n                    renderRows([]);\n                }\n\n                const addButton = selectorsWrapper.querySelector('[data-mga-add-selector]');\n\n                if (addButton) {\n                    addButton.addEventListener('click', (event) => {\n                        event.preventDefault();\n                        addRow();\n                    });\n                }\n            }\n        }\n        function initShareRepeater(container) {\n            const list = container.querySelector('[data-share-repeater-list]');\n            const addButton = container.querySelector('[data-share-repeater-add]');\n            const template = doc.getElementById('mga-share-channel-template');\n\n            if (!list || !template) {\n                return;\n            }\n\n            let uidSeed = Date.now();\n\n            const generateUid = () => {\n                uidSeed += 1;\n                return `mga-share-channel-${uidSeed}`;\n            };\n\n            const ensureItemUid = (item) => {\n                if (!item) {\n                    return null;\n                }\n\n                if (!item.dataset.shareUid || item.dataset.shareUid.trim() === '') {\n                    item.dataset.shareUid = generateUid();\n                }\n\n                return item.dataset.shareUid;\n            };\n\n            const applyUid = (item) => {\n                const uid = ensureItemUid(item);\n\n                if (!uid) {\n                    return;\n                }\n\n                const idElements = item.querySelectorAll('[data-share-id-suffix]');\n\n                idElements.forEach((element) => {\n                    const suffix = element.getAttribute('data-share-id-suffix');\n\n                    if (!suffix) {\n                        return;\n                    }\n\n                    const id = `${uid}-${suffix}`;\n\n                    if (element.tagName === 'LABEL') {\n                        element.setAttribute('for', id);\n                    } else {\n                        element.id = id;\n                    }\n                });\n            };\n\n            const refreshItemTitle = (item) => {\n                if (!item) {\n                    return;\n                }\n\n                const title = item.querySelector('[data-share-repeater-title]');\n\n                if (!title) {\n                    return;\n                }\n\n                const labelInput = item.querySelector('[data-share-field=\"label\"]');\n                const keyInput = item.querySelector('[data-share-field=\"key\"]');\n                const labelValue = labelInput && typeof labelInput.value === 'string' ? labelInput.value.trim() : '';\n                const keyValue = keyInput && typeof keyInput.value === 'string' ? keyInput.value.trim() : '';\n                const fallback = keyValue ? keyValue.toUpperCase() : mgaAdmin__('Nouveau canal', 'lightbox-jlg');\n\n                title.textContent = labelValue || fallback;\n            };\n\n            const updateIconPreview = (item) => {\n                if (!item) {\n                    return;\n                }\n\n                const preview = item.querySelector('[data-share-icon-preview]');\n                const select = item.querySelector('[data-share-field=\"icon\"]');\n\n                if (!preview) {\n                    return;\n                }\n\n                const iconKey = select ? select.value : '';\n                const iconSvg = createShareIconPreview(iconKey);\n\n                preview.innerHTML = '';\n\n                if (iconSvg) {\n                    preview.appendChild(iconSvg);\n                }\n\n                const summaryIcon = item.querySelector('[data-share-preview-icon]');\n\n                if (summaryIcon) {\n                    summaryIcon.innerHTML = '';\n\n                    const summarySvg = createShareIconPreview(iconKey);\n\n                    if (summarySvg) {\n                        summaryIcon.appendChild(summarySvg);\n                    }\n                }\n            };\n\n            const getShareField = (item, key) => {\n                if (!item || !key) {\n                    return null;\n                }\n\n                return item.querySelector(`[data-share-field=\"${key}\"]`);\n            };\n\n            const getShareFieldValue = (item, key) => {\n                const field = getShareField(item, key);\n                const value = field && typeof field.value === 'string' ? field.value.trim() : '';\n                return value;\n            };\n\n            const buildSharePreviewUrl = (template) => {\n                if (typeof template !== 'string') {\n                    return '';\n                }\n\n                let previewValue = template;\n\n                Object.keys(SHARE_TEMPLATE_PLACEHOLDERS).forEach((token) => {\n                    const replacement = encodeURIComponent(SHARE_TEMPLATE_PLACEHOLDERS[token]);\n                    previewValue = previewValue.replace(new RegExp(token, 'gi'), replacement);\n                });\n\n                return previewValue;\n            };\n\n            const hasRequiredPlaceholder = (template) => /%url%/i.test(typeof template === 'string' ? template : '');\n\n            const isTemplateSchemeValid = (template) => {\n                if (typeof template !== 'string') {\n                    return false;\n                }\n\n                const trimmed = template.trim();\n\n                if (trimmed === '') {\n                    return false;\n                }\n\n                const scheme = trimmed.split(':')[0].toLowerCase();\n\n                if (!SHARE_TEMPLATE_SCHEMES.includes(scheme)) {\n                    return false;\n                }\n\n                if (scheme === 'http' || scheme === 'https') {\n                    return /^https?:\\/\\//i.test(trimmed);\n                }\n\n                return true;\n            };\n\n            const applyFieldError = (field, messageElement, message) => {\n                const hasMessage = typeof message === 'string' && message !== '';\n\n                if (field) {\n                    if (hasMessage) {\n                        field.classList.add('mga-field-error');\n                        field.setAttribute('aria-invalid', 'true');\n                    } else {\n                        field.classList.remove('mga-field-error');\n                        field.removeAttribute('aria-invalid');\n                    }\n                }\n\n                if (messageElement) {\n                    if (hasMessage) {\n                        messageElement.textContent = message;\n                        messageElement.removeAttribute('hidden');\n                    } else {\n                        messageElement.textContent = '';\n                        messageElement.setAttribute('hidden', 'hidden');\n                    }\n                }\n            };\n\n            const updateSharePreview = (item) => {\n                if (!item) {\n                    return;\n                }\n\n                const preview = item.querySelector('[data-share-preview]');\n\n                if (!preview) {\n                    return;\n                }\n\n                const labelElement = preview.querySelector('[data-share-preview-label]');\n                const urlElement = preview.querySelector('[data-share-preview-url]');\n                const labelValue = getShareFieldValue(item, 'label');\n                const keyValue = getShareFieldValue(item, 'key');\n                const fallbackLabel = keyValue ? keyValue.toUpperCase() : mgaAdmin__('Nouveau canal', 'lightbox-jlg');\n\n                if (labelElement) {\n                    labelElement.textContent = labelValue || fallbackLabel;\n                }\n\n                if (urlElement) {\n                    const templateValue = getShareFieldValue(item, 'template');\n\n                    if (templateValue) {\n                        const previewUrl = buildSharePreviewUrl(templateValue);\n                        urlElement.textContent = previewUrl;\n                        urlElement.setAttribute('data-preview-empty', 'false');\n                        urlElement.title = previewUrl;\n                    } else {\n                        urlElement.textContent = mgaAdmin__('Compl\u00E9tez le mod\u00E8le pour g\u00E9n\u00E9rer un lien.', 'lightbox-jlg');\n                        urlElement.setAttribute('data-preview-empty', 'true');\n                        urlElement.removeAttribute('title');\n                    }\n                }\n\n                scheduleSummaryRefresh();\n            };\n\n            const validateShareItems = () => {\n                const items = Array.from(list.querySelectorAll('[data-share-repeater-item]'));\n                const keyOccurrences = items.reduce((accumulator, item) => {\n                    const keyValue = getShareFieldValue(item, 'key').toLowerCase();\n\n                    if (keyValue) {\n                        accumulator[keyValue] = (accumulator[keyValue] || 0) + 1;\n                    }\n\n                    return accumulator;\n                }, {});\n\n                items.forEach((item) => {\n                    const keyInput = getShareField(item, 'key');\n                    const templateInput = getShareField(item, 'template');\n                    const keyMessageEl = item.querySelector('[data-share-error=\"key\"]');\n                    const templateMessageEl = item.querySelector('[data-share-error=\"template\"]');\n                    const rawKeyValue = getShareFieldValue(item, 'key');\n                    const normalizedKey = rawKeyValue.toLowerCase();\n                    let keyMessage = '';\n\n                    if (!rawKeyValue) {\n                        keyMessage = mgaAdmin__('Renseignez une cl\u00E9 pour ce canal.', 'lightbox-jlg');\n                    } else if (!/^[a-z0-9_-]+$/i.test(rawKeyValue)) {\n                        keyMessage = mgaAdmin__('Utilisez uniquement des lettres, chiffres ou tirets.', 'lightbox-jlg');\n                    } else if (keyOccurrences[normalizedKey] > 1) {\n                        keyMessage = mgaAdmin__('Chaque cl\u00E9 doit \u00EAtre unique.', 'lightbox-jlg');\n                    }\n\n                    applyFieldError(keyInput, keyMessageEl, keyMessage);\n\n                    const templateValue = getShareFieldValue(item, 'template');\n                    let templateMessage = '';\n\n                    if (!templateValue) {\n                        templateMessage = mgaAdmin__('Renseignez un mod\u00E8le d\u2019URL.', 'lightbox-jlg');\n                    } else if (!hasRequiredPlaceholder(templateValue)) {\n                        templateMessage = mgaAdmin__('Ajoutez au moins le jeton %url% pour construire le lien.', 'lightbox-jlg');\n                    } else if (!isTemplateSchemeValid(templateValue)) {\n                        templateMessage = mgaAdmin__('Indiquez une URL valide (http, https, mailto, tel ou sms).', 'lightbox-jlg');\n                    }\n\n                    applyFieldError(templateInput, templateMessageEl, templateMessage);\n                });\n            };\n\n            const updateItemNames = () => {\n                const items = Array.from(list.querySelectorAll('[data-share-repeater-item]'));\n\n                items.forEach((item, index) => {\n                    const baseName = `mga_settings[share_channels][${index}]`;\n                    const fields = item.querySelectorAll('[data-share-field]');\n\n                    fields.forEach((field) => {\n                        const fieldKey = field.getAttribute('data-share-field');\n\n                        if (!fieldKey) {\n                            return;\n                        }\n\n                        let effectiveKey = fieldKey;\n\n                        if (fieldKey === 'enabled-hidden') {\n                            effectiveKey = 'enabled';\n                        }\n\n                        field.name = `${baseName}[${effectiveKey}]`;\n                    });\n\n                    applyUid(item);\n                    refreshItemTitle(item);\n                    updateIconPreview(item);\n                    updateSharePreview(item);\n                });\n\n                validateShareItems();\n\n                scheduleSummaryRefresh();\n            };\n\n            const focusItemField = (item) => {\n                if (!item) {\n                    return;\n                }\n\n                const target = item.querySelector('[data-share-field=\"label\"]') || item;\n                safeFocus(target);\n            };\n\n            list.addEventListener('input', (event) => {\n                const target = event.target;\n\n                if (!target) {\n                    return;\n                }\n\n                const item = target.closest('[data-share-repeater-item]');\n\n                if (!item) {\n                    return;\n                }\n\n                if (target.matches('[data-share-field=\"label\"], [data-share-field=\"key\"]')) {\n                    refreshItemTitle(item);\n                }\n\n                if (target.matches('[data-share-field=\"icon\"]')) {\n                    updateIconPreview(item);\n                }\n\n                updateSharePreview(item);\n                validateShareItems();\n            });\n\n            list.addEventListener('change', (event) => {\n                const target = event.target;\n\n                if (!target || !target.matches('[data-share-field=\"icon\"]')) {\n                    return;\n                }\n\n                const item = target.closest('[data-share-repeater-item]');\n\n                if (item) {\n                    updateIconPreview(item);\n                    updateSharePreview(item);\n                    validateShareItems();\n                }\n            });\n\n            list.addEventListener('click', (event) => {\n                const button = event.target.closest('[data-share-action]');\n\n                if (!button) {\n                    return;\n                }\n\n                event.preventDefault();\n\n                const action = button.getAttribute('data-share-action');\n                const item = button.closest('[data-share-repeater-item]');\n\n                if (!item) {\n                    return;\n                }\n\n                if (action === 'remove') {\n                    const nextFocusItem = item.nextElementSibling || item.previousElementSibling;\n\n                    if (item.parentNode === list) {\n                        list.removeChild(item);\n                    }\n\n                    updateItemNames();\n                    scheduleSummaryRefresh();\n\n                    if (nextFocusItem) {\n                        focusItemField(nextFocusItem);\n                    }\n\n                    return;\n                }\n\n                if (action === 'move-up') {\n                    const previous = item.previousElementSibling;\n\n                    if (previous) {\n                        list.insertBefore(item, previous);\n                        updateItemNames();\n                        focusItemField(item);\n                        scheduleSummaryRefresh();\n                    }\n\n                    return;\n                }\n\n                if (action === 'move-down') {\n                    const next = item.nextElementSibling;\n\n                    if (next) {\n                        list.insertBefore(next, item);\n                        updateItemNames();\n                        focusItemField(item);\n                        scheduleSummaryRefresh();\n                    }\n                }\n            });\n\n            if (addButton) {\n                addButton.addEventListener('click', (event) => {\n                    event.preventDefault();\n\n                    const fragment = doc.importNode(template.content, true);\n                    const newItem = fragment.querySelector('[data-share-repeater-item]');\n\n                    if (!newItem) {\n                        return;\n                    }\n\n                    list.appendChild(newItem);\n                    updateItemNames();\n                    focusItemField(newItem);\n                    scheduleSummaryRefresh();\n                });\n            }\n\n            updateItemNames();\n            scheduleSummaryRefresh();\n        }\n    });\n})(typeof window !== 'undefined' ? window : globalThis);\n"],
  "mappings": "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",
  "names": ["TOKEN_REGEX", "createFallbackSprintf", "createSprintf", "createTranslate", "resolveI18n", "init_sprintf", "__esmMin", "format", "args", "autoIndex", "match", "position", "argIndex", "type", "numericIndex", "value", "coerced", "i18n", "text", "globalObject", "SHARE_ICON_LIBRARY", "sanitizeIconKey", "getDefinition", "createSvgElement", "createIconSvg", "createIconPreview", "init_icons", "__esmMin", "value", "iconKey", "sanitizedKey", "doc", "tag", "attributes", "element", "attribute", "definition", "svg", "pathDefinition", "path", "wrapperTag", "wrapperClass", "wrapper", "focusSupportsOptionsCache", "detectFocusOptionsSupport", "safeFocus", "exposeOnWindow", "init_focus", "__esmMin", "doc", "testElement", "root", "error", "element", "options", "getTimestamp", "getDocument", "getMetricsStore", "recordMetric", "normalizeAttempts", "loadStylesheet", "loadScript", "getLoaderState", "attemptLoad", "runAttemptsSequentially", "getConfig", "ensureSwiper", "init_swiper", "__esmMin", "global", "namespace", "event", "detail", "store", "customEvent", "error", "config", "attempt", "key", "js", "css", "inject", "jsSrc", "doc", "existing", "link", "resolve", "reject", "script", "timeoutId", "cleanup", "attempts", "promise", "explicitConfig", "options", "state", "init_shared", "__esmMin", "init_sprintf", "init_icons", "init_focus", "init_swiper", "require_admin", "__commonJSMin", "exports", "module", "init_shared", "global", "exposeOnWindow", "mgaAdminI18n", "resolveI18n", "mgaAdmin__", "createTranslate", "mgaAdminSprintf", "createSprintf", "detectFocusOptionsSupport", "safeFocus", "doc", "createShareIconPreview", "iconKey", "preview", "createIconPreview", "sanitizeIconKey", "SHARE_TEMPLATE_SAMPLE", "SHARE_TEMPLATE_PLACEHOLDERS", "SHARE_TEMPLATE_SCHEMES", "isValidHexColor", "value", "normalizeHexColor", "trimmed", "r", "g", "b", "hexToRgb", "hex", "normalized", "red", "green", "blue", "component", "relativeLuminance", "rgb", "transform", "channel", "computeContrastRatio", "foreground", "background", "fgLuminance", "bgLuminance", "lighter", "darker", "ratio", "formatRatioText", "createContrastInspector", "inspector", "rowNodes", "messageNode", "contexts", "audit", "resolveAccentFallback", "accentInput", "defaultAttr", "normalizedDefault", "getSeverityFromRatio", "formatSeverityMessage", "entry", "update", "rawAccent", "accentColor", "row", "entries", "context", "ratioText", "severity", "worstEntry", "worst", "createPresetDiffTracker", "defaults", "formatMissing", "formatNumber", "formatSeconds", "rounded", "display", "formatMilliseconds", "formatPixels", "formatOpacity", "formatBoolean", "getSelectLabel", "controlId", "fallback", "element", "option", "candidate", "getControlLabel", "label", "fieldConfigs", "getDefaultLabel", "normalizeValue", "config", "rawValue", "number", "normalizeSettings", "settings", "defaultNormalized", "navigationApi", "lastSectionStates", "baseline", "readCurrentValue", "areValuesEqual", "a", "ensureLabels", "updateNavigationState", "sectionStates", "isModified", "sectionId", "sectionElement", "refresh", "diff", "baselineValue", "currentValue", "changed", "setBaseline", "key", "setNavigationApi", "api", "getBaselineInfo", "_a", "form", "adminRoot", "scheduleSummaryRefresh", "contrastInspector", "presetDiffTracker", "THEME_STORAGE_KEY", "THEME_OPTIONS", "themeSelect", "systemThemeQuery", "readStoredTheme", "error", "writeStoredTheme", "normalizeThemePreference", "currentThemePreference", "resolveAppliedTheme", "preference", "applyThemePreference", "options", "normalizedPreference", "resolvedTheme", "event", "nextPreference", "handleSystemThemeChange", "wizardApi", "targetForm", "wizard", "stepPanels", "indicators", "prevButton", "nextButton", "submitButton", "statusElement", "summaryIndex", "currentIndex", "panel", "getMessages", "setStatusMessage", "state", "message", "statusMessage", "updateControls", "focusPanel", "focusTarget", "focusOptions", "deactivatePanel", "activatePanel", "updateIndicators", "indicator", "index", "updateSummaryContainers", "timeoutId", "presetTarget", "timingTarget", "toolbarTarget", "shareTarget", "validationContainer", "diffContainer", "diffList", "diffBaseline", "diffEmpty", "scoreboardContainer", "scorecardMap", "map", "card", "applyScorecardState", "payload", "level", "statusEl", "pointsContainer", "point", "item", "renderScoreboard", "scores", "scoreKey", "severityRank", "computeLevelFromPoints", "points", "highest", "resolveCardMessage", "cardKey", "variants", "readNumberValue", "id", "readSelectValue", "readSelectLabel", "selectedOption", "readCheckboxValue", "formatSecondsValue", "evaluateScoreboard", "validations", "baselineInfo", "worstValidation", "buildUxScore", "delayValue", "effectValue", "effectLabel", "autoplay", "showThumbsMobile", "thumbsLayout", "formattedDelay", "delayState", "delayText", "navState", "navText", "heavyEffects", "normalizedEffect", "effectDisplayLabel", "animState", "animText", "buildAccessibilityScore", "startOnClicked", "contrastState", "contrastText", "autoplayState", "autoplayText", "contextState", "contextText", "buildReliabilityScore", "includeSvg", "allowFallback", "debugMode", "loadArchives", "assetsState", "assetsText", "fallbackState", "fallbackText", "debugState", "debugText", "buildVisualScore", "presetSelect", "presetValue", "rawAccentValue", "backgroundValue", "backgroundLabel", "hasDiff", "baselineLabel", "presetLabel", "presetState", "presetText", "accentLower", "accentState", "accentText", "backgroundState", "backgroundText", "renderToolbarSummary", "active", "toggle", "input", "renderPresetSummary", "renderTimingSummary", "delayInput", "effectSelect", "renderShareSummary", "activeLabels", "enabledField", "labelField", "keyField", "labelValue", "keyValue", "collectValidations", "renderValidations", "validation", "alert", "renderPresetDiff", "values", "beforeValue", "arrow", "afterValue", "goToStep", "targetIndex", "normalizedIndex", "currentPanel", "nextPanel", "handleNext", "handlePrev", "attachIndicatorNavigation", "handleFormInput", "ajaxUrl", "nonce", "setStatus", "explicitMessage", "setSavingState", "isSaving", "formData", "response", "successMessage", "fallbackMessage", "noopApi", "layout", "sections", "navList", "navLinks", "linkBySection", "navItemBySection", "navBadgeBySection", "viewToggle", "viewSelect", "VIEW_STORAGE_KEY", "currentViewMode", "syncViewSelect", "persistViewMode", "updateLayoutViewMode", "getSectionVisibility", "section", "searchInput", "emptyState", "highlightTimeouts", "isSearchActive", "updateEmptyState", "visibleCount", "searchActive", "setActiveLink", "link", "clearHighlights", "highlightSection", "filterSections", "rawQuery", "query", "navItem", "firstMatch", "applyViewMode", "nextMode", "currentQuery", "href", "target", "badge", "lastVisibleSection", "observer", "handleScroll", "bestSection", "bestOffset", "scrollY", "absoluteTop", "delta", "bindRangeToOutput", "sliderId", "outputId", "displayFormatter", "ariaFormatter", "slider", "output", "updateOutput", "displayValue", "ariaValue", "accentColorInput", "accentColorPreview", "defaultColorAttr", "fallbackColor", "applyPreviewColor", "rawColor", "color", "maybeJQuery", "ui", "colorValue", "defaultColor", "previewContainer", "previewMock", "thumbsContainer", "statusRegion", "mainSwiperEl", "paginationEl", "toolbarActions", "previewSwiper", "shouldAnnounce", "announce", "setPreviewState", "showFallback", "destroyPreviewSwiper", "parseNumber", "fallbackValue", "numeric", "buildSwiperConfig", "speedInput", "delaySeconds", "speedValue", "autoplayDelay", "speed", "swiper", "rebuildPreviewSwiper", "ensureSwiper", "setAccent", "_element", "setOverlay", "clamped", "setBackgroundStyle", "style", "toggleAction", "name", "enabled", "action", "setThumbScale", "updateEffectLabel", "_value", "effectLabelText", "bindPreviewControl", "handler", "events", "invoke", "eventName", "checked", "stylePresetExport", "stylePresets", "applyPresetButton", "resetPresetButton", "presetDescription", "isApplyingPreset", "maybeDispatchEvent", "eventType", "fallbackEvent", "fallbackError", "setNumericInputValue", "setRangeInputValue", "setSelectValue", "select", "setCheckboxValue", "checkbox", "setAccentColorValue", "targetColor", "picker", "applyPresetSettings", "updatePresetDescription", "customDescription", "baselineNote", "segments", "segment", "markPresetAsCustom", "registerPresetWatcher", "eventNames", "initialPreset", "shareRepeater", "initShareRepeater", "selectorsWrapper", "selectorsList", "selectorsTextarea", "template", "placeholder", "isSyncingSelectors", "addRow", "queryRows", "queryInputs", "hasEmptyRow", "updateRemoveState", "rows", "disable", "removeButton", "getRowValues", "syncTextareaFromRows", "bindRow", "lastRow", "lastInput", "createRow", "renderRows", "emptyRow", "syncRowsFromTextarea", "selector", "addButton", "container", "list", "uidSeed", "generateUid", "ensureItemUid", "applyUid", "uid", "suffix", "refreshItemTitle", "title", "labelInput", "keyInput", "updateIconPreview", "iconSvg", "summaryIcon", "summarySvg", "getShareField", "getShareFieldValue", "field", "buildSharePreviewUrl", "previewValue", "token", "replacement", "hasRequiredPlaceholder", "isTemplateSchemeValid", "scheme", "applyFieldError", "messageElement", "hasMessage", "updateSharePreview", "labelElement", "urlElement", "fallbackLabel", "templateValue", "previewUrl", "validateShareItems", "items", "keyOccurrences", "accumulator", "templateInput", "keyMessageEl", "templateMessageEl", "rawKeyValue", "normalizedKey", "keyMessage", "templateMessage", "updateItemNames", "baseName", "fieldKey", "effectiveKey", "focusItemField", "button", "nextFocusItem", "previous", "next", "newItem"]
}
